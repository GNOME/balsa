2010-01-19  Peter Bloomfield

	* src/main-window.c (bw_quit_nicely): use
	libbalsa_information_parented, so that notification bubble can
	be closed when Balsa quits;
	(bw_real_open_mbnode): hold gdk lock while unreffing mbnode;
	(balsa_window_real_close_mbnode): more careful test for last
	notebook page;
	(empty_trash): check for NULL window.

2010-01-18  Peter Bloomfield  <peter@t43.bellsouth.net>

	reviewed by: <delete if not using a buddy>

	* src/balsa-index.c (bndx_mbnode_weak_notify), (bndx_destroy),
	(balsa_index_load_mailbox_node): clear BalsaIndex::mailbox_node
	before destroying BalsaIndex.

2010-01-18  Peter Bloomfield

	* src/balsa-app.c (balsa_find_url): check for NULL
	mblist_tree_store.

2010-01-18  Peter Bloomfield

	* libbalsa/information.c (lbi_notification_parent_weak_notify),
	(lbi_notification_closed_cb), (libbalsa_information_varg): close
	notification bubble with parent.

2010-01-18  Peter Bloomfield

	* src/balsa-app.h: move nm_state and check_mail_skipped from
	BalsaApplication to BalsaWindow.
	* src/main-window.c: ditto.
	* src/main-window.h: ditto.

2010-01-17  Peter Bloomfield

	* src/balsa-app.h: new member mail_check_skipped.
	* src/main-window.c: use it to remember when we skipped a mail
	check while disconnected, and to check mail on reconnection.

2010-01-17  Peter Bloomfield

	* src/main-window.c: restart timer after user checks mail
	manually.

2010-01-17  Peter Bloomfield

	* src/balsa-app.c (update_timer): use g_timeout_add_seconds,
	save the world.

2010-01-17  Peter Bloomfield

	* src/main-window.c: report NetworkManager state on start-up;
	skip POP3 checks when disconnected; do not disconnect local IMAP
	server when NetworkManager is disconnected.

2010-01-17  Pawel Salek

	* libbalsa/imap/imap-tls.c: check also the length when matching
	the host name vs the one in the certificate.

2010-01-17  Peter Bloomfield

	* src/main-window.c: close the new-mail notification instead of
	showing it with a 1 millisecond time-out.

2010-01-16  Peter Bloomfield

	* src/balsa-app.h: new member NMState nm_state.
	* src/main-window.c: use it to save NetworkManager state;
	connect or disconnect IMAP on changes to/from
	NM_STATE_CONNECTED.

2010-01-16  Peter Bloomfield

	* libbalsa/body.c (libbalsa_message_body_save_temporary): make
	temporary file read-only.

2010-01-15  Pawel Salek

	* libbalsa/imap/imap_compress.c:
	* libbalsa/imap/siobuf.c: complete the compression error handling.

2010-01-14  Peter Bloomfield

	* libbalsa/html.h: new methods for printing.
	* libbalsa/html.c (libbalsa_html_can_print),
	(libbalsa_html_print): implement them.
	* src/balsa-mime-widget-text.c (bmwt_populate_popup_menu),
	(bmwt_populate_popup_cb): use them.

2010-01-14  Peter Bloomfield

	* libbalsa/html.h: new methods for printing.
	* libbalsa/html.c (libbalsa_html_can_print),
	(libbalsa_html_print): implement them.
	* src/balsa-mime-widget-text.c (bmwt_populate_popup_menu),
	(bmwt_populate_popup_cb): use them.

2010-01-14  Peter Bloomfield

	* configure.in: require NetworkManager version 0.7.
	* src/main-window.c: use GObject-based API instead of deprecated
	older API.

2010-01-12  Pawel Salek

	* libbalsa/html.c: fix libbalsa_html_popup_menu_widget() arg list.

2010-01-12  Peter Bloomfield

	* libbalsa/html.h: new public method to retrieve the real HTML
	widget.
	* libbalsa/html.c (libbalsa_html_popup_menu_widget): ditto.
	* src/balsa-mime-widget-text.c (bmwt_populate_popup_menu),
	(balsa_gtk_html_popup), (bmwt_populate_popup_cb),
	(bm_widget_new_html): use it to implement popup menu for
	WebKitWebView.

2010-01-11  Peter Bloomfield

	* libbalsa/address-book-gpe.c
	(libbalsa_address_book_gpe_alias_complete): free error with
	sqlite3_free() instead of free(); fixes bug #606676 (Stanislav
	Brabec).

2010-01-11  Peter Bloomfield

	* libbalsa/html.h: new API for libbalsa_html_new.
	* src/balsa-mime-widget-text.c (balsa_mime_widget_new_text),
	(bm_widget_new_html): use it.
	* libbalsa/html.c (lbh_get_body_content,
	lbh_get_web_view, libbalsa_html_can_zoom,
	libbalsa_html_zoom, libbalsa_html_can_select,
	libbalsa_html_select_all, libbalsa_html_copy,
	libbalsa_html_can_search, libbalsa_html_search_text,
	libbalsa_html_get_selection_bounds): implement new API;
	(lbh_info_bar_realize_cb, lbh_info_bar_widget,
	lbh_resource_request_starting_cb, lbh_info_bar_response_cb,
	libbalsa_html_new): prepend HTML message part with a GtkInfoBar
	offering the option to download images.

2010-01-11  Peter Bloomfield

	* src/balsa-message.c (add_part), (balsa_message_can_select):
	html widgets can select text.

2010-01-11  Peter Bloomfield

	* libbalsa/html.c (lbh_js_get_global_context), (lbh_js_run_script),
	(lbh_js_object_get_property), (libbalsa_html_search_text),
	(libbalsa_html_get_selection_bounds): use JavaScript to locate
	or clear selected text; enable text search.

2010-01-11  Pawel Salek

	* libbalsa/mailbox_imap.c: gmail anwers NO to FETCH, deal with it.

2010-01-10  Albrecht Dreß

	* src/pref-manager.c (word_wrap_group): increase maximum line
	length to 998, the RFC 2822 limit.

2010-01-09  Peter Bloomfield

	* src/balsa-message.c (add_body), (add_multipart_digest),
	(add_multipart_mixed), (add_multipart), (add_part),
	(select_part): cleaner recursion.

2010-01-09  Peter Bloomfield

	* src/balsa-mime-widget-text.c (url_open_cb), (check_call_url),
	(handle_url), (bm_widget_new_html): combine link-clicked
	handling for text/plain and text/html parts.

2010-01-08  Pawel Salek

	* libbalsa/imap/imap_compress.c: improve error handling.
	* libbalsa/mailbox_imap.c: catch error conditions early.

2010-01-06  Peter Bloomfield

	* src/balsa-mime-widget-text.c (balsa_mime_widget_new_text): do
	not leak HTML source.

2010-01-05  Pawel Salek

	* libbalsa/imap/siobuf.[ch]: change encode interface so that
	compression callback do not need to allocate too much memory.
	* libbalsa/imap/imap_compress.c: modify the callbacks accordingly.
	* libbalsa/imap/imap-handle.c: make sure we do not leave some
	unflushed compressed data around.
	* configure.in: zlib.h is unconditionally required.

2010-01-05  Peter Bloomfield

	* libbalsa/html.c (libbalsa_html_new): remove dead code.

2010-01-05  Peter Bloomfield

	* src/balsa-message.c (add_part), (select_part): remove dead or
	redundant code.

2010-01-05  Peter Bloomfield

	* libbalsa/html.c (libbalsa_html_new): put webkit in
	document-viewer mode instead of the default browser mode.

2010-01-05  Peter Bloomfield

	* src/balsa-app.h: omit point size from default font names.
	* src/pref-manager.c (open_preferences_manager),
	(check_font_button), (apply_prefs), (font_button_check_font_size),
	(attach_font_button), (preview_font_group), (font_modified_cb),
	(default_font_size_cb): add option to use default font sizes.

2010-01-05  Peter Bloomfield

	* src/balsa-mime-widget-text.c (balsa_mime_widget_new_text),
	(quote_tag): define constants for margins.

2010-01-04  Peter Bloomfield

	* libbalsa/misc.c (libbalsa_create_entry): use
	gtk_entry_set_text instead of gtk_editable_insert_text, to avoid
	a bogus warning.

2010-01-04  Peter Bloomfield

	* src/save-restore.c (config_global_load): default to no message
	wrap and prefer text/plain over text/html.

2010-01-04  Peter Bloomfield

	* src/balsa-message.c (bm_find_entry_changed_cb), (bm_find_again),
	(balsa_message_find_in_message): build --without-gtkhtml
	--without-webkit.

2010-01-04  Peter Bloomfield

	* libbalsa/imap/imap_compress.c: add missing includes of
	stdlib.h, string.h.

2010-01-03  Peter Bloomfield

	* src/main-window.c: better menu item label (Pawel).

2010-01-03  Pawel Salek

	* libbalsa/imap-server.c: enable compression by default.
	* libbalsa/imap/Makefile.am: add imap_compress.[hc]
	* libbalsa/imap/imap-commands.c: imap_cmd_exec returns ImapResponse.
	* libbalsa/imap/imap-handle.c: add COMPRESS=DEFLATE capability
	* libbalsa/imap/imap_compress.[ch]: support the extension.
	* libbalsa/imap/imap_tst.c: allow compression testing.

2010-01-02  Peter Bloomfield

	* src/balsa-mime-widget-text.c (balsa_mime_widget_new_text),
	(quote_tag): get font description from widget; scale size from
	points to pixels; use 60% of size for width.

2010-01-02  Peter Bloomfield

	* src/balsa-app.h: new members to save hidden toolbars.
	* src/save-restore.c (config_global_load), (config_save): save
	and restore them.
	* src/main-window.c: options to hide toolbar, SoSbar, and status
	bar.
	* src/main-window.h: add toolbar and sos_bar members.
	* src/message-window.c (message_window_new),
	(mw_show_toolbar_cb): option to hide toolbar.
	* src/sendmsg-window.c (sendmsg_window_new),
	(sw_show_toolbar_cb): option to hide toolbar.
	* src/sendmsg-window.h: add toolbar member.

2010-01-02  Pawel Salek

	* libbalsa/imap/pop3.c: Report errors occuring during downloading
	process earlier to avoid saving corrupted messages.
	* libbalsa/mailbox_pop3.c: do not leak file descriptors on some errors.

2010-01-01  Peter Bloomfield

	* src/sendmsg-window.c: Do not crash in touch-ui version.

2010-01-01  Peter Bloomfield

	* configure.in: Allow configure --enable-touch-ui=no and
	--disable-touch-ui.

2010-01-01  Pawel Salek

	* libbalsa/send.c: Fix bug 605807.

2009-12-30  Pawel Salek

	* configure.in: gtkspell build requires enchant now as well.\
	* src/main-window.c:
	* src/sendmsg-window.c: compile with --enable-touch-ui

2009-12-30  Peter Bloomfield

	* src/sendmsg-window.c (create_lang_menu): use
	enchant_broker_dict_exists() to check languages.

2009-12-29  Pawel Salek

	* libbalsa/rfc3156.c:
	* src/main-window.c: add comments to aid translations...
	* src/sendmsg-window.c: ... to fix bug 605435.

2009-12-29  Peter Bloomfield

	* libbalsa/html.c (lbh_resource_request_starting_cb),
	(lbh_new_window_policy_decision_requested_cb),
	(libbalsa_html_new): use "notify::progress" signal instead of
	deprecated "load-progress-changed"; use
	"new-window-policy-decision-requested" signal to more carefully
	control new windows.

2009-12-29  Peter Bloomfield

	* configure.in: require webkitgtk version 1.1.14 or newer.
	* libbalsa/html.c (lbh_resource_request_starting_cb),
	(libbalsa_html_new): use WebKitwebView's
	"resource-request-starting" signal to handle cid: requests and
	disable all others.
	* libbalsa/body.c (libbalsa_message_body_save_temporary): use
	body->filename in preference to content_id.
	* libbalsa/body.h: remove now redundant functions.
	* libbalsa/message.c: ditto.
	* libbalsa/message.h: ditto.

2009-12-26  Peter Bloomfield

	* libbalsa/html.c (lbh_filter_src), (libbalsa_html_new),
	(libbalsa_html_url_requested): implement two ways of handling
	cid: URLs in WebKitwebView.

2009-12-26  Peter Bloomfield

	* libbalsa/message.h: add tempdir member and new methods.
	* libbalsa/message.c (libbalsa_message_finalize),
	(libbalsa_message_get_part_by_id),
	(libbalsa_message_save_parts_by_id),
	(libbalsa_message_has_cid_part), (libbalsa_message_get_tempdir):
	implement and use them.

2009-12-26  Peter Bloomfield

	* libbalsa/libbalsa.h: new error code.

2009-12-20  Peter Bloomfield

	* libbalsa/body.h: new member LibBalsaMessageBody::own_dir, TRUE
	if the temporary file for the body is in its own temporary
	directory/
	* libbalsa/body.c (libbalsa_message_body_new),
	(libbalsa_message_body_free),
	(libbalsa_message_body_save_temporary): if the body has a
	filename, save the temporary file in its own temporary
	directory.

2009-12-20  Peter Bloomfield

	* libbalsa/filter-funcs.c (lbcond_new): save negated as 0 or 1,
	to simplify later comparison.
	(libbalsa_condition_compare): return FALSE if negate differs;
	drop now-redundant test for flag conditions.

2009-12-19  Peter Bloomfield

	* libbalsa/filter-funcs.c (libbalsa_condition_compare):
	simplify, and fix string and boolean filter comparisons.

2009-12-16  Peter Bloomfield

	* libbalsa/send.c (libbalsa_message_create_mime_message): do not
	append NULL list in internet_address_list_append.

2009-12-16  Mario Mikocevic <mario mikocevic t-com hr>

	* balsa.spec.in: for 2.4.2 to successfuly compile a rpm, a small
	patch is needed.

2009-12-14  Peter Bloomfield

	* configure.in: put LIBNM_GLIB_CFLAGS in BALSA_CFLAGS instead of
	CFLAGS--required to build with
	CFLAGS+="-DG_DISABLE_SINGLE_INCLUDES
	-DGDK_PIXBUF_DISABLE_SINGLE_INCLUDES
	-DGTK_DISABLE_SINGLE_INCLUDES"

2009-12-10  Peter Bloomfield

	* src/balsa-app.c (check_new_messages_auto_cb): pass
	balsa_app.main_window instead of NULL to check_new_messages_real,
	so we can manage the sensitivity of the check action.

2009-12-08  Peter Bloomfield

	* src/sendmsg-window.c (guess_identity_from_list): do not pass
	NULL list to internet_address_list_to_string().

2009-12-07  Peter Bloomfield

	* libbalsa/filter.c (libbalsa_condition_matches): do not pass
	NULL list to internet_address_list_to_string().

2009-12-06  Pawel Salek

	* configure.in
	* NEWS: release balsa-2.4.2

2009-12-03  Peter Bloomfield

	* src/balsa-message.c (bm_find_set_status),
	(bm_find_scroll_to_rectangle), (bm_find_scroll_to_selection),
	(bm_find_entry_changed_cb), (bm_find_again): implement
	search-text for HTML parts; desensitize find-next and
	find-previous when find-entry is empty.

2009-12-03  Peter Bloomfield

	* libbalsa/html.c (lbh_navigation_policy_decision_requested_cb),
	(libbalsa_html_new), (libbalsa_html_search_text),
	(libbalsa_html_get_selection_bounds),
	(libbalsa_html_can_search): implement search-text for webkit
	backend, but only if we can scroll to the text.
	* libbalsa/html.h: implement libbalsa_html_search_text.

2009-11-16  Peter Bloomfield

	* src/balsa-message.c (balsa_message_find_in_message): grab
	focus only if entry is realized.

2009-11-15  Peter Bloomfield

	* libbalsa/html.c (lbh_size_request_cb): remove debugging aid;
	(lbh_navigation_policy_decision_requested_cb): do not handle
	signal unless it is a real request;
	(libbalsa_html_new): remove debugging aids.
	* src/balsa-message.c (select_part): queue-resize is redundant.

2009-11-12  Pawel Salek

	* libbalsa/imap/imap-handle.c: fix a corner case locking problem.
	* src/main-window.c: remove a warning.
	* configure.in: work around lib rename.

2009-11-11  Pawel Salek

	* configure.in: add NetworkManager-glib support.
	* libbalsa/imap-server.c: Disconnect quickly if asked to.
	* libbalsa/imap/imap-commands.c: add private unlocked select command.
	* libbalsa/imap/imap-handle.c: locking changes.
	* libbalsa/imap/imap-handle.h: add ..force_disconnect() prototype.
	* libbalsa/imap/imap_private.h: add select_unlocked() prototype.
	* libbalsa/mailbox.c: stop-gap performance fix.
	* libbalsa/mailbox_imap.[hc]: Add force_disconnect(), reconnect(),
	is_connected().
	* src/main-window.c: listen to libnm events.

2009-11-08  Peter Bloomfield

	* libbalsa/imap/imap-tls.c (imap_check_server_identity): openssl
	has been constified--second try, should build with both latest
	and earlier openssl.

2009-11-08  Peter Bloomfield

	* libbalsa/imap/imap-tls.c (imap_check_server_identity):
	revert--it's going to take more work!

2009-11-08  Peter Bloomfield

	* libbalsa/imap/imap-tls.c (imap_check_server_identity): openssl
	has been constified.

2009-11-07  Peter Bloomfield

	* src/balsa-mime-widget-vcalendar.c (balsa_vevent_widget,
	vevent_reply): use macros to cast enum to or from gpointer.

2009-11-07  Peter Bloomfield

	* libbalsa/rfc2445.c (text_2445_unescape): "\N" encodes newline.

2009-11-01  Peter Bloomfield

	* libbalsa/html.c (lbh_size_request_cb): only increase the
	requisition;
	(lbh_navigation_policy_decision_requested_cb): be silent;
	(libbalsa_html_new): indentation.
	* src/balsa-message.c (add_part): give the content the surplus
	space.

2009-10-31  Peter Bloomfield

	* libbalsa/html.c (lbh_navigation_policy_decision_requested_cb):
	check reason for request.
	(libbalsa_html_new): do not leak GtkAdjustments.

2009-10-30  Peter Bloomfield

	* libbalsa/html.c (lbh_navigation_policy_decision_requested_cb,
	lbh_web_view_ready_idle, lbh_web_view_ready_cb,
	lbh_create_web_view_cb, libbalsa_html_new): handle a clicked
	link that requires a new window.

2009-10-28  Peter Bloomfield

	* src/balsa-mime-widget.c (balsa_mime_widget_destroy): unref
	widget instead of destroying.

2009-10-28  Peter Bloomfield

	* libbalsa/html.c (libbalsa_html_zoom, libbalsa_html_can_select,
	libbalsa_html_select_all, libbalsa_html_copy): add comments and
	indent;
	(libbalsa_html_search_text): build with all widgets.

2009-10-27  Peter Bloomfield

	* libbalsa/html.h: new methods for text search, to access
	WebKitWebView capability.
	* libbalsa/html.c (libbalsa_html_can_search,
	libbalsa_html_search_text): implement them.
	* src/balsa-message.c (bm_find_entry_changed_cb,
	bm_find_again, balsa_message_find_in_message): use them.
	* src/balsa-mime-widget.c (balsa_mime_widget_destroy): work-around
	weird WebKitWebView-GtkClipboard issue.

2009-10-27  Peter Bloomfield

	* src/toolbar-factory.c: show text for "compose" instead of
	"trash/delete".

2009-10-24  Peter Bloomfield

	* src/toolbar-factory.h: new member button_data::is_important.
	* src/toolbar-factory.c (tm_set_tool_item_label): use it.

2009-10-24  Peter Bloomfield

	* src/balsa-app.h: do not include toolbar-factory.h.

2009-10-15  Peter Bloomfield

	GSEAL cleanup

	* configure.in: enable GSEAL if gtk version >= 2.18.
	* libbalsa/address-view.c (lbav_entry_changed_cb):
	* libbalsa/address.c (addrlist_drag_received_cb):
	* libbalsa/html.c (lbh_size_request_cb):
	* libbalsa/identity.c (libbalsa_identity_select_dialog),
	(md_sig_path_changed_cb), (ident_dialog_get_path),
	(libbalsa_identity_config_dialog):
	* libbalsa/libbalsa.c (ask_cert_real):
	* libbalsa/misc.c (lb_create_size_group_func):
	* libbalsa/rfc3156.c (select_key_from_list), (get_passphrase_real):
	* libbalsa/send.c (ensure_send_progress_dialog):
	* libbalsa/smtp-server.c (libbalsa_smtp_server_dialog):
	* libbalsa/source-viewer.c (lsv_size_allocate_cb),
	(libbalsa_show_message_source):
	* libinit_balsa/assistant_helper.c (entry_changed_cb):
	* src/ab-main.c (edit_new_entry_cb), (addrlist_drag_get_cb):
	* src/ab-window.c (balsa_ab_window_init):
	* src/address-book-config.c (create_generic_dialog),
	(create_externq_dialog), (create_ldap_dialog), (create_gpe_dialog):
	* src/balsa-app.c (ask_password_real):
	* src/balsa-index.c (bndx_drag_cb), (bndx_mailbox_changed_cb),
	(bndx_popup_position_func), (bndx_expand_to_row),
	(balsa_index_pipe), (balsa_index_ensure_visible):
	* src/balsa-mblist.c (bmbl_drag_cb), (bmbl_mru_show_tree):
	* src/balsa-message.c (bm_on_set_style), (bm_find_scroll_to_iter),
	(bm_find_pass_to_entry), (gtk_tree_hide_func), (select_part),
	(scroll_set), (balsa_get_parent_window),
	(balsa_message_grab_focus):
	* src/balsa-mime-widget-callbacks.c (scroll_change),
	(balsa_mime_widget_key_press_event):
	* src/balsa-mime-widget-image.c (balsa_mime_widget_new_image),
	(img_check_size):
	* src/balsa-mime-widget-message.c (bm_header_widget_realized):
	* src/balsa-mime-widget-text.c (gtk_widget_destroy_insensitive),
	(draw_cite_bar_real):
	* src/balsa-mime-widget.c (vadj_change_cb):
	* src/filter-edit-callbacks.c (condition_validate),
	(fill_condition_widgets), (build_condition_dialog):
	* src/filter-edit-dialog.c (filters_edit_dialog):
	* src/filter-export-dialog.c (filters_export_dialog):
	* src/filter-run-dialog.c (balsa_filter_run_dialog_init):
	* src/folder-conf.c (folder_conf_imap_node), (browse_button_cb),
	(subfolder_conf_clicked_ok), (folder_conf_imap_sub_node):
	* src/information-dialog.c (balsa_information_list):
	* src/mailbox-conf.c (create_pop_mailbox_dialog),
	(create_imap_mailbox_dialog):
	* src/main-window.c (bw_quit_nicely):
	* src/message-window.c (size_alloc_cb):
	* src/pref-manager.c (open_preferences_manager), (apply_prefs),
	(set_prefs), (timer_modified_cb),
	(mailbox_close_timer_modified_cb), (imap_toggled_cb),
	(convert_8bit_cb):
	* src/print-gtk.c (check_margins), (message_prefs_apply):
	* src/sendmsg-window.c (sw_size_alloc_cb), (sw_get_user_codeset),
	(attachments_add), (sw_scroll_size_request), (drag_data_quote),
	(quote_parts_select_dlg), (subject_not_empty),
	(check_suggest_encryption):
	* src/spell-check.c (balsa_spell_check_init):
	* src/store-address.c (store_address_dialog):
	* src/toolbar-factory.c (tm_popup_position_func):
	* src/toolbar-prefs.c (customize_dialog_cb), (wrap_toggled_cb):

2009-10-15  Peter Bloomfield

	Re-implement BalsaCiteBar as a GTK_NO_WINDOW widget

	* src/balsa-cite-bar.h: make BalsaCiteBar opaque.
	* src/balsa-cite-bar.c (balsa_cite_bar_class_init),
	(balsa_cite_bar_init), (balsa_cite_bar_resize),
	(balsa_cite_bar_size_request), (balsa_cite_bar_expose):

2009-10-15  Peter Bloomfield

	Use gtk_window_present instead of gdk_window_raise

	* libbalsa/identity.c (libbalsa_identity_select_dialog):
	* libbalsa/smtp-server.c (libbalsa_smtp_server_dialog):
	* src/address-book-config.c (balsa_address_book_config_new):
	* src/balsa-index.c (balsa_index_pipe):
	* src/filter-edit-dialog.c (filters_edit_dialog):
	* src/filter-export-dialog.c (filters_export_dialog):
	* src/filter-run-dialog.c (filters_run_dialog):
	* src/folder-conf.c (folder_conf_imap_node):
	* src/mailbox-conf.c (mailbox_conf_new), (mailbox_conf_edit):
	* src/main-window.c:
	* src/pref-manager.c (open_preferences_manager):
	* src/sendmsg-window.c (address_book_cb), (spell_check_cb):
	* src/store-address.c (balsa_store_address_from_messages):
	* src/toolbar-prefs.c (customize_dialog_cb):

2009-10-09   Stanislav Brabec

	Fix #596309

	* configure.in: require gnome-icon-theme.
	* src/balsa-app.c (balsa_app_init): set gnome-icon-theme as
	fallback.

2009-10-08  Peter Bloomfield

	* src/address-book-config.c (create_local_dialog,
	create_vcard_dialog, create_ldif_dialog,
	create_generic_dialog, create_externq_dialog,
	create_ldap_dialog, create_gpe_dialog, create_rubrica_dialog):
	show address book type in dialog title.

2009-10-08  Peter Bloomfield

	* libbalsa/mailbox.c (lbm_changed, libbalsa_mailbox_changed): do
	not emit mailbox-changed signal in a sub-thread.

2009-10-08  Peter Bloomfield

	* libbalsa/mailbox_mbox.c (lbm_mbox_armored_object): use
	g_mime_object_encode when available.

2009-10-08  Peter Bloomfield

	* src/address-book-config.c (edit_book_response): check for NULL
	address-book.

2009-10-01  Peter Bloomfield

	* libbalsa/mailbox_mbox.c (lbm_mbox_prepare_object,
	lbm_mbox_armored_object): use GMimeMultipart api to traverse
	message ourselves instead of using g_mime_multipart_foreach.

2009-09-30  Peter Bloomfield

	* src/toolbar-factory.c (tm_do_popup_menu): do not crash when
	default is "text beside items"; fixes
	http://mail.gnome.org/archives/balsa-list/2009-September/msg00045.html

2009-09-28  Laurent Coudeur <laurentc iol ie>

	* src/spell-check.c (balsa_spell_check_init,
	balsa_spell_check_start, balsa_spell_check_learn,
	setup_suggestions, check_pspell_errors): mark strings for
	translation.

2009-09-26  Peter Bloomfield

	* libbalsa/mailbox_mbox.c (lbm_mbox_prepare_object): count
	GMimeMessagePart as well as GMimePart when skipping parts.

2009-09-25  Peter Bloomfield

	* libbalsa/mailbox_mbox.c (lbm_mbox_prepare_object),
	(lbm_mbox_armored_object): detect when g_mime_multipart_foreach
	will recursively descend into a signed or encrypted multipart,
	and set a counter to skip the parts that should not be changed.

2009-09-24  Peter Bloomfield

	* src/balsa-app.c (append_url_if_open): use a GPtrArray to
	collect URLs instead of a GString;
	(open_mailboxes_idle_cb): ditto; do not leak urls.

2009-09-24  Peter Bloomfield

	* src/balsa-app.c (open_mailboxes_idle_cb): do not open most
	recent mailbox if no mailboxes were open.

2009-09-24  Peter Bloomfield

	* src/balsa-app.c (open_mailbox_by_url),
	(open_mailboxes_idle_cb): respect current-mailbox-url when -o
	command line option is used.
	* src/main-window.c: do not clear current-mailbox-url when last
	mailbox is closed, as it may get saved that way.
	* src/main.c (initial_open_inbox): open inbox hidden.

2009-09-11  Peter Bloomfield

	Open most recent mailbox first on restart

	* libbalsa/libbalsa-marshal.list: new marshaller.
	* src/balsa-app.h: new member current_mailbox_url.
	* src/save-restore.c (config_global_load), (config_save): save
	and restore it.
	* src/main-window.h: new api for open-mbnode class method.
	* src/balsa-mblist.h: new method balsa_mblist_open_mailbox_hidden;
	* src/balsa-app.c (open_mailboxes_idle_cb): use them.
	* src/balsa-index.c (balsa_index_transfer): ditto.
	* src/balsa-mblist.c (bmbl_open_mailbox),
	(balsa_mblist_open_mailbox), (balsa_mblist_open_mailbox_hidden):
	ditto.
	* src/mailbox-node.c (load_mailbox_view): ditto.
	* src/main-window.c: ditto.

2009-09-11  Peter Bloomfield

	* src/mailbox-conf.c (mailbox_conf_set_values):
	initialize mailbox name for local mailbox;
	(local_mailbox_dialog_cb), (create_local_mailbox_dialog):
	catch file chooser events to check for a real change;
	(create_imap_mailbox_dialog), (mailbox_conf_view_new_full),
	(mailbox_conf_view_new): new api.

2009-09-10  Peter Bloomfield

	* src/mailbox-conf.c (mailbox_conf_view_cb),
	(mailbox_conf_view_new_with_size_group): set "Update" button
	sensitive when a control is changed.

2009-09-07  Peter Bloomfield

	* src/main.c (balsa_handle_automation_options): encode URI for
	UniqueMessageData.
	(mw_message_received_cb): decode URI received from
	UniqueMessageData.

2009-09-07  Peter Bloomfield

	* libbalsa/misc.c (libbalsa_urlencode): handle 8-bit characters.

2009-09-07  Peter Bloomfield

	* libbalsa/libbalsa-conf.c (lbc_init): do not read config file
	twice.

2009-09-07  Peter Bloomfield

	* libinit_balsa/assistant_init.c (balsa_init_begin): minimal
	init assistant.
	* libinit_balsa/assistant_page_user.c
	(balsa_druid_page_user_init): ditto.

2009-09-04  Peter Bloomfield

	* libbalsa/address-book-vcard.c
	(libbalsa_address_book_vcard_parse_address): accept
	"email:name@host" as well as "email;type=blah:name@host".

2009-09-03  Peter Bloomfield

	* configure.in: oops--revert.

2009-09-03  Peter Bloomfield

	* configure.in: do not allow configure with both webkit and
	gtkhtml.

2009-08-29  Albrecht Dreß

	Improve the Mac OS X integration for a native "Carbon" build

	* libbalsa/Makefile.am:
	* libbalsa/identity.c (libbalsa_identity_select_dialog),
	(delete_ident_cb), (libbalsa_identity_config_dialog):
	* libbalsa/rfc3156.c (check_gpg_child), (select_key_from_list),
	(accept_low_trust_key), (get_passphrase_real):
	* libbalsa/smtp-server.c (libbalsa_smtp_server_dialog):
	* libbalsa/source-viewer.c (libbalsa_show_message_source):
	* src/ab-main.c:
	* src/address-book-config.c (create_local_dialog),
	(create_generic_dialog), (bad_path):
	* src/balsa-app.c (ask_password_real):
	* src/balsa-icons.c (register_balsa_pixmaps):
	* src/balsa-index.c (balsa_index_pipe):
	* src/balsa-mblist.c (bmbl_mru_show_tree):
	* src/balsa-message.c (part_context_dump_all_cb),
	(create_mdn_dialog):
	* src/balsa-mime-widget-callbacks.c
	(balsa_mime_widget_ctx_menu_save):
	* src/filter-edit-callbacks.c (fe_edit_condition):
	* src/folder-conf.c (folder_conf_imap_node), (browse_button_cb),
	(subfolder_conf_clicked_ok), (folder_conf_imap_sub_node),
	(folder_conf_delete):
	* src/information-dialog.c (balsa_information_dialog),
	(balsa_information_list):
	* src/mailbox-conf.c (mailbox_conf_delete),
	(create_local_mailbox_dialog), (create_generic_dialog):
	* src/main-window.c:
	* src/message-window.c (message_window_new):
	* src/pref-manager.c (open_preferences_manager):
	* src/sendmsg-window.c (delete_handler), (change_attach_mode),
	(sw_get_user_codeset), (sw_attach_dialog),
	(quote_parts_select_dlg), (sendmsg_window_new),
	(sendmsg_window_set_field), (include_file_cb),
	(check_suggest_encryption), (send_message_handler),
	(bsmsg_check_format_compatibility):
	* src/store-address.c (store_address_dialog):
	* src/threads.h:
	* src/toolbar-prefs.c (customize_dialog_cb):

2006-08-27  Pawel Salek

	* libbalsa/imap/imap-handle.c: namespace queries need to encode
	the prefix.
	* libbalsa/imap/imap_tst.c: test mailbox name encoding.
	* libbalsa/imap/util.c: encode backslash and quote marks.
	
2009-08-26  Peter Bloomfield 

	set-statusbar is a BalsaWindow method.

	* src/balsa-index.c (balsa_index_transfer):
	* src/balsa-mblist.c (balsa_mblist_open_mailbox),
	(bmbl_update_mailbox):
	* src/balsa-mblist.h:
	* src/main-window.c:
	* src/main-window.h:

2009-08-20  Peter Bloomfield

	* src/main-window.c: build with --disable-threads.

2009-08-19  Peter Bloomfield

	* libbalsa/address-book-gpe.c
	(libbalsa_address_book_gpe_open_db): show file name in error
	message.

2009-08-19  Peter Bloomfield

	* src/main-window.c: Manage sensitivity of "Get New Mail"
	action.
	* src/main.c (mw_message_received_cb, main): ditto.

2009-08-19  Peter Bloomfield

	Allow only one compose window per draft message.

	* src/balsa-index.c (bndx_row_activated): check for NULL return
	from sendmsg_window_continue.
	* src/sendmsg-window.c (balsa_sendmsg_destroy_handler,
	sw_save_draft): clear object data.
	(sendmsg_window_continue): present existing window if it exists
	and return NULL, and use object data to remember window.

2009-08-19  Peter Bloomfield

	* src/balsa-mime-widget-message.c (bm_header_widget_new): use
	GTK_WRAP_WORD_CHAR so that over-long words do not force
	over-wide window.
	* src/balsa-mime-widget-text.c (balsa_mime_widget_new_text):
	ditto.
	* src/balsa-mime-widget-vcalendar.c: ditto.

2009-08-11  Peter Bloomfield

	* src/balsa-print-object-header.c (header_add_list): do not
	print header line with NULL address string.

2006-08-09  Pawel Salek

	* NEWS, configure.in: release balsa-2.4.1

2009-08-04  Peter Bloomfield

	* configure.in: new option --with-canberra=no.
	* libbalsa/filter.c (libbalsa_filter_mailbox_messages): use
	libcanberra-gtk in preference to libgnome for filter sounds.

2009-08-02  Peter Bloomfield

	* src/sendmsg-window.c (bsmsg_set_subject_from_body): use
	existing subject for continued draft message; new name and api;
	(update_bsmsg_identity), (bsm_finish_setup),
	(sendmsg_window_forward): use new name and api.

2009-08-01  Peter Bloomfield

	* libbalsa/body.c (libbalsa_message_body_get_pixbuf): workaround
	for IE's use of non-IANA registered mime-type "image/pjpeg" for
	progressive JPEG image.

2009-08-01  Peter Bloomfield

	* src/sendmsg-window.c (set_entry_to_subject): do not drop
	subject when continuing a new message.

2006-07-30  Pawel Salek

	* libbalsa/imap/imap-commands.c: lock LIST fixed.

2009-07-28  Peter Bloomfield

	* libbalsa/address-view.c (lbav_add_from_list),
	(lbav_add_from_string): streamline code.

2006-07-28  Pawel Salek

	* libbalsa/address-view.c: protect against empty InternetAddressLists.
	* libbalsa/imap/imap-commands.c: lock LIST, LSUB, STATUS as well.

2009-07-26  Peter Bloomfield

	* src/balsa-mblist.c: do not include gdk/gdkfont.h.

2009-07-26  Peter Bloomfield

	Partial fixes for bug #589764, André Klapper.

	* libbalsa/imap/pop3.c (pop_authenticate): use
	g_ascii_strncasecmp.
	* src/quote-color.c (allocate_quote_colors): remove
	"gdk_color_black" from comment.

2009-07-26  Peter Bloomfield

	* src/sendmsg-window.c: do not include gnome.h.

2009-07-26  Peter Bloomfield

	* src/main-window.c: remove redundant gtk version checks and
	dead code.

2009-07-25  Peter Bloomfield

	* libinit_balsa/assistant_helper.c
	(balsa_init_create_to_directory): show specific error message.

2009-07-23  Peter Bloomfield

	Check for NULL InternetAddressList

	* libbalsa/send.c (do_multipart_crypto):
	* src/sendmsg-window.c (sw_cc_add_list):
	* src/store-address.c (store_address_add_list):

2009-07-21  Peter Bloomfield

	Save send type in draft message

	* src/sendmsg-window.h: new member is_continue.
	* src/sendmsg-window.c (delete_handler), (guess_identity),
	(sendmsg_window_new), (sendmsg_window_continue),
	(message_postpone): use it instead of SEND_CONTINUE.
	(sendmsg_window_set_title), (set_entry_to_subject),
	(replace_identity_signature): we no longer use SEND_CONTINUE.

2009-07-20  Peter Bloomfield

	* configure.in: make silent rules by default.

2006-07-12  Pawel Salek

	* src/sendmsg-window.c: do insert new signatures on identity
	switch (reported on balsa-list).

2009-07-09  Peter Bloomfield

	* src/message-window.c (mw_expunged_cb): check for NULL message.

2009-07-09  Peter Bloomfield

	* libbalsa/mailbox_mbox.c (libbalsa_mailbox_mbox_sync): check
	for error in GMimeParser.

2009-06-30  Peter Bloomfield

	* configure.in: test for res_init.
	* libbalsa/imap/imap-handle.c (imap_socket_open): use it to
	recover faster after reconnecting to the internet.

2009-06-27  Peter Bloomfield

	* src/spell-check.h: build --without-gtkspell.

2006-06-24  Pawel Salek

	* libbalsa/imap/imap-{commands,handle}.c: catch errors early on
	for more accurate error messages.
	* libbalsa/imap/imap_search.c: ditto.
	* libbalsa/imap/imap-handle.h: warn if idle_disable's result is ignored.
	* libbalsa/mailbox_imap.c: correct tranformation of rfc822 groups
	from ImapAddress to InternetAddress (together with Peter B).
	* src/sendmsg-window.c: check that string is not-null before
	setting window title.

2006-06-11  Pawel Salek

	* libbalsa/mailbox_imap.c: do not create empty address lists.
	This makes the message compose code believe that reply-to is set.

2009-06-07  Peter Bloomfield

	Build with threads disabled

	* libbalsa/mailbox.c (lbm_msgno_changed): fix conditional code.

2009-06-07  Peter Bloomfield

	Update display in an idle callback.

	* libbalsa/mailbox.h: new array of msgnos that have changed.
	* libbalsa/mailbox.c (libbalsa_mailbox_finalize),
	(lbm_msgno_changed_expunged_cb), (lbm_msgnos_changed_idle_cb),
	(lbm_msgno_changed), (libbalsa_mailbox_msgno_changed),
	(lbm_get_index_entry_real): use it to update display in an idle
	callback, instead of in the sub-thread in which the message info
	was set up.

2009-06-07  Peter Bloomfield

	* src/sendmsg-window.c (repl_identity_signature),
	(insert_initial_sig): remember cursor position when adding or
	changing signature.

2009-06-03  Peter Bloomfield

	Build with threads disabled

	* configure.in: must enable threads to use WebKit.
	* libbalsa/imap-server.c (libbalsa_imap_server_set_username),
	(libbalsa_imap_server_set_host), (libbalsa_imap_server_init),
	(libbalsa_imap_server_finalize), (lb_imap_server_cleanup),
	(get_or_create), (libbalsa_imap_server_get_handle),
	(libbalsa_imap_server_get_handle_with_user),
	(libbalsa_imap_server_release_handle),
	(libbalsa_imap_server_force_disconnect),
	(libbalsa_imap_server_close_all_connections),
	(libbalsa_imap_server_has_free_handles): use macros to manage
	locks.
	* libbalsa/imap/imap_private.h: add TRYLOCK macro.

2009-05-27  Peter Bloomfield

	* src/balsa-mime-widget-callbacks.c
	(balsa_mime_widget_key_press_event): emitting "popup-menu"
	requires the address of the return value.

2006-05-23  Pawel Salek

	* src/balsa-index.[ch]: switch between full and narrow index views.
	* src/main-window.[ch]: switch between ordinary and wide-screen layouts.
	* src/save-restore.c: save the layout as an enum.
	* src/balsa-app.[ch]: set default layout.
	* src/pref-manager.c: main window layout type is a drop-down list now.
	
2009-05-13  Peter Bloomfield

	* src/mailbox-node.c (find_dir), (balsa_mailbox_local_append):
	parent of a top-level mailbox should be the root node.

2009-05-13  Peter Bloomfield

	* src/mailbox-node.c (balsa_mailbox_node_rescan): clear
	mn->scanned, so that we append the subtree.

2009-05-07  Peter Bloomfield

	Implement select thread

	* src/balsa-index.c (balsa_index_select_thread): new method to
	select all messages in thread containing current message.
	* src/balsa-index.h: ditto.
	* src/main-window.c: use it.

2009-05-04  Peter Bloomfield

	Add filter for colorizing messages

	* libbalsa/filter.h: add FILTER_COLOR to FilterActionType enum,
	and FILTER_N_TYPES sentinel.
	* libbalsa/filter.c (libbalsa_filter_mailbox_messages): act on
	it.
	* libbalsa/libbalsa_private.h: add color members to
	LibBalsaMailboxIndexEntry.
	* libbalsa/mailbox.h: new methods to set color; expand
	LibBalsaMailboxColumn enum.
	* libbalsa/mailbox.c (lbm_index_entry_populate_from_msg),
	(mbox_model_init), (mbox_model_get_value), (lbm_set_color),
	(libbalsa_mailbox_set_foreground),
	(libbalsa_mailbox_set_background): implement them.
	* src/balsa-index.c (bndx_instance_init): set color in all
	columns.
	* src/filter-edit-callbacks.c (fe_action_selected),
	(fe_apply_pressed), (fe_filters_list_selection_changed),
	(fe_color_check_toggled), (fe_color_set):
	* src/filter-edit-dialog.c (fe_make_color_buttons),
	(build_action_page): add option to choose colors.
	* src/filter-edit.h: new callbacks.
	* src/filter-run-callbacks.c (fr_apply_selected_pressed_func),
	(fr_add_pressed_func): ditto.
	* src/save-restore.c (config_filter_load),
	(config_filters_load): scrap broken pre-2.1 compatibility code.

2009-04-29  Ildar Mulyukov

	* balsa.desktop.in: respect
	http://standards.freedesktop.org/menu-spec/latest/apa.html

2009-04-29  Peter Bloomfield

	* libbalsa/mailbox.h: new member sort_field_prev in
	LibBalsaMailboxView.
	* libbalsa/mailbox.c (libbalsa_mailbox_set_sort_field,
	mbox_compare_func, mbox_set_sort_column_id): use it to save
	previous sort_field, and to resolve ties wrt current
	sort_field--work around for lack of a stable mailbox sort.

2009-04-23  Peter Bloomfield

	bump version to 2.4.0, and require GMime-2.4, GLib-2.16, and
	Gtk-2.14.

2009-04-21  Peter Bloomfield

	port to GMime-2.4

2009-04-21  Peter Bloomfield

	create balsa-2-3 branch for updates to the pre-GMime-2.4 tree.

2009-04-21  Peter Bloomfield

	* balsa.doap: new description-of-a-project file.

2009-04-15  Peter Bloomfield

	* src/balsa-mime-widget.c: (balsa_mime_widget_new_unknown):
	ellipsize message label.

2009-04-06  Albrecht Dreß

	* src/balsa-print-object.c: (balsa_print_object_emb_message,
	balsa_print_object_mp_crypto,
	balsa_print_objects_append_from_body): fix mem leak, select
	print handlers from a list which needs two helpers due to
	different prototypes;
	* src/balsa-print-object-header.c:
	(balsa_print_object_header_new_real): fix mem leak;
	* src/print-gtk.c: (begin_print): simplify code.

2009-04-02  Peter Bloomfield

	Make sure that config.h is included before any header that
	refers to a symbol defined there.

	* libbalsa/address-book-gpe.h:
	* libbalsa/body.h:
	* libbalsa/filter-private.h:
	* libbalsa/gmime-stream-gio.h:
	* libbalsa/gmime-stream-gnome-vfs.h:
	* libbalsa/html.h:
	* libbalsa/identity.h:
	* libbalsa/libbalsa.h:
	* libbalsa/libbalsa_private.h:
	* libbalsa/mailbox.h:
	* libbalsa/message.h:
	* libbalsa/mime-stream-shared.h:
	* libbalsa/misc.h:
	* libbalsa/missing.h:
	* libbalsa/rfc3156.h:
	* libbalsa/send.h:
	* libbalsa/server.h:
	* libinit_balsa/Makefile.am:
	* libinit_balsa/assistant_page_defclient.h:
	* src/balsa-app.h:
	* src/balsa-bonobo.h:
	* src/balsa-icons.h:
	* src/balsa-message.h:
	* src/balsa-mime-widget-crypto.h:
	* src/balsa-print-object-header.h:
	* src/main-window.h:
	* src/print.h:
	* src/quote-color.h:
	* src/save-restore.h:
	* src/sendmsg-window.h:
	* libbalsa/libbalsa-conf.c: include config.h.
	* libinit_balsa/assistant_page_defclient.c: ditto.
	* libinit_balsa/assistant_init.c: ditto.

2009-04-02  Peter Bloomfield

	* src/balsa-print-object-decor.c: include config.h.
	* src/balsa-print-object-image.c: ditto.

2009-03-31  Albrecht Dreß

	* libbalsa/rfc2445.c: (libbalsa_vcal_new_from_body,
	date_time_2445_to_time_t): fix "critical" warnings due to
	comparison of wrong variable, and if a line is empty.
	* src/balsa-print-object-default.c:
	(balsa_print_object_default_draw): print the icon top-aligned.
	* src/balsa-print-object-text.c:
	(balsa_print_object_text_calendar): break huge iCal parts over
	multiple pages if necessary.

2009-03-26  Peter Bloomfield

	* libbalsa/missing_time.c: build with enable-threads.

2009-03-19  Peter Bloomfield

	* Makefile.am: install BonoboActivation files only if
	!BUILD_WITH_UNIQUE.
	* src/Makefile.am: ditto.

2009-03-19  Peter Bloomfield

	Build --without-esmtp

	* libbalsa/libbalsa.h: typedef LibBalsaSmtpServer only if
	ENABLE_ESMTP.
	* libbalsa/identity.h: include "libbalsa.h" instead of
	"smtp-server.h".

2006-03-19  Pawel Salek

	* libbalsa/imap/imap-handle.c: make IDLE startup asynchronous.
	* libbalsa/imap/imap_private.h: provide EAT_LINE macro.
	* libbalsa/imap/imap-commands.c: use it.

2009-03-13  Peter Bloomfield

	Offer libUnique as an alternative to BonoboActivation to ensure
	single instance.

	* configure.in: new option --with-unique=no.
	* src/Makefile.am: Bonobo files are conditional.
	* src/main.c: (main, balsa_main_check_new_messages,
	mw_message_received_cb, balsa_handle_automation_options):
	implement it.
	(balsa_init): Initialize Gtk only once, and check for error.

2009-03-11  Albrecht Dreß

	* libbalsa/rfc2445.c: (libbalsa_vcal_new_from_body): ignore
	nested description.
	* src/balsa-mime-widget-vcalendar.c: (balsa_vevent_widget): use
	GtkTextView to show wrapped description.

2009-03-11  Peter Bloomfield

	* libbalsa/address-book-ldap.c: (rfc_2254_escape): do not
	include gnome.h; use g_{new,free} instead of {malloc,free}.

2009-03-03  Peter Bloomfield

	Consistently initialize Gerror, and use g_clear_error when it
	helps.

	* libbalsa/gmime-stream-gio.c:
	* libbalsa/libbalsa-conf.c: (lbc_init), (lbc_sync):
	* libbalsa/mailbox_local.c: (lbm_local_save_tree):
	* libbalsa/source-viewer.c: (lbsv_app_set_menus):
	* src/ab-main.c: (get_main_menu), (main):
	* src/balsa-icons.c: (load_balsa_pixmap):
	* src/filter-edit-callbacks.c: (condition_dialog_response),
	(fe_dialog_response):
	* src/filter-run-callbacks.c: (fr_dialog_response):
	* src/main-window.c:
	* src/main.c: (main):
	* src/message-window.c: (message_window_new):
	* src/sendmsg-window.c: (sendmsg_window_new):

2009-03-03  Peter Bloomfield

	* libbalsa/identity.c: free force-key-id.
	* src/balsa-icons.c: (load_balsa_pixmap): unref icon-set.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text,
	bm_widget_new_vcard): free ptr in balsa_mime_widget_new_text
	instead of in bm_widget_new_vcard.

2009-03-01  Peter Bloomfield

	* libbalsa/mailbox_imap.c: (libbalsa_mailbox_imap_open): do not
	leak ImapCacheManager.

2009-02-28  Peter Bloomfield

	* libbalsa/body.c: (libbalsa_message_body_get_pixbuf): tell
	GdkPixbufLoader the mime type; some types, apparently including
	compressed SVG, cannot be reliably identified by looking at
	the data.

2009-02-28  Peter Bloomfield

	* src/main-window.c: tighten some old code.

2009-02-28  Peter Bloomfield

	* src/main.c: (initial_open_unread_mailboxes,
	initial_open_inbox, main): really check new mail after building
	the tree.

2009-02-27  Peter Bloomfield

	* src/main-window.c: 
	* src/main.c: (balsa_main_check_new_messages, main): on startup,
	check new mail in an idle handler, after the mailbox tree has
	been built.

2009-02-27  Peter Bloomfield

	* src/balsa-message.c: libbalsa_can_display is needed only if
	HAVE_GTKHTML.

2009-02-26  Paweł Sałek

	* libbalsa/imap/imap-commands.c: do not deadlock when opening imap
	mailbox with new messages, sorted on the client side.

2009-02-25  Peter Bloomfield

	make sure -DHAVE_CONFIG_H is passed as a compiler flag.
	* configure.in:
	* libbalsa/Makefile.am:
	* src/Makefile.am:

	Test HAVE_CONFIG_H before including config.h.
	* libbalsa/abook-completion.c:
	* libbalsa/address-book-extern.c:
	* libbalsa/address-book-gpe.c:
	* libbalsa/address-book-ldap.c:
	* libbalsa/address-book-ldif.c:
	* libbalsa/address-book-rubrica.c:
	* libbalsa/address-book-text.c:
	* libbalsa/address-book-vcard.c:
	* libbalsa/address-book.c:
	* libbalsa/address-view.c:
	* libbalsa/address.c:
	* libbalsa/body.c:
	* libbalsa/body.h:
	* libbalsa/cell-renderer-button.c:
	* libbalsa/files.c:
	* libbalsa/files.h:
	* libbalsa/filter-error.c:
	* libbalsa/filter-file.c:
	* libbalsa/filter-funcs.c:
	* libbalsa/filter.c:
	* libbalsa/folder-scanners.c:
	* libbalsa/folder-scanners.h:
	* libbalsa/gmime-gpgme-context.c:
	* libbalsa/gmime-part-rfc2440.c:
	* libbalsa/gmime-stream-gio.c:
	* libbalsa/gmime-stream-gio.h:
	* libbalsa/gmime-stream-gnome-vfs.c:
	* libbalsa/gmime-stream-gnome-vfs.h:
	* libbalsa/html.c:
	* libbalsa/html.h:
	* libbalsa/identity.c:
	* libbalsa/identity.h:
	* libbalsa/imap-server.c:
	* libbalsa/imap-server.h:
	* libbalsa/information.c:
	* libbalsa/libbalsa-conf.h:
	* libbalsa/libbalsa-vfs.c:
	* libbalsa/libbalsa-vfs.h:
	* libbalsa/libbalsa.c:
	* libbalsa/libbalsa.h:
	* libbalsa/mailbox-filter.c:
	* libbalsa/mailbox.c:
	* libbalsa/mailbox.h:
	* libbalsa/mailbox_imap.c:
	* libbalsa/mailbox_local.c:
	* libbalsa/mailbox_local.h:
	* libbalsa/mailbox_maildir.c:
	* libbalsa/mailbox_mbox.c:
	* libbalsa/mailbox_mh.c:
	* libbalsa/mailbox_pop3.c:
	* libbalsa/mailbox_remote.c:
	* libbalsa/message.c:
	* libbalsa/message.h:
	* libbalsa/mime-stream-shared.c:
	* libbalsa/mime-stream-shared.h:
	* libbalsa/mime.c:
	* libbalsa/misc.c:
	* libbalsa/missing_time.c:
	* libbalsa/rfc2445.c:
	* libbalsa/rfc3156.c:
	* libbalsa/rfc3156.h:
	* libbalsa/send.c:
	* libbalsa/send.h:
	* libbalsa/server.c:
	* libbalsa/smtp-server.c:
	* libbalsa/smtp-server.h:
	* libbalsa/source-viewer.c:
	* libinit_balsa/assistant_helper.c:
	* libinit_balsa/assistant_helper.h:
	* libinit_balsa/assistant_init.h:
	* libinit_balsa/assistant_page_defclient.h:
	* libinit_balsa/assistant_page_directory.c:
	* libinit_balsa/assistant_page_directory.h:
	* libinit_balsa/assistant_page_finish.c:
	* libinit_balsa/assistant_page_finish.h:
	* libinit_balsa/assistant_page_user.c:
	* libinit_balsa/assistant_page_user.h:
	* libinit_balsa/assistant_page_welcome.h:
	* libinit_balsa/balsa-druid-page-defclient.h:
	* libinit_balsa/balsa-druid-page-directory.h:
	* libinit_balsa/balsa-druid-page-finish.c:
	* libinit_balsa/balsa-druid-page-finish.h:
	* libinit_balsa/balsa-druid-page-user.c:
	* libinit_balsa/balsa-druid-page-user.h:
	* libinit_balsa/balsa-druid-page-welcome.h:
	* libinit_balsa/balsa-initdruid.h:
	* libinit_balsa/helper.c:
	* libinit_balsa/helper.h:
	* libinit_balsa/init_balsa.c:
	* src/ab-main.c:
	* src/ab-window.c:
	* src/ab-window.h:
	* src/address-book-config.c:
	* src/balsa-app.c:
	* src/balsa-bonobo.c:
	* src/balsa-bonobo.h:
	* src/balsa-icons.c:
	* src/balsa-icons.h:
	* src/balsa-index.c:
	* src/balsa-mblist.c:
	* src/balsa-message.c:
	* src/balsa-message.h:
	* src/balsa-mime-widget-callbacks.c:
	* src/balsa-mime-widget-callbacks.h:
	* src/balsa-mime-widget-crypto.c:
	* src/balsa-mime-widget-crypto.h:
	* src/balsa-mime-widget-image.c:
	* src/balsa-mime-widget-message.c:
	* src/balsa-mime-widget-multipart.c:
	* src/balsa-mime-widget-text.c:
	* src/balsa-mime-widget-vcalendar.c:
	* src/balsa-mime-widget.c:
	* src/balsa-print-object-default.c:
	* src/balsa-print-object-header.c:
	* src/balsa-print-object-header.h:
	* src/balsa-print-object-text.c:
	* src/balsa-print-object.c:
	* src/balsa-print-object.h:
	* src/filter-edit-callbacks.c:
	* src/filter-edit-dialog.c:
	* src/filter-export-callbacks.c:
	* src/filter-export-dialog.c:
	* src/filter-run-callbacks.c:
	* src/filter-run-dialog.c:
	* src/folder-conf.c:
	* src/information-dialog.c:
	* src/information-dialog.h:
	* src/mailbox-conf.c:
	* src/mailbox-node.c:
	* src/main-window.c:
	* src/main.c:
	* src/message-window.c:
	* src/pref-manager.c:
	* src/pref-manager.h:
	* src/print-gtk.c:
	* src/print.c:
	* src/print.h:
	* src/quote-color.c:
	* src/quote-color.h:
	* src/save-restore.c:
	* src/save-restore.h:
	* src/sendmsg-window.c:
	* src/sendmsg-window.h:
	* src/spell-check.c:
	* src/spell-check.h:
	* src/store-address.c:
	* src/store-address.h:
	* src/toolbar-factory.c:
	* src/toolbar-factory.h:
	* src/toolbar-prefs.c:
	* src/toolbar-prefs.h:

2009-02-25  Peter Bloomfield

	* src/main-window.h: add new_mail_tray and new_mail_note to
	BalsaWindow.
	* src/main-window.c: use gtk_window_set_urgency_hint to show new
	mail; consolidate notify::is-active handling.

2009-02-21  Paweł Sałek

	* libbalsa/files.c:
	* src/balsa-index.c: build against oldish gtk/gnome.
	* libbalsa/rfc2445.c: with gcc-3.x
	* libbalsa/imap/imap-commands.c: lock the handle when issuing
	asynchronous EXPUNGE.

2009-02-18  Paweł Sałek

	* src/sendmsg-window.c:, src/{ab-,}main.c:
	* libbalsa/rfc2445.c: we include stdlib.h unconditionally.
	
2009-02-16  Albrecht Dreß and Peter Bloomfield

	* src/balsa-message.c: (handle_mdn_request, create_mdn_reply,
	create_mdn_dialog, mdn_dialog_response): check all identities.
	* src/balsa-mime-widget-vcalendar.c: (vevent_reply): use
	smtp-server for attendee's identity.

2009-02-16  Albrecht Dreß

	* configure.in: detect the *time_r function declarations.
	* libbalsa/missing.h: HAVE_DECL_*TIME_R is always defined to a value.

2009-02-16  Albrecht Dreß and Paweł Sałek

	* src/main-window.c:
	  use g_(malloc|free) instead of malloc and free
	* src/sendmsg-window.c, src/ab-main.c, src/main.c:
	  add missing include of stdlib.h if it is available
	* configure.in: always define _XOPEN_SOURCE
	* libbalsa/missing.h: declare (local|gm|c)time_r if necessary
	* libbalsa/rfc2445.c: add proper casting macros, catch and convert
	\r\n line endings (iCal compatibility), work around iCal method
	parameter bug, fix crash on NULL pointers passed to conversion
	funcs.
	* libbalsa/filter-funcs.c: use glib for time conversion if available.
	* libbalsa/mailbox_imap.c: sync the cache when closing mbox.

2009-02-15  Peter Bloomfield

	* src/balsa-mime-widget-vcalendar.c: (balsa_vevent_widget,
	vevent_reply): check all identities.

2009-02-12  Peter Bloomfield

	* src/balsa-message.h: new member gint BalsaMessage::tab_position,
	the position of the tab for header values.
	* src/balsa-mime-widget.h: new member GtkWidget *
	BalsaMimeWidget::header_widget, pointer to the header widget for
	the message.
	* src/balsa-mime-widget-message.c: (balsa_mime_widget_new_message,
	balsa_mime_widget_new_message_tl, bm_header_widget_new,
	bmwm_set_tabs, add_header_gchar,
	balsa_mime_widget_message_set_headers, bmwm_buffer_set_prefs,
	balsa_mime_widget_message_set_headers_d): set the tab position 6
	pixels beyond the length of the longest header label; set user
	prefs for fonts and colors each time we render a message, in
	case prefs have changed.

2009-02-12  Inaki Larranaga Murgoitio  <dooteo@euskalgnu.org>

	* configure.in: Added 'eu' (Basque) to ALL_LINGUAS

2009-02-08  Albrecht Dreß

	* libbalsa/rfc2445.[hc]: Implement VCALENDAR and VEVENT objects.
	* src/balsa-mime-widget-vcalendar.[hc]:
	display vevent's, and the stuff for sending a text/calendar reply;
	* src/balsa-mime-widget.c: call functions to display text/calendar
	* src/balsa-print-object-text.[hc]:  support print these parts
	* src/balsa-print-object.c:: call functions to print text/calendar
	* src/balsa-message.c: make text/calendar the preferred part.
	* src/balsa-print-object-default.c: catch missing pixbuf
	* src/Makefile.am, libbalsa/Makefile.am: add new source files

2009-02-07  Albrecht Dreß

	* INSTALL: minimum gtk version upgraded, link cleanup (Incomplete!).
	* configure.in: Check min versions, new option for Mac OS X desktop,
	check for *time_r funcs, remove unnecessary check for iconv
	* src/filter-edit.h, src/balsa-index.c, src/balsa-mblist.c
	* src/mailbox-conf.c, src/filter-edit-dialog.c, src/pref-manager.c
	* src/address-book-config.c, libbalsa/misc.[hc]
	* libbalsa/libbalsa-conf.[hc], libbalsa/address.c, libbalsa/identity.c
	* src/filter-edit-callbacks.c:
	Assume we have Gtk+/glib >= 2.6.0
	* libbalsa/imap/imap_search.c:
	use GDate instead of localtime_r (avoid dependency to libbalsa)
	* libbalsa/rfc3156.c: use glib random func
	* libbalsa/Makefile.am, libbalsa/missing{_time.c,.h}:
	add system-dependent time_r funcs
	* src/main-window.c:
	Add basic Mac OS X menu integration, assume we have Gtk+/glib >= 2.6.0
	* src/sendmsg-window.c:
	Add basic Mac OS X menu integration, use g_strdup.
	* src/save-restore.[hc], libinit_balsa/assistant_page_defclient.[hc],
	* libinit_balsa/assistant_init.c:
	No Gnome default client without Gnome
	* src/toolbar-factory.c, src/main.c, src/Makefile.am
	Build without Gnome support
	* src/print-gtk.c: Mac OS X doesn't define _NL_MEASUREMENT_MEASUREMENT
	* src/balsa-icons.c:  Remove unnecessary include.
	* src/balsa-bonobo.[hc]: Only compiled if building with Gnome support
	* src/balsa-app.c:
	Gdk on Mac OS X cannot create a new colour map, fall back to system
	* src/ab-main.c:
	Build Gnome stuff only when available, assume we have Gtk+/glib >=
	2.6.0, add basic Mac OS X menu integration.

2009-02-07  Paweł Sałek

	* src/main-window.c: get rid of spurious new-mail notifications.

2009-01-25  Peter Bloomfield

	* libbalsa/mailbox_local.c: (lbm_local_restore_tree): check for
	stale cache file.
	* libbalsa/mailbox_mbox.c: (lbm_mbox_restore): ditto.

2009-01-24  Albrecht Dreß

	Small compatibility fixes

	* src/sendmsg-window.c: search for toplevel window, not for
	Gnome application;
	* libbalsa/send.c, libbalsa/imap/imap-handle.c: do not use
	strcasecmp which OS X apparently doesn't define;
	* libbalsa/rfc3156.c: use utf8-clean time conversion helper.

2009-01-23  Peter Bloomfield

	* src/main-window.c: use unique names in GtkActionGroup.
	* src/sendmsg-window.c: (sendmsg_window_ui_manager_new): ditto.

2009-01-23  Peter Bloomfield

	* src/main-window.c: Gtk-2.16 deprecation cleanup.

2009-01-21  Peter Bloomfield

	* libbalsa/body.c: (libbalsa_message_body_get_part_stream,
	libbalsa_message_body_get_message_part_stream): new helpers;
	(libbalsa_message_body_get_stream): use them;
	(libbalsa_message_body_get_content,
	libbalsa_message_body_save_stream): set GError when returning
	error.
	* libbalsa/files.c: (libbalsa_default_attachment_pixbuf,
	libbalsa_icon_finder): remove unused GError.
	* src/balsa-mime-widget-callbacks.c:
	(balsa_mime_widget_ctx_menu_save): clear GError.

2009-01-20  Peter Bloomfield

	* libbalsa/body.c: (libbalsa_message_body_get_stream): check
	that we have a GMimePart;
	(libbalsa_message_body_save_stream): use
	libbalsa_message_body_stream_add_filter;
	* libbalsa/mailbox_imap.c: (libbalsa_mailbox_imap_get_msg_part):
	check for GMimeMultipart and GMimeMessagePart, as well as
	GMimePart.

2009-01-20  Peter Bloomfield

	* libbalsa/gmime-stream-gio.c: (stream_read, stream_write,
	stream_seek, stream_substream,
	g_mime_stream_gio_new_with_bounds): build on 32-bit box with
	GMime-2.2.
	* libbalsa/gmime-stream-gio.h: ditto.

2009-01-20  Peter Bloomfield

	Fix BUG - threading view and selecting, reported by Mario
	Mikocevic <mario.mikocevic t-com hr>
	(http://mail.gnome.org/archives/balsa-list/2009-January/msg00015.html)

	* src/balsa-index.h: new boolean BalsaIndex::collapsing.
	* src/balsa-index.c:
	(bndx_test_collapse_row_cb) new callback to set it;
	(bndx_tree_collapse_cb): clear it;
	(bndx_selection_changed): use it to manage preview;
	(bndx_instance_init) connect to "test-collapse-row" signal to
	set it;

2009-01-18  Paweł Sałek

	* NEWS, configure.in: release 2.3.28

2009-01-16  Peter Bloomfield

	* libbalsa/misc.c: (libbalsa_set_fallback_codeset): do not
	allocate and leak strings, now that bug #509434 has been fixed.
	* src/balsa-icons.c: (load_balsa_pixmap): free the icon_source.
	* src/save-restore.c: include stdlib.h.
	* src/sendmsg-window.c: (delete_handler, sendmsg_window_set_title):
	do not leak address list.

2009-01-16  Paweł Sałek

	* libbalsa/files.c: simplify conditional code.
	* libbalsa/mailbox_imap.c: the only way to make sure that the
	exist handler does not trigger imap operations and a related
	deadlock is to process it entirely in an idle handler. Fetch
	message data using seqnos, otherwise we can get surprising EXPUNGE
	notifications. 
	* libbalsa/imap/imap-handle.c: some imap servers send data in the
	same packet as the IDLE prompt. Process it immediately.

2009-01-15  Peter Bloomfield

	* src/print-gtk.c: (add_margin_spinbtn): do not leak string.

2009-01-10  Peter Bloomfield

	* src/main-window.c: fix string--marcel telka sk (fixes bug
	#567323).

2009-01-03  Peter Bloomfield

	* src/sendmsg-window.c: (send_message_handler): fix
	string--leonardof gnome org (fixes bug #566426).

2009-01-03  Peter Bloomfield

	* libbalsa/imap/imap-commands.c: (imap_mbox_thread): do not
	shadow-declare rc.

2009-01-03  Albrecht Dreß

	* libbalsa/html.c: (libbalsa_html_new): tell WebKit the charset.

2009-01-03  Peter Bloomfield

	* libbalsa/send.c: (libbalsa_create_rfc2440_buffer): use
	ngettext to handle plural--leonardof gnome org (fixes bug
	#566420).

2009-01-03  Peter Bloomfield

	* libbalsa/gmime-gpgme-context.c: (g_mime_gpgme_encrypt):
	clarify string--leonardof gnome org (fixes bug #566415).

2009-01-02  Albrecht Dreß

	* configure.in: prefer gio >= 2.16.0, fallback to gnome-vfs.
	* libbalsa/gmime-stream-gnome-vfs.[hc]: build only if using gnome-vfs 
	* libbalsa/files.[hc]: implement icon lookup for gio
	* libbalsa/libbalsa-vfs.[hc]:  add support for GIO
	* libbalsa/gmime-stream-gio.[hc]: gmime gio stream wrapper.
	* libbalsa/misc.c: remove unnecessary #include of gnome-vfs.h
	* libbalsa/Makefile.am: add gmime-stream-gio.[hc]

	* src/balsa-print-object-default.c: use libbalsa-vfs instead of
	gnome-vfs, enabling in this way a clean GIO usage.
	
	* src/sendmsg-window.c: call external editor through gio or gnome-vfs;
	use libbalsa-vfs helper to open attachment with external app;
	show description in attachment list
	* src/balsa-mime-widget-callbacks.[ch]: use libbalsa-vfs to open parts
	* src/balsa-mime-widget-text.c: use changed balsa-mime-widget-callbacks API.
	* src/ab-window.c: launch app using glib
	* src/balsa-message.c: use description instead of plain MIME type.
	* src/balsa-mime-widget.c: create a mime button via libbalsa-vfs.
	
2009-01-02  Paweł Sałek

	* src/main-window.c: report number of deleted message duplicates.
	* libbalsa/mailbox.[ch]: provide it.
	* libbalsa/imap-server.c: using binary fetches breaks integrity checks.

2008-12-30  Paweł Sałek

	* NEWS, configure.in: release 2.3.27

2008-12-30  Paweł Sałek

	* libbalsa/imap/imap_search.c: keep ImapHandle locked when searching.
	* libbalsa/imap/imap-handle.c: .. and when switching to IDLE mode.
	* libbalsa/imap/imap-commands.c: and when threading and sorting.

2008-12-27  Paweł Sałek and Peter Bloomfield

	* src/balsa-mime-widget-message.c: call balsa_message_save_part()
	from header context menu.
	* src/balsa-message.[ch]: implement balsa_message_save_part().
	Call it from the "Message parts" tab.
	* libbalsa/mailbox_imap.c: mark GMimeMessagePart as saveable as well.
	* libbalsa/mailbox_local.c: ditto.
	* libbalsa/body.c: GMime streams for MessageParts have to be
	created in a particular way.

2008-12-24  Paweł Sałek

	* src/balsa-mblist.c: there are no unread mailboxes at destroy time.
	* src/balsa-message.c: display an interesting case of
	multipart/related embedded in a multipart/alternative.

2008-12-24  Peter Bloomfield

	* src/mailbox-node.c: (balsa_mailbox_node_rescan): handle rescan
	of whole tree (mn == NULL).

2008-12-24  Peter Bloomfield

	* src/balsa-app.c: (balsa_app_destroy): do not empty trash--it's
	too late.
	* src/main-window.c: in notebook-switch-page callback, check if
	Balsa is quitting.
	* src/save-restore.c: (sr_special_notify, config_mailbox_init):
	weak-ref special mailboxes, and at notify time, if Balsa is
	quitting, empty the trash.

2008-12-21  Paweł Sałek

	* configure.in: we require gnome-keyring >= 1.0
	Remove some of the race conditions as found with helgrind.
	* src/balsa-app.c: do not manually destroy widgets.
	* src/main.c: cleanup explicitly before exit from main, no signals
	needed.
	* libbalsa/mailbox_{imap,local}.c: lock mailbox.
	* libbalsa/mailbox.c: keep the lock a bit longer.
	* libbalsa/libbalsa.c: preregister more object types.
	* libbalsa/imap/imap-{commands,handle}.c: lock the handle.

2008-12-20  Peter Bloomfield

	button for MDN in message composition toolbar (Jean-Luc Coulon)

	* src/balsa-icons.h: define new icon.
	* src/balsa-icons.c: (register_balsa_pixmaps): register it as
	"stock_mail-reply".
	* src/toolbar-factory.c: list it with short label.
	* src/sendmsg-window.c: use it with tooltip.

2008-12-14  Paweł Sałek

	* src/main-window.c: Add ability to display recent messages only.
	* libbalsa/imap-server.c: give more details in error messages.
	* libbalsa/imap/imap-handle.c: ditto.
	* libbalsa/imap/imap-commands.[ch]: Add "peek" argument to 
	imap_mbox_handle_fetch_rfc822().
	
2008-12-06  Peter Bloomfield

	rewrite of libbalsa_insert_with_url

	* libbalsa/mime.c: (libbalsa_unwrap_buffer, mark_urls,
	prescanner, libbalsa_html_encode_hyperlinks):
	pass string length to prescanner;
	(get_ml_url_reg): make sure the url ends with a real url
	character;
	(libbalsa_insert_with_url): avoid allocating and freeing
	strings.
	* libbalsa/misc.h: new signature for libbalsa_url_cb_t.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	avoid allocating and freeing strings;
	(url_found_cb): new signature for libbalsa_url_cb_t.
	* src/sendmsg-window.c: (edit_with_gnome_check,
	repl_identity_signature, insert_selected_messages,
	drag_data_quote, continue_body, fill_body_from_part,
	insert_signature_cb, sendmsg_window_set_field,
	do_insert_string_select_ch, insert_file_response,
	sw_wrap_body, sendmsg_window_new_from_list): use
	gtk_text_buffer_insert_at_cursor instead of
	libbalsa_insert_with_url.

2008-12-03  Peter Bloomfield

	* libbalsa/html.c: (lbh_size_request_cb, libbalsa_html_new): use
	gtk_widget_set_scroll_adjustments instead of a signal; dynamic
	cast once instead of many times.

2008-12-01  Peter Bloomfield

	Initial experimental support for WebKit.

	* configure.in: configure it.
	* libbalsa/html.c: (lbh_hovering_over_link_cb,
	lbh_size_request_cb, lbh_navigation_requested_cb,
	libbalsa_html_new, libbalsa_html_to_string,
	libbalsa_html_can_zoom, libbalsa_html_zoom,
	libbalsa_html_can_select, libbalsa_html_select_all,
	libbalsa_html_copy, lbh_new): new conditional section; new api
	needed, because WebKitWebView has different signals and is not a
	subclass of GtkLayout.
	* libbalsa/html.h: new api.
	* src/balsa-mime-widget-text.c: (pointer_over_url,
	bm_widget_on_url, bm_widget_link_clicked, bm_widget_new_html):
	adapt to new api.

2008-11-22  Albrecht Dreß

	Use only static format strings.

	* libbalsa/libbalsa-vfs.c: (libbalsa_vfs_create_stream),
	(libbalsa_vfs_file_unlink):
	* libbalsa/send.c: (libbalsa_message_create_mime_message):
	* src/ab-main.c: (ab_warning):
	* src/sendmsg-window.c: (check_suggest_encryption),
	(send_message_handler):
	* src/store-address.c: (store_address_from_entries):

2008-11-22  Peter Bloomfield

	* libinit_balsa/assistant_init.c: include stdlib.h.
	* libinit_balsa/assistant_page_directory.c: ditto.
	* src/balsa-app.c: ditto.
	* src/balsa-mime-widget-text.c: ditto.
	* src/spell-check.c: ditto.

2008-11-22  Peter Bloomfield

	* libbalsa/html.h: work around gtkhtml2's use of deprecated api.

2008-11-22  Peter Bloomfield

	disable deprecated apis only in svn tree (fixes bug #561875).

	* configure.in:
	* libbalsa/Makefile.am: 
	* libinit_balsa/Makefile.am:
	* src/Makefile.am:

2008-11-21  Paweł Sałek

	* src/save-restore.c: connect signal to ask interactively for SMTP
	passwords.
	* src/balsa-app.c: display the type of the password (imap/smtp).
	* libbalsa/smtp-server.c: ask for password when one needs one.

2008-11-19  Paweł Sałek

	* configure.in: detect gnome-keyring-2.24 to work around bug 556530.
	* libbalsa/{imap-,}server.c: store passwords asap to keyring (Peter B.).
	* libbalsa/server.h: use own schema only with buggy gnome-keyring.

2008-11-17  Peter Bloomfield

	* src/main-window.c: make "about" website clickable.

2008-11-17  Paweł Sałek

	* src/{folder,mailbox}-conf.c: capitalize according to HID.
	* src/{balsa-app,pref-manager}.c: ditto.
	* libbalsa/identity.c: ditto.
	* configure.in: gnome-keyring detection.
	* libbalsa/smtp-server.c: store server protocol.
	* libbalsa/imap-server.c: read password from keyring.
	* libbalsa/server.[ch]: ditto.

2008-11-16  Paweł Sałek

	* src/balsa-mime-widget-{message,text}.c: fall back to gnome_url_Show
	if gtk2 >= 2.14.0 is unavailable.
	* src/sendmsg-window.c: ditto.

2008-11-15  Peter Bloomfield

	Use gtk_show_uri instead of gnome_help_display and
	gnome_url_show, in various places; no longer need to include
	<gnome.h> in as many places.

	* libbalsa/identity.c: (help_ident_cb): replace
	gnome_help_display and gnome_url_show with gtk_show_uri.
	* libbalsa/smtp-server.c: (smtp_server_response): ditto.
	* src/address-book-config.c: (help_button_cb): ditto.
	* src/balsa-message.c: ditto.
	* src/balsa-mime-widget-callbacks.c: ditto.
	* src/balsa-mime-widget-message.c: (extbody_call_url): ditto.
	* src/balsa-mime-widget-text.c: (handle_url),
	(balsa_gtk_html_link_clicked): ditto.
	* src/filter-edit-callbacks.c: (condition_dialog_response),
	(fe_dialog_response): ditto.
	* src/filter-run-callbacks.c: (fr_dialog_response): ditto.
	* src/folder-conf.c: (folder_conf_response): ditto.
	* src/main-window.c: ditto.
	* src/message-window.c: ditto.
	* src/pref-manager.c: (balsa_help_pbox_display): ditto.
	* src/sendmsg-window.c: (on_open_url_cb): ditto.
	* src/toolbar-prefs.c: (tp_dialog_response_cb): ditto.
	* src/balsa-app.h: do not include <gnome.h>
	* src/balsa-index.h: ditto.
	* src/balsa-message.h: ditto.
	* src/spell-check.c: ditto.
	* src/spell-check.h: ditto.
	* src/balsa-mime-widget.h: ditto.
	* libbalsa/body.h: include <sys/stat.h>.

2008-11-14  Peter Bloomfield

	* libbalsa/address-book.c: include only top level <gtk/gtk.h>.
	* libbalsa/address-view.h: ditto.
	* libbalsa/cell-renderer-button.h: ditto.
	* libbalsa/information.c: ditto.
	* src/balsa-cite-bar.h: ditto.

2008-11-08  Paweł Sałek

	* configure.in: replace --without-gnome with --with-gnome to reduce 
	confusion described on the web site.
	* doc/balsa.omf.in: fix #559825.

2008-10-14  Peter Bloomfield & Pawel Salek

	* bootstrap.sh: run gnome-doc-prepare.
	* src/Makefile.am: clean generated IDL files.
	* doc/C/balsa.xml: follow DTD.
	* doc/Makefile.am: use new gnome-doc format.
	* sounds/Makefile.am: clean up generated files.
	* configure.in: detect gnome-doc
	* Makefile.am: adapt to gnome-doc.

2008-10-12  Petr Kovar  <pknbe@volny.cz>

	* configure.in: Added "be" and "mk" to ALL_LINGUAS.

2008-10-09  Peter Bloomfield

	* src/main-window.c: smaller notebook tab button.

2008-10-08  Peter Bloomfield

	* src/main-window.c: update the magic number.

2008-10-03  Mario Blättermann <mariobl@svn.gnome.org>

	* doc/de/*: Added partial German translation
	* doc/Makefile.am: Added de to the translation subdirs

2008-09-28  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: turn off debugging.

2008-09-22  Peter Bloomfield

	* src/pref-manager.c: (checking_group, misc_group,
	deleting_messages_group): GtkAdjustment::page_size must be zero
	when the GtkAdjustment is used in a GtkSpinButton.

2008-09-15  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: (lbm_mbox_stream_seek_to_message):
	fix stupid comparison.

2008-09-15  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: (lbm_mbox_stream_seek_to_message):
	do not trash stack.

2008-09-15  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: (lbm_mbox_stream_seek_to_message,
	libbalsa_mailbox_mbox_check): cast off_t and ssize_t to long in
	calls to g_print.

2008-09-14  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: (lbm_mbox_stream_seek_to_message):
	better debugging.

2008-09-14  Paweł Sałek

	* src/balsa-index.c: process messages with external program -
	asynchronously.

2008-09-14  Peter Bloomfield

	* libbalsa/body.c:
	(libbalsa_message_body_get_stream): fail if message has no mailbox.
	* libbalsa/mailbox_mbox.c:
	(free_message_info, free_messages_info): plug memory leak;
	(lbm_mbox_stream_seek_to_message, libbalsa_mailbox_mbox_open,
	libbalsa_mailbox_mbox_sync): debugging output;
	(libbalsa_mailbox_mbox_check): ditto; more careful check for
	new mail.
	* src/balsa-mime-widget-text.c:
	(balsa_mime_widget_new_text): check for NULL part.
	* src/balsa-print-object-text.c:
	(balsa_print_object_text_vcard): ditto
	* src/sendmsg-window.c:
	(fill_body_from_part, bsm_finish_setup): ditto.

2008-09-13  Peter Bloomfield

	* src/balsa-icons.c: (load_balsa_pixmap): add more fallbacks to
	cope with woeful gnome-icon-theme-2.23+; use
	GTK_STOCK_MISSING_IMAGE when all else fails, to avoid Gtk
	warnings.

2008-09-09  Peter Bloomfield

	Gtk 2.14 deprecation cleanup

	* libbalsa/mailbox.c: (mbox_set_sort_func),
	(mbox_set_default_sort_func):
	* libbalsa/source-viewer.c: (libbalsa_show_message_source):
	* libinit_balsa/assistant_page_user.c:
	(balsa_druid_page_user_init):
	* libinit_balsa/balsa-druid-page-user.c:
	(balsa_druid_page_user_init):
	* src/ab-window.c: (balsa_ab_window_get_type):
	* src/ab-window.h:
	* src/balsa-cite-bar.c: (balsa_cite_bar_class_init):
	* src/balsa-index.c: (balsa_index_get_type), (bndx_class_init),
	(bndx_popup_menu_create), (create_stock_menu_item):
	* src/balsa-index.h:
	* src/balsa-mblist.c: (balsa_mblist_get_type):
	* src/balsa-mblist.h:
	* src/balsa-message.c: (balsa_message_get_type),
	(tree_mult_selection_popup), (add_to_attachments_popup),
	(add_toggle_inline_menu_item):
	* src/balsa-message.h:
	* src/balsa-mime-widget.h:
	* src/filter-edit-callbacks.c: (build_type_notebook):
	* src/mailbox-conf.c: (run_mailbox_conf), (mailbox_conf_new),
	(create_local_mailbox_dialog), (create_pop_mailbox_dialog),
	(create_imap_mailbox_dialog):
	* src/mailbox-conf.h:
	* src/mailbox-node.c: (add_menu_entry),
	(balsa_mailbox_node_get_context_menu):
	* src/main-window.c:
	* src/main-window.h:
	* src/sendmsg-window.c: (add_attachment), (add_urlref_attachment),
	(bsmsg_check_format_compatibility):
	* src/spell-check.c: (balsa_spell_check_get_type),
	(balsa_spell_check_class_init):
	* src/spell-check.h:

2006-09-07  Paweł Sałek

	* libbalsa/imap/imap-handle.c: don't g_source_remove() twice.
	* NEWS, configure.in: release 2.3.26.

2006-09-06  Paweł Sałek

	* src/balsa-bonobo.c: raise main window after receiving Bonobo cmds.
	* src/balsa-app.c: add some HIG padding in the password dialog.
	* src/balsa-message.c: specify parent for the MDN dialog.
	* balsa.spec.in: merge minor fixes from Fedora's spec.
	* libbalsa/imap/imap-handle.c: process HUPs on idle IMAP connections.

2008-08-28  Albrecht Dreß

	specify a key id for an identity

	* doc/C/balsa.xml: document it.
	* libbalsa/gmime-gpgme-context.c: (get_key_from_name):
	check whether it's a name or an id.
	* libbalsa/identity.c: (libbalsa_identity_init,
	libbalsa_identity_finalize, setup_ident_frame,
	ident_dialog_update, display_frame_update,
	libbalsa_identity_new_config, libbalsa_identity_save): new entry
	for forced key id.
	* libbalsa/identity.h: new member for forced key id.
	* libbalsa/message.c: (libbalsa_message_init,
	libbalsa_message_finalize): ditto.
	* libbalsa/message.h: ditto.
	* libbalsa/send.c: (lb_send_from): use it.
	* src/sendmsg-window.c: (bsmsg2message): set it.

2008-08-24  Peter Bloomfield

	* src/main-window.c: simplify get-toolbar and ui-manager.
	* src/main-window.h: ditto.
	* src/message-window.c: (message_window_ui_manager_new,
	message_window_get_toolbar_model, message_window_new): ditto.
	* src/message-window.h: ditto.
	* src/pref-manager.c: (apply_prefs): ditto.
	* src/sendmsg-window.c: (sendmsg_window_ui_manager_new,
	sendmsg_window_get_toolbar_model, sendmsg_window_new): ditto.
	* src/sendmsg-window.h: ditto.
	* src/toolbar-prefs.c: (customize_dialog_cb): ditto.

2008-08-23  Peter Bloomfield

	* libbalsa/mime.c: (libbalsa_wrap_view, libbalsa_unwrap_buffer):
	no more soft newlines.
	* libbalsa/misc.h: remove libbalsa_prepare_delsp.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	no soft-newline tag.
	* src/sendmsg-window.c: (create_text_area): no soft-newline tag;
	(bsmsg2message): remove libbalsa_prepare_delsp.

2008-08-20  Peter Bloomfield

	* libbalsa/mime.c: (dowrap_rfc2646): do not append a space after
	a trailing tab when format=flowed.

2008-08-20  Peter Bloomfield

	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	plug memory leak.

2008-08-20  Peter Bloomfield

	* src/sendmsg-window.c: (bsmsg2message): pass the message to
	sw_wrap_body even if it is flowed, so that
	libbalsa_unwrap_buffer will remove whitespace preceding a hard
	newline.

2008-08-03  Peter Bloomfield

	* libbalsa/send.c: (lbs_list_n_addresses): count the addresses
	in an InternetAddressList;
	(lbs_process_queue): handle a message with a single Bcc: holder
	and no other recipients.

2008-08-03  Peter Bloomfield

	* src/sendmsg-window.c: (find_locale_index_by_locale): return -1
	if locale is not found;
	(create_lang_menu): default spell-check language to first item
	in menu, when balsa_app.spell_check_lang is not found;
	(sendmsg_window_continue): find_locale_index_by_locale is
	now signed.

2008-08-03  Peter Bloomfield

	* libbalsa/body.c: (libbalsa_message_body_set_message_part):
	handle NULL value from g_mime_message_part_get_message.

2008-07-30  Paweł Sałek

	* libbalsa/gmime-part-rfc2440.c: wrapper is not guaranteed to exist.
	* libbalsa/gmime-application-pkcs7.c: ditto.
	* libbalsa/body.c: ditto.
	* libbalsa/mailbox_imap.c: remove cache file if download failed.

2008-07-02  Peter Bloomfield

	* libbalsa/address.c: (vcard_strsplit): skip empty fields;
	(libbalsa_address_new_from_vcard): return NULL if the we do not
	find a complete vCard with at least one address.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	check text/directory as well as text/x-vcard; check for NULL
	return value;
	(bm_widget_new_vcard): return NULL if
	libbalsa_address_new_from_vcard returns NULL.
	* src/balsa-print-object-text.c:
	(balsa_print_object_text_vcard): print broken text/x-vcard and
	non-vcard text/directory parts as text/plain instead of default.
	* src/balsa-print-object.c:
	(balsa_print_objects_append_from_body): check text/directory as
	well as text/x-vcard.

2008-06-17  Peter Bloomfield

	* libbalsa/mailbox.c: (lbm_cache_message,
	libbalsa_mailbox_get_message, lbm_get_index_entry_real,
	lbm_get_index_entry, libbalsa_mailbox_cache_message): cache
	message info for the display at get-message time.
	* libbalsa/mailbox_mbox.c: (parse_mailbox): remove redundant
	call to libbalsa_mailbox_cache_message.

2008-06-17  Peter Bloomfield

	* libbalsa/libbalsa_private.h: scrap unused cache-unseen-child
	code.
	* libbalsa/mailbox.c: (lbm_index_entry_populate_from_msg,
	lbm_node_has_unseen_child, lbm_msgno_changed,
	lbm_set_threading, mbox_model_get_value): ditto.

2008-06-14  Paweł Sałek

	* NEWS, configure.in: release 2.3.25.

2008-06-12  Peter Bloomfield

	* libbalsa/mailbox_mbox.c: (lbm_mbox_header_cb, parse_mailbox),
	libbalsa_mailbox_mbox_sync): declare GMimeParserHeaderRegexFunc
	callback properly, and do not cast references to it.

2008-06-11  Paweł Sałek

	* libbalsa/imap/imap-handle.c: detect disconnect on write.
	* src/ab-main.c: add "Delete Entry" menu entry.

2008-06-05  Peter Bloomfield

	New method libbalsa_mailbox_index_entry_clear to avoid using
	libbalsa_mailbox_cache_message with a NULL message to clear the
	index entry.

	* libbalsa/mailbox.h: remove
	libbalsa_mailbox_index_entry_free--no need to export;
	new method libbalsa_mailbox_index_entry_clear.
	* libbalsa/mailbox.c: (lbm_index_entry_free,
	libbalsa_mailbox_index_entry_clear,
	libbalsa_mailbox_free_mindex, libbalsa_mailbox_msgno_removed):
	replace public
	libbalsa_mailbox_index_entry_free with static
	lbm_index_entry_free; new public method
	libbalsa_mailbox_index_entry_clear;
	(libbalsa_mailbox_cache_message): require a non-NULL message.
	* libbalsa/mailbox_imap.c: (imap_exists_cb): use
	libbalsa_mailbox_index_entry_clear.

2008-06-04  Peter Bloomfield

	* libbalsa/mime.c: (process_mime_part): quote a flowed message
	as flowed.

2008-06-04  Peter Bloomfield

	* src/balsa-mime-widget-message.c: (add_header_gchar): look
	further into the value, to make sure we detect a long header
	field.

2008-06-02  Peter Bloomfield

	* src/balsa-mime-widget-message.c: (bm_header_widget_new,
	add_header_gchar): let GtkTextView wrap headers.

2008-06-01  Peter Bloomfield

	* src/main-window.c: tighten code.
	* src/message-window.c: (mw_header_activate): do not change
	balsa-app.shown_headers.
	(show_all_headers_tool_cb): tighten code.

2008-06-02  Pawel Salek

	* libbalsa/imap/imap-handle.c: be more robust to servers returning
	resposes in a changed order. Handle GMail's wrong BODYSTRUCTURE
	response.
	* libbalsa/imap/imap_private.h: define ImapFetchBodyType to detect
	changed response order.
	* libbalsa/imap/imap-commands.c: detect changed response order.

2008-06-01  Peter Bloomfield

	* src/balsa-message.h: remove unused member show_all_headers.
	* src/balsa-message.c: (balsa_message_init): do not init it.
	* src/balsa-mime-widget-message.c: (add_header_gchar,
	add_header_address_list,
	balsa_mime_widget_message_set_headers_d): do not test it.

2008-06-01  Peter Bloomfield

	Make the new mail tray icon optional.

	* src/balsa-app.h: new member notify_new_mail_icon.
	* src/balsa-app.c: (balsa_app_init): initialize it to 1.
	* src/main-window.c: test it.
	* src/pref-manager.c: (open_preferences_manager, apply_prefs,
	set_prefs, checking_group): manage it.
	* src/save-restore.c: (config_global_load, config_save): load
	and save it.

2008-06-01  Peter Bloomfield

	* src/main-window.c: reassign icons to get "Expunge" as a
	toolbar option.
	* src/toolbar-factory.c: change labels accordingly.

2008-06-01  Pawel Salek

	* src/balsa-mime-widget-message.c: truncate long headers when
	"view selected" is chosen.

2008-05-31  Pawel Salek

	* configure.in, NEWS: release 2.3.24

2008-05-25  Albrecht Dreß

	Offer the option of sending a new message with both text/plain
	and text/html versions, specifically to avoid right-to-left text
	being mangled by text-to-html converters. The option is
	per-identity.

	* libbalsa/body.h: new member for html version.
	* libbalsa/body.c: (libbalsa_message_body_new,
	libbalsa_message_body_free): manage it.
	* libbalsa/identity.h: new member for option.
	* libbalsa/identity.c: (libbalsa_identity_init,
	libbalsa_identity_set_send_mp_alternative, setup_ident_frame,
	ident_dialog_update, display_frame_update,
	libbalsa_identity_new_config, libbalsa_identity_save): manage
	the option.
	* libbalsa/misc.h: new methods for html version.
	* libbalsa/mime.c: (libbalsa_html_encode_hyperlinks,
	libbalsa_text_to_html): implement them.
	* libbalsa/send.c: (add_mime_body_plain,
	libbalsa_message_create_mime_message,
	libbalsa_create_rfc2440_buffer): create multipart/alternative
	message with text/plain and text/html parts.
	* src/sendmsg-window.h: new member for html option.
	* src/sendmsg-window.c: (update_bsmsg_identity,
	sendmsg_window_new, sendmsg_window_continue, bsmsg2message,
	send_message_handler, message_postpone, toggle_mp_alt_cb):
	manage and act on the option.

2008-05-17  Peter Bloomfield

	* libbalsa/message.c:
	(libbalsa_message_load_envelope_from_stream): crlf-filter the
	stream; detect end-of-file by failed read instead of
	g_mime_stream_eos.

2008-04-29  Peter Bloomfield

	* src/sendmsg-window.c: (create_lang_menu): fix whining from
	Enchant via GtkSpell.

2008-04-28  Peter Bloomfield

	* src/sendmsg-window.c: use GTK_STOCK_EDIT for "Edit with Gnome".
	* src/toolbar-factory.c: add it to the legal toolbar buttons.

2008-04-28  Peter Bloomfield

	* src/balsa-index.c: (balsa_index_select_all): emit changed
	signal; (balsa_index_count_selected_messages): new method.
	* src/balsa-index.h: new method
	balsa_index_count_selected_messages.
	* src/main-window.c: use it to manage menu item sensitivity.
	* src/main-window.h: subdivide GtkActionGroups.

2008-04-25  Pawel Salek

	* libbalsa/mailbox_imap.c: create header even for empty parts.

2008-04-25  Albrecht Dreß

	* src/balsa-mime-widget-message.c: use URIs instead of paths.
	* src/sendmsg-window.[ch]: use gnome-vfs for attachment reading.
	* src/balsa-mime-widget-callbacks.c: ditto.
	* src/balsa-message.c: allow saving to URIs.
	* src/main.c: -o flag accepts an URI now.
	* src/information-dialog.h: add argument checking.
	* libbalsa/misc.[hc]: return more detailed error information.
	* libbalsa/body.h: store attachment URIs.
	* libbalsa/send.[ch]: handle errors when reading from URIs.
	* libbalsa/files.[ch]: file access operations use URIs now.
	* libbalsa/misc.c: move some functions to libbalsa-vfs.c
	* libbalsa/body.c: part operations accept URIs now.

2008-04-22  Pawel Salek

	* src/balsa-app.c: format=flowed by default.
	* libinit_balsa/assistant_page_user.[ch]: guess more stuff.
	* libinit_balsa/assistant_init.c: we have new code already, keep
	it silent.

2008-04-21  Peter Bloomfield

	* libbalsa/misc.h: if !USE_REGEX is enough.

2008-04-21  Peter Bloomfield

	* configure.in: implement --enable-gregex (default=no); change
	default for --enable-pcre to no.
	* libbalsa/filter-funcs.c: (libbalsa_condition_regex_free):
	condition on USE_REGEX.
	* libbalsa/filter-private.h: ditto.
	* libbalsa/mime.c: (mark_urls, libbalsa_insert_with_url,
	libbalsa_unwrap_selection): ditto.
	* libbalsa/misc.h: ditto.
	* src/balsa-app.c: ditto.
	* src/balsa-app.h: ditto.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	ditto.
	* src/balsa-print-object-text.c:
	(balsa_print_object_text_plain): ditto.
	* src/print.c: (print_wrap_body): ditto.
	* src/quote-color.c: (is_a_quote): ditto.
	* src/quote-color.h: ditto.
	* src/sendmsg-window.c: (reflow_selected_cb): ditto.
	* src/spell-check.c: (balsa_spell_check_start,
	balsa_spell_check_destroy, next_word): ditto.

2008-04-19  Peter Bloomfield

	* libbalsa/message.c: (lbmsg_set_header): scrap remaining
	warnings.

2008-04-12  Peter Bloomfield

	* libbalsa/mailbox_maildir.c: (lbm_maildir_parse_subdirs,
	libbalsa_mailbox_maildir_sync): make sure the tree is saved
	after reparsing subdirs.

2008-04-09  Pawel Salek

	* src/sendmsg-window.c: make postpone button and menu entry work.
	* libbalsa/message.c: do not complain when setting headers->from again.
	* libbalsa/imap/imap-handle.[ch]: make set_timeout() return the
	old value.
	* libbalsa/imap/imap_private.h: add HANDLE_TRYLOCK macro.
	* libbalsa/imap/imap-commands.c: use it for noop().

2008-04-06  Pawel Salek

	* libbalsa/imap/imap-handle.h: fix that macro.

2008-04-06  Pawel Salek

	* libbalsa/mailbox_imap.c: initalise ImapSequence data.
	* libbalsa/imap/imap-handle.h: provide a macro for that purpose.

2008-04-03  Pawel Salek

	* libbalsa/mailbox_imap.c: don't print warnings on copy when
	UIDPLUS is unavailable. Better code reuse.
	* libbalsa/message.c: don't modify invariants.

2008-04-02  Ildar Mulyukov <ildar at altlinux dot ru>

	* src/sendmsg-window.c: Some RU/KZ locales fixes.

2008-04-01  Pawel Salek

	* libbalsa/mailbox_imap.c: use UIDPLUS information returned by server
	to improve caching.
	* libbalsa/imap/imap-handle.[ch]: parse returned UIDPLUS data.
	* libbalsa/imap/imap_private.h: add ImapMboxHandle::uidplus field.
	* libbalsa/imap/imap-commands.[ch]: add API for accessing UIDPLUS data.

2008-03-31  Pawel Salek

	* src/spell-check.h: remove lingering reference to pspell.h
	* balsa.spec.in: update to modern standards.

2008-03-30  Peter Bloomfield

	* src/filter-edit-callbacks.c: (fill_condition_widgets): fix a
	critical warning.

2008-03-29  Jean-Luc Coulon

	* doc/C/balsa.xml: fix typos.

2008-03-26  Peter Bloomfield

	* src/balsa-message.c: (add_toggle_inline_menu_item): clear
	force-inline when we create a new check-box.

2008-03-25  Pawel Salek

	* src/balsa-index.c: pass "peek" parameter to get_message_stream().
	* libbalsa/{message,source-viewer}.c: ditto.
	* libbalsa/mailbox.[ch]: get_message_stream() has "peek" parameter now.
	* libbalsa/mailbox_{mh,mbox,maildir}.c: make related trivial changes.
	* libbalsa/mailbox_imap.c: pass "peek" further to save one RTT.

2008-03-20  Peter Bloomfield

	* src/balsa-message.c: (bm_find_again): actually show "Wrapped".

2008-03-20  Pawel Salek

	* libbalsa/imap/imap_search.[ch]: make it easier to explicitly
	select message sets for searching.
	* libbalsa/imap/imap-handle.c: put coalesce routines back here.
	* libbalsa/imap/imap-handle.h: move search functions to imap_search.h
	* libbalsa/imap/imap_private.h: declare coalesce routines here.
	* libbalsa/imap/imap-commands.c: remove coalesce routines.

2008-03-20  Peter Bloomfield

	* libbalsa/misc.{c,h}: (libbalsa_path_is_below_dir): careful
	check for a file being below a directory.
	* src/mailbox-conf.c: (mailbox_conf_add): use it.
	* src/mailbox-node.c: (check_local_path): ditto.
	* src/save-restore.c: (config_mailbox_set_as_special): ditto.
	* src/sendmsg-window.c: (render_attach_size): use
	g_format_size_for_display.
	* libinit_balsa/assistant_page_directory.c:
	(balsa_druid_page_directory_prepare): use g_build_filename.

2008-03-20  Pawel Salek

	* src/main-window.c: Fix a runtime warning.
	* configure.in, NEWS: release 2.3.23
	* doc/C/balsa.xml: document Face and X-Face headers.

2008-03-19  Albrecht Dreß

	* doc/C/balsa.xml: document crypto in help file for composer and
	identities dialogs.

2008-03-16  Pawel Salek

	* src/balsa-mime-widget-text.c: plug a leak if gtkhtml disabled.
	* libbalsa/mailbox_mbox.c: release all resources before disposing
	the mailbox.
	* libbalsa/message.c (lbmsg_set_header): plug a leak.
	
2008-03-11  Peter Bloomfield

	* libbalsa/mime.c: (mark_urls, libbalsa_insert_with_url): plug
	leaks, and clean up conditional code.

2008-03-09  Pawel Salek

	* src/ab-main.c: trying out alternative address book layout.
	* libbalsa/{address,address-book-ldif}.c: plug some memory leaks.

2008-03-09  Albrecht Dreß

	* libbalsa/rfc3156.c: (gpg_keyserver_op, check_gpg_child): add
	"refresh" as an alternative action to "import".
	* libbalsa/rfc3156.h: add gpg_keyserver_action_t enum for
	actions.
	* src/balsa-mime-widget-crypto.c:
	(balsa_mime_widget_signature_widget, on_gpg_key_button):
	implement "refresh" button.

2008-03-03  Pawel Salek

	* libbalsa/mailbox_imap.c: peek only into mailboxes, do no trigger
	implicit \seen flag toggling.
	* libbalsa/imap/imap-handle.c: recognize BODY[TEXT].
	* libbalsa/imap/imap-commands.[ch]: add peek argument.

2008-03-03  Peter Bloomfield

	* libbalsa/mailbox.c: (libbalsa_mailbox_messages_change_flags):
	do not crash when mindex == NULL.

2008-03-02  Peter Bloomfield

	* src/balsa-index.c: (bndx_instance_init): remember
	selection-changed signal handler id.
	(balsa_index_select_all): select all messages without previewing
	any.
	* src/balsa-index.h: new member and method.
	* src/main-window.c: use balsa_index_select_all.

2008-02-27  Peter Bloomfield

	* libbalsa/mailbox.c: (libbalsa_mailbox_set_view_filter):
	remember if the view needs to be updated.
	* libbalsa/mailbox.h: new member.

2008-02-27  Peter Bloomfield

	* libbalsa/mailbox.c: (libbalsa_mailbox_changed): allow for
	default count (== -1).
	* libbalsa/mailbox_imap.c: (lbm_imap_check): get UNREAD count
	instead of RECENT.
	* src/balsa-mblist.c: (bmbl_sort_idle,
	balsa_mblist_mailbox_node_append): inhibit sorting while
	building the tree, to avoid quadratic cost; prepend to tree
	instead of appending, for the same reason.
	* src/balsa-mblist.h: new members for sorting.
	* src/mailbox-node.c: (add_local_mailbox): respect
	subscribe-for-new-mail setting.
	* src/sendmsg-window.c: (update_bsmsg_identity): hide reply-to
	widget if we showed it temporarily.

2008-02-24  Peter Bloomfield

	* src/balsa-index.c: (bndx_popup_position_func, bndx_do_popup):
	add a popup-position func.

2008-02-24  Peter Bloomfield

	* libbalsa/imap/imap-handle.c: (ir_fetch_seq): compile with
	gcc-4.3.
	* src/main.c: (balsa_handle_automation_options): ditto.

2008-02-22  Peter Bloomfield

	* src/filter-edit-callbacks.c: (fe_typesmenu_cb,
	condition_validate, clear_condition_widgets,
	fill_condition_widgets, build_type_notebook): do not offer regex
	filter.
	* src/save-restore.c: (view_by_url_prefix, save_view,
	config_view_remove): new public function to remove a
	mailbox-view.
	* src/save-restore.h: ditto.
	* src/mailbox-conf.c: (mailbox_conf_delete): remove filters and
	the view.

2008-02-18  Peter Bloomfield

	* libbalsa/filter-funcs.c: (libbalsa_condition_compare): check
	for equality.

2008-02-18  Peter Bloomfield

	* src/balsa-message.c: (bm_find_entry_changed_cb,
	bm_find_again): use GtkSourceIter's case-insensitive search
	capability, if available.

2008-02-17  Peter Bloomfield

	* libbalsa/filter-funcs.c: (libbalsa_condition_compare): allow
	NULL conditions.
	* libbalsa/mailbox.c: (libbalsa_mailbox_set_view_filter): update
	only if the new filter is a real change.

2008-02-17  Peter Bloomfield

	* src/message-window.c: (mw_find_in_message_cb): add UI for
	find-in-message.

2008-02-14  Peter Bloomfield

	* src/main-window.c: fix a comment.

2008-02-14  Peter Bloomfield

	* src/main-window.c: block the correct signal handler.

2008-02-10  Albrecht Dreß

	* libbalsa/rfc3156.[hc]: libbalsa_can_encrypt_for_all().
	* libbalsa/identity.[ch]: remind if encryption is possible.
	* src/sendmsg-window.c: encourage encryption if possible.
	* configure.in: stop if gpgme-enabled build requested but
	gpgme-config not found (PS).

2008-02-09  Peter Bloomfield

	* src/balsa-message.c: (bm_find_scroll_to_iter): scroll least
	amount to get text on screen.

2008-02-09  Peter Bloomfield

	* src/balsa-mblist.c: (bmbl_select_mailbox): check that
	button-press event was on the correct window.

2008-02-08  Peter Bloomfield

	* src/balsa-message.c: (bm_find_again): clean up.

2008-02-08  Peter Bloomfield

	* src/balsa-message.c: (bm_find_set_status): new function, hides
	the separator using gtk_separator_tool_item_set_draw instead of
	gtk_widget_hide;
	(bm_find_entry_changed_cb, bm_find_again,
	balsa_message_find_in_message): use bm_find_set_status;
	(bm_disable_find_entry): boolean => void.

2008-02-08  Peter Bloomfield

	* libbalsa/libbalsa.c: (libbalsa_threads_leave): restore
	warning.
	* src/balsa-message.c: (bm_find_entry_changed_cb, bm_find_again,
	bm_pass_to_find_entry): do not hide separator, that triggers
	warnings;
	(balsa_message_find_in_message): find again only if found.

2008-02-08  Peter Bloomfield

	* src/balsa-message.c: (bm_find_entry_changed_cb,
	bm_find_again): do not mess with thread lock.

2008-02-08  Peter Bloomfield

	* src/balsa-message.c: (bm_pass_to_find_entry): test only SHIFT
	and CONTROL bits.

2008-02-07  Peter Bloomfield

	* libbalsa/libbalsa.c: (libbalsa_threads_leave): disable
	warning about dropping lock when not holding it--GtkTextView
	seems to trigger it.
	* src/balsa-message.c: (bm_scroll_to_iter,
	bm_find_entry_changed_cb, bm_find_again, bm_find_prev_cb,
	bm_find_next_cb, bm_find_bar_new, bm_pass_to_find_entry,
	bm_disable_find_entry, balsa_message_init, balsa_message_set,
	balsa_message_find_in_message): implement find-in-message.
	* src/balsa-message.h: api for find-in-message.
	* src/main-window.c: use it.

2008-01-09  Peter Bloomfield

	* libbalsa/libbalsa.h: add width and height to api for
	libbalsa_show_message_source.
	* libbalsa/source-viewer.c: (lsv_size_allocate_cb): save width
	and height.
	(libbalsa_show_message_source): add width and height to api;
	change horizontal scroll policy to GTK_POLICY_AUTOMATIC.
	* src/balsa-app.h: add source viewer width and height.
	* src/balsa-index.c: (bndx_view_source): use new api.
	* src/main-window.c: ditto.
	* src/message-window.c: (view_msg_source_cb): ditto.
	* src/save-restore.c: (config_global_load, config_save): load
	and save source viewer width and height.

2008-01-02  Peter Bloomfield

	* src/spell-check.c: (balsa_spell_check_start): compile without
	GtkSpell.

2008-01-01  Peter Bloomfield

	* configure.in: if glib is 2.14+, we use GRegex, so do not
	configure PCRE.
	* libbalsa/filter-funcs.c: (libbalsa_condition_regex_free): use
	GRegex if available.
	* libbalsa/filter-private.h: ditto.
	* libbalsa/filter.c: ditto.
	* libbalsa/mime.c: (mark_urls, get_url_helper, get_url_reg,
	get_ml_url_reg, get_ml_flowed_url_reg): ditto.
	* libbalsa/misc.h: ditto.
	* src/balsa-app.c: (balsa_quote_regex_new): new function--if
	GRegex is available, compile the quote regex once, and return
	a ref.
	* src/balsa-app.h: balsa_quote_regex_new is new.
	* src/balsa-message.c: use balsa_quote_regex_new.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	ditto.
	* src/balsa-print-object-text.c:
	(balsa_print_object_text_plain): ditto.
	* src/print.c: (print_wrap_body): ditto.
	* src/quote-color.c: (is_a_quote): use GRegex if available.
	* src/quote-color.h: ditto.
	* src/sendmsg-window.c: (reflow_selected_cb): use
	balsa_quote_regex_new.
	* src/spell-check.c: (balsa_spell_check_start): use
	balsa_quote_regex_new.
	(balsa_spell_check_destroy, next_word): use GRegex if available.

2008-01-01  Peter Bloomfield

	* configure.in: configuring GtkSourceView when version is not
	specified, try GtkSourceView2 then GtkSourceView1.

2008-01-01  Albrecht Dreß

	* Makefile.am: support GtkSourceView2.
	* configure.in: ditto.
	* libbalsa/libbalsa.c: (libbalsa_source_view_new): ditto.
	* src/balsa-mime-widget-text.c: (create_text_widget): ditto.
	* src/sendmsg-window.c: (sw_can_redo_cb, sw_can_undo_cb,
	create_text_area): ditto.
	* balsa-mail-style.xml: new file for GtkSourceView2.
	* balsa-mail.lang: ditto.

2007-12-31  Peter Bloomfield

	* src/mailbox-node.c: (mark_local_path): change from void to
	gboolean, with FALSE indicating that node->scanned is already
	set.
	* libbalsa/folder-scanners.c: (libbalsa_scanner_mdir,
	libbalsa_scanner_local_dir_helper): use return value.
	* libbalsa/folder-scanners.h: new definition of LocalMark.

2007-12-30  Pawel Salek

	* libbalsa/mailbox.h: add ability to add multiple messages at
	once: replace add_message with add_messages.

	* libbalsa/mailbox.c: libbalsa_mailbox_add_message uses
	add_messages handler now.
	
	* libbalsa/mailbox_{mh,maildir,mbox}.c: simple implementations.
	* libbalsa/mailbox_imap.c: MULTIAPPEND-aware add_messages.
	* libbalsa/imap/imap_tst.c: add anonymous authentication support.
	* libbalsa/imap/imap-commands.c: add handle locking around 
	imap_mbox_append_multi() and transaction size limits.

2007-12-27  Pawel Salek

	* libbalsa/mailbox_imap.c: buflen is of size_t type.
	* libbalsa/imap/imap-handle.[hc]: register MULTIAPPEND extension
	* libbalsa/imap/imap-commands.[hc]: add MULTIAPPEND aware interface.
	* libbalsa/imap/imap_tst.c: test it.

2007-12-25  Pawel Salek

	* NEWS, configure.in: release balsa-2.3.22.

2007-12-24  Peter Bloomfield

	* libbalsa/address-view.c: (lbav_selection_changed_cb): compile
	with gtk pre-2.12.

2007-12-23  Peter Bloomfield

	* libbalsa/address-view.c: (lbav_selection_changed_cb,
	libbalsa_address_view_new): connect to selection's changed
	signal, to implement one-click close.
	* libbalsa/address-view.h: add members needed for one-click
	actions; remove deadwood.

2007-12-23  Albrecht Dreß

	* src/main-window.c: show tray icon on mail arrival.

2007-12-22  Peter Bloomfield

	* src/sendmsg-window.c: (create_lang_menu): build without
	GtkSpell.

2007-12-21  Peter Bloomfield

	* src/sendmsg-window.c: (set_locale): restart spell checker when
	language is changed.

2007-12-21  Pawel Salek

	* src/main-window.c: remove duplicate shortcut.
	* src/sendmsg-window.c: Fix language switching (Peter B).
	* libbalsa/imap/imap-commands.c: Add a handle lock.

2007-12-18  Peter Bloomfield

	* libbalsa/filter.c: (libbalsa_condition_matches): new
	content2reply api.
	* libbalsa/mailbox_local.c: (message_match_real): ditto.
	* libbalsa/mime.c: (process_mime_part, process_mime_multipart,
	content2reply): remove charset callback.
	* libbalsa/mime.h: ditto.
	* src/balsa-app.c: (balsa_app_init): new member
	BalsaApp::spell_check_active; make spell modules conditional.
	* src/balsa-app.h:
	* src/save-restore.c: (config_global_load, config_save): manage
	BalsaApp::spell_check_active.
	* src/sendmsg-window.c: simplify charset and spell-checker
	handling.
	* src/sendmsg-window.h: remove newly redundant members in
	BalsaSendmsg.

2007-12-16  Pawel Salek

	* src/balsa-index.c: check in idle functions whether the model
	still exists.
	* src/sendmsg-window.c: do not go beyond the end of the string.

2007-12-16  Peter Bloomfield

	* src/main-window.c: (bw_notebook_label_new): use
	gtk_widget_set_size_request for the button instead of a signal
	callback.

2007-12-14  Peter Bloomfield

	* src/main-window.c: (bw_notebook_label_new): drop redundant
	event box.
	* libbalsa/imap/imap-handle.c: (imap_get_address): unfold
	address string.
	* libbalsa/mailbox_imap.c: (get_struct_from_cache): crlf-filter
	the message.

2007-12-13  Peter Bloomfield

	* libbalsa/mailbox_imap.c:
	(internet_address_new_from_imap_address,
	internet_address_new_list_from_imap_address_list): handle RFC
	2822 groups.

2007-12-13  Albrecht Dreß

	* libbalsa/imap/imap-handle.c: (imap_envelope_from_stringi):
	compile fix.

2007-12-13  Peter Bloomfield

	* images/16x16/balsa-drop-down.png: new icon, used to signify that
	the list of recipient types in address-view is a drop-down list.
	* libbalsa/address-view.c: (libbalsa_address_view_finalize,
	lbav_ensure_blank_line, lbav_add_from_list,
	lbav_button_activated_cb, libbalsa_address_view_new,
	libbalsa_address_view_set_book_icon,
	libbalsa_address_view_set_close_icon,
	libbalsa_address_view_set_drop_down_icon): use pixbuf instead of
	stock-id; use the new icon.
	* libbalsa/address-view.h: change to pixbuf instead of stock-id.
	* libbalsa/cell-renderer-button.c: fix documentation.
	* src/balsa-icons.c: (register_balsa_pixmaps,
	register_balsa_pixbufs): define and register new icon.
	* src/balsa-icons.h: ditto.
	* src/sendmsg-window.c: (create_email_entry): new api for
	address-view.

2007-12-11  Peter Bloomfield

	* src/sendmsg-window.c: (sendmsg_window_compose,
	sw_grab_focus_to_text, sendmsg_window_reply,
	sendmsg_window_reply_embedded, sendmsg_window_forward,
	sendmsg_window_continue): grab focus to the message body when
	replying.

2007-12-11  Jens Granseuer

	* libbalsa/identity.c: (add_show_menu, ident_dialog_free_values,
	ident_dialog_get_value): build without ESMTP and GPG/SMIME.

2007-12-10  Peter Bloomfield

	merge balsa-address-view branch
	* libbalsa/Makefile.am:
	* libbalsa/address-entry.c:
	* libbalsa/address-entry.h:
	* src/ab-window.c:
	* src/main.c:
	* src/save-restore.c:
	* src/sendmsg-window.c:
	* src/sendmsg-window.h:

2007-12-08  Peter Bloomfield

	* libbalsa/libbalsa.c: add pointer
	libbalsa_progress_set_activity so that libbalsa functions can
	show activity in the progress bar (currently unused, but it's
	there when we need it!).
	* libbalsa/libbalsa.h: ditto; use separate constants for minimum
	fraction and minimum elapsed time when updating progress bar
	(Albrecht Dreß).
	* libbalsa/mailbox.c: (libbalsa_mailbox_msgno_find,
	lbm_set_threading): check that msg_tree exists.
	* src/balsa-index.c: (balsa_index_ensure_visible): check that
	tree_view is realized.
	* src/balsa-mblist.c: (bmbl_mailbox_changed_cb): no need to grab
	GDK lock.
	* src/main-window.c: make sure that increment mode takes
	precedence over activity mode; use new members in BalsaWindow
	to avoid using g_object_{set,get}_data.
	* src/main-window.h: add members to BalsaWindow to avoid using
	g_object_{set,get}_data; export
	balsa_window_{increase,decrease}_activity.
	* src/main.c: (balsa_progress_set_text,
	balsa_progress_set_fraction, balsa_progress_set_activity, main):
	use separate constants for minimum fraction and minimum elapsed
	time when updating progress bar (Albrecht Dreß); initialize
	libbalsa_progress_set_activity.

2007-12-08  Pawel Salek

	* balsa.desktop.in: fix bug 414361 in bugzilla.redhat.com.
	* NEWS, configure.in: release 2.3.21.

2007-12-08  Pawel Salek

	* src/{main,sendmsg}-window.c...: format string bug fixes
	(bug 488432, Evil Ninja Squirrel).

2007-12-05  Peter Bloomfield

	* libbalsa/mailbox.c: (libbalsa_mailbox_changed): hold gdk lock
	while emitting "changed" signal;
	(libbalsa_mailbox_msgno_changed, libbalsa_mailbox_msgno_filt_in,
	libbalsa_mailbox_msgno_removed,
	libbalsa_mailbox_msgno_filt_out): eliminate obsolete
	lbm_threads_{enter,leave}.

2007-11-27  Peter Bloomfield

	Thanks to Nuno Monteiro
	<http://mail.gnome.org/archives/balsa-list/2007-November/msg00016.html>
	* src/sendmsg-window.c: (toolbar_send_message_cb): new action
	for toolbar send/queue button.
	* src/toolbar-factory.c: correct toolbar button labels.

2007-11-26  Albrecht Dreß

	* libbalsa/address-view.c: (lbav_focus_out_cb,
	lbav_row_editing_cb): on focus-out, accept a unique match.

2007-11-17  Peter Bloomfield

	* src/save-restore.c:
	* src/balsa-app.c:
	* src/balsa-app.h: add fields to save/restore maximized state of
	windows.
	* src/main-window.c:
	* src/message-window.c:
	* src/sendmsg-window.c: use them.

2007-11-16  Peter Bloomfield

	* libbalsa/address-view.c: (lbav_clean_text): new helper to
	remove control characters from text.
	(lbav_add_from_list, lbav_set_text_at_path): use it.

2007-11-13  Peter Bloomfield

	Bug #496316: Send/Queue button has inconsistent labeling.
	* src/toolbar-factory.h: new function balsa_toolbar_button_text.
	* src/toolbar-factory.c: (balsa_toolbar_button_text,
	tm_has_second_line, tm_set_tool_item_label): implement and use it.
	* src/toolbar-prefs.c: (tp_store_set): use it.

2007-11-10  Peter Bloomfield

	* src/balsa-message.c: (balsa_get_parent_window): use
	gtk_widget_get_toplevel.

2007-11-07  Peter Bloomfield

	* src/balsa-app.c:
	* src/balsa-app.h:
	* src/main-window.c:
	* src/message-window.c:
	* src/save-restore.c:
	* src/sendmsg-window.c: revert previous unintentional commit of
	changes in src/.

2007-11-07  Peter Bloomfield

	* libbalsa/address-view.c: (lbav_set_text_at_path),
	(lbav_combo_edited_cb), (lbav_row_editing_cb),
	(lbav_button_activated_cb), (libbalsa_address_view_add_to_row):
	check validity of iter.

2007-11-03  Peter Bloomfield

	* libbalsa/address-view.c:
	* libbalsa/address-view.h: do not copy strings.
	* src/sendmsg-window.c: mark strings for translation.

2007-11-03  Peter Bloomfield

	* libbalsa/address-view.c:
	* src/sendmsg-window.c: simplify LibBalsaAddressView api.
	* src/main.c: (main): libbalsa_address_book_list has gone away.

2007-11-03  Peter Bloomfield

	* libbalsa/address-view.c: (libbalsa_address_view_finalize):
	do not leak GtkTreeRowReference;
	(lbav_append_addresses), (lbav_ensure_blank_line_idle_cb),
	(lbav_ensure_blank_line), (lbav_row_editing_cb),
	(libbalsa_address_view_new): remove debugging output.


2007-10-31  Peter Bloomfield

	* src/main-window.c: connect to "activate" signal instead of
	"changed", to see every click on threading options.

2007-10-30  Peter Bloomfield

	* libbalsa/address-view.c:
	* libbalsa/address-view.h:
	* src/save-restore.c:
	* src/sendmsg-window.c:
	* src/sendmsg-window.h: use a separate widget for Reply-To.

2007-10-27  Peter Bloomfield

	* libbalsa/address-view.c: localize address types; check address
	types.

2007-10-26  Peter Bloomfield

	* libbalsa/address-view.c: (lbav_sort_func): make sort-func
	reflexive;
	(libbalsa_address_view_new): more debug info.

2007-10-26  Peter Bloomfield 

	* libbalsa/address-view.c: make blank line sort below addresses
	of the same type; try to have only one blank line.

2007-10-25  Peter Bloomfield

	* libbalsa/cell-renderer-button.c:
	* libbalsa/cell-renderer-button.h: forgot to add these for
	initial commit.

2007-10-25  Peter Bloomfield

	* libbalsa/Makefile.am:
	* libbalsa/address-entry.c:
	* libbalsa/address-entry.h:
	* libbalsa/address-view.c:
	* libbalsa/address-view.h:
	* src/ab-window.c:
	* src/main.c:
	* src/save-restore.c:
	* src/sendmsg-window.c:
	* src/sendmsg-window.h: initial commit on address-view branch.

2007-10-24  Albrecht Dreß

	* src/balsa-icons.c:
	* src/balsa-message.c:
	* src/balsa-print-object-text.c: More balsa Tangofication.

2007-10-23  Albrecht Dreß

	* configure.in:
	* libbalsa/Makefile.am:
	* libbalsa/address-book-rubrica.c:
	* libbalsa/address-book-rubrica.h:
	* libbalsa/libbalsa.c:
	* libbalsa/libbalsa.h:
	* src/ab-main.c:
	* src/ab-window.c:
	* src/address-book-config.c:
	* src/main.c:
	* src/pref-manager.c: add support for Rubrica address book.

2007-10-17  Peter Bloomfield

	* libbalsa/mailbox_maildir.c: skip check only if mtime matches
	exactly.
	* src/balsa-index.c: revert to scrolling in an idle callback,
	but now at low priority.

2007-10-15  Peter Bloomfield

	* libbalsa/mailbox_local.c: clarify simple and flat threading.

2007-10-14  Peter Bloomfield

	* libbalsa/mailbox.c: (lbm_get_view): do not assert url is not
	in hash table;
	(lbm_sort): set msg-tree-changed;
	(libbalsa_mailbox_unlink_and_prepend): set msg-tree-changed only
	if we are sure it was.
	* libbalsa/mailbox_local.c: (lbm_local_update_view_filter): set
	msg-tree-changed only if it is a flags-only filter; fix bug
	saving and restoring simple threading.
	* src/main-window.c: avoid critical warning if Balsa is closed
	during a threading.

2007-10-10  Peter Bloomfield

	* libbalsa/Makefile.am:
	* libbalsa/address-book-extern.c:
	* libbalsa/address-book-ldap.c:
	* libbalsa/address-book-ldif.c:
	* libbalsa/address-book-text.c:
	* libbalsa/address-book-vcard.c:
	* libbalsa/address-book.c:
	* libbalsa/address.c:
	* libbalsa/body.c:
	* libbalsa/files.c:
	* libbalsa/filter-error.c:
	* libbalsa/filter-file.c:
	* libbalsa/filter.c:
	* libbalsa/gmime-application-pkcs7.c:
	* libbalsa/gmime-gpgme-context.c:
	* libbalsa/i18n.h:
	* libbalsa/identity.c:
	* libbalsa/imap-server.c:
	* libbalsa/libbalsa-conf.c:
	* libbalsa/libbalsa.c:
	* libbalsa/mailbox-filter.c:
	* libbalsa/mailbox.c:
	* libbalsa/mailbox_imap.c:
	* libbalsa/mailbox_local.c:
	* libbalsa/mailbox_maildir.c:
	* libbalsa/mailbox_mbox.c:
	* libbalsa/mailbox_mh.c:
	* libbalsa/mailbox_pop3.c:
	* libbalsa/message.c:
	* libbalsa/mime.c:
	* libbalsa/misc.c:
	* libbalsa/rfc3156.c:
	* libbalsa/send.c:
	* libbalsa/server.c:
	* libbalsa/smtp-server.c:
	* libbalsa/source-viewer.c:
	* libinit_balsa/assistant_helper.c:
	* libinit_balsa/assistant_init.c:
	* libinit_balsa/assistant_page_defclient.c:
	* libinit_balsa/assistant_page_directory.c:
	* libinit_balsa/assistant_page_finish.c:
	* libinit_balsa/assistant_page_user.c:
	* libinit_balsa/assistant_page_welcome.c:
	* libinit_balsa/balsa-druid-page-defclient.c:
	* libinit_balsa/balsa-druid-page-directory.c:
	* libinit_balsa/balsa-druid-page-finish.c:
	* libinit_balsa/balsa-druid-page-user.c:
	* libinit_balsa/balsa-druid-page-welcome.c:
	* libinit_balsa/balsa-initdruid.c:
	* libinit_balsa/helper.c:
	* libinit_balsa/init_balsa.c:
	* src/ab-main.c:
	* src/ab-window.c:
	* src/address-book-config.c:
	* src/balsa-app.c:
	* src/balsa-index.c:
	* src/balsa-mblist.c:
	* src/balsa-message.c:
	* src/balsa-mime-widget-callbacks.c:
	* src/balsa-mime-widget-crypto.c:
	* src/balsa-mime-widget-image.c:
	* src/balsa-mime-widget-message.c:
	* src/balsa-mime-widget-multipart.c:
	* src/balsa-mime-widget-text.c:
	* src/balsa-mime-widget.c:
	* src/balsa-print-object-default.c:
	* src/balsa-print-object-header.c:
	* src/balsa-print-object-text.c:
	* src/filter-edit-callbacks.c:
	* src/filter-edit-dialog.c:
	* src/filter-export-callbacks.c:
	* src/filter-export-dialog.c:
	* src/filter-run-callbacks.c:
	* src/filter-run-dialog.c:
	* src/folder-conf.c:
	* src/information-dialog.c:
	* src/mailbox-conf.c:
	* src/mailbox-node.c:
	* src/main-window.c:
	* src/main.c:
	* src/message-window.c:
	* src/pref-manager.c:
	* src/print-gtk.c:
	* src/print.c:
	* src/save-restore.c:
	* src/sendmsg-window.c:
	* src/spell-check.c:
	* src/store-address.c:
	* src/toolbar-factory.c:
	* src/toolbar-prefs.c: include <glib/gi18n.h> instead of
	"libbalsa/i18n.h".

2007-10-10  Peter Bloomfield

	* libbalsa/server.h: include libbalsa.h (bug 477580, Jens
	Granseuer).

2007-10-10  Peter Bloomfield

	* src/main-window.c: hide resize grip when window is maximized.
	* src/sendmsg-window.c: (calculate_expander_toggles): drop
	unused variable (Albrecht Dreß);
	(tree_find_single_part), (collect_for_quote): search deeper for
	a single text part (Albrecht Dreß).

2007-10-09  Peter Bloomfield

	* src/balsa-index.c: restore 'N' and 'P' actions.
	* src/main-window.c: use consistent "bw_" prefix on local
	functions to aid debugging.

2007-10-09  Peter Bloomfield

	* libbalsa/mailbox.c: (mbox_model_iter_n_children): return 0 if
	iter is NULL and mailbox has no msg_tree.
	* src/balsa-index.c: (bndx_scroll_to_row),
	(balsa_index_scroll_on_open): do not use idle callback;
	(balsa_index_ensure_visible): typo?

2007-10-09  Peter Bloomfield

	* src/balsa-index.c: (bndx_selection_changed_real),
	(bndx_mailbox_changed_func), (bndx_mailbox_changed_cb): when a
	message is deleted, select next message to be displayed in the
	signal handler instead of the idle callback.

2007-10-07  Peter Bloomfield

	* libbalsa/send.c: (msg_queue_item_new), (add_recipients),
	(lbs_list_has_one_address), (lbs_process_queue),
	(handle_successful_send): create separate bcc-message only if it
	has exactly one recipient; really leave message in outbox if any
	address, including bcc addresses, has an error.

2007-10-05  Peter Bloomfield

	* src/balsa-index.c: (bndx_selection_changed_real): do not show
	next message if msgno is no longer in the tree.

2007-10-04  Peter Bloomfield

	* src/main-window.c: restore enable_mailbox_menus() to
	index_changed_cb()--removed by mistake a few commits ago.

2007-10-03  Peter Bloomfield

	* src/main-window.c: use an enum instead of a string to
	distinguish toolbar types.
	* src/message-window.c: (mw_get_toolbar_model): ditto.
	* src/sendmsg-window.c: (sw_get_toolbar_model): ditto.
	* src/toolbar-factory.c: (tm_load_model), (tm_save_model),
	(balsa_toolbar_model_new), (tm_do_popup_menu): ditto.
	* src/toolbar-factory.h: ditto.
	* src/toolbar-prefs.c: (customize_dialog_cb): ditto.
	* src/toolbar-prefs.h: ditto.

2007-10-02  Pawel Salek

	* src/mailbox-node.c, libbalsa/{mailbox_imap,server}.c:
	remove debug output.
	* libbalsa/mailbox.c: compile against older glib.
	* src/sendmsg-window.c: fix bug 481842 (Stephane Raimbault).

2007-10-02  Peter Bloomfield

	* src/toolbar-factory.c: (tm_do_popup_menu): show the
	appropriate page of the toolbar editor.
	* src/toolbar-prefs.c: (customize_dialog_cb): ditto.
	* src/toolbar-prefs.h: ditto.

2007-10-01  Peter Bloomfield

	* libbalsa/message.c: (libbalsa_message_header_get_helper),
	(lb_message_set_headers_from_string): match headers exactly.
	* src/balsa-message.c: (balsa_message_set_displayed_headers):
	check whether this is an actual change.
	* src/main-window.c: connect to "activate" signal instead of
	"changed", to see every click.
	* src/message-window.c: (mw_get_ui_manager), (message_window_new),
	(mw_header_activate_cb), (reset_show_all_headers): ditto.

2007-09-30  Peter Bloomfield

	* src/main-window.c: clean up.

2007-09-30  Peter Bloomfield

	* src/main-window.c: block only some actions.
	* src/message-window.c: (mw_set_active), (message_window_new),
	(reset_show_all_headers): ditto.
	* src/sendmsg-window.c: block no actions--just document it.

2007-09-30  Peter Bloomfield

	* libbalsa/mailbox.c: (lbm_get_index_entry): check for NULL
	message returned by libbalsa_mailbox_get_message().
	* libbalsa/mailbox_local.c: (message_match_real): ditto.
	* libbalsa/send.c: (lbs_process_queue),
	(libbalsa_process_queue): ditto.
	* src/balsa-index.c: (bndx_view_source),
	(balsa_index_selected_list_func): ditto.
	* src/balsa-message.c: (balsa_message_set): ditto.
	* src/main-window.c: ditto.
	* src/message-window.c: (mw_set_selected): ditto;
	(shown_hdrs_radio_cb): fix typo.
	* src/sendmsg-window.c: (attachments_add), (drag_data_quote),
	(sendmsg_window_new_from_list): ditto.

2007-09-29  Peter Bloomfield

	* src/main-window.c: block actions while we set active.

2007-09-29  Peter Bloomfield

	* src/balsa-index.c: (balsa_index_load_mailbox_node): set
	threading in main-window instead of balsa-index.
	* src/main-window.c: ditto.

2007-09-29  Peter Bloomfield

	* src/balsa-index.c: (balsa_index_load_mailbox_node):
	balsa_window_get_view_filter is no longer exported;
	(bndx_do_popup): BalsaIndex::window no longer exists.
	* src/balsa-index.h: remove BalsaIndex::window.
	* src/main-window.c: do not export balsa_window_get_view_filter.
	* src/main-window.h: ditto.

2007-09-27  Peter Bloomfield

	* src/main-window.c: do not export enable_mailbox_menus.
	* src/main-window.h: ditto.
	* src/balsa-index.c: (balsa_index_load_mailbox_node):
	enable_mailbox_menus is no longer exported.

2007-09-27  Peter Bloomfield

	* doc/C/balsa.xml: fix identity-dialog and toolbar-editor 
	documentation.
	* libbalsa/identity.c: (append_ident_notebook_page),
	(setup_ident_frame), (display_frame_set_gpg_mode): show Security
	page even when GnuPG isn't supported, but grayed out and with an
	explanatory label.
	* libbalsa/libbalsa.h: update progress bar after a set time, not
	a set fraction of the work.
	* src/main.c: (balsa_progress_set_text),
	(balsa_progress_set_fraction): ditto.

2007-09-25  Peter Bloomfield

	* src/toolbar-factory.c: (menu_item_toggled_cb),
	(tm_popup_idle_cb), (tm_popup_deactivated_cb),
	(tm_remove_underscore), (tm_popup_position_func),
	(tm_do_popup_menu), (tm_button_press_cb), (tm_popup_menu_cb),
	(balsa_toolbar_new): add a popup-position func; clean up.

2007-09-25  Peter Bloomfield

	* src/toolbar-factory.c: (tm_load_model), (tm_save_model),
	(tm_gconf_notify), (balsa_toolbar_model_new), (tm_default_style),
	(tm_set_style), (tm_changed_cb), (do_popup_menu),
	(balsa_toolbar_new): catch changes in desktop toolbar style.

2007-09-24  Peter Bloomfield

	* src/toolbar-factory.c: (tm_default_toolbar_style),
	(tm_load_model), (tm_save_model), (do_popup_menu),
	(tm_popup_menu_cb), (balsa_toolbar_new): use desktop toolbar
	style as default.

2007-09-24  Peter Bloomfield

	* src/toolbar-factory.c: (remove_underscore), (do_popup_menu):
	respect desktop toolbar style.

2007-09-24  Peter Bloomfield

	* libbalsa/mailbox_mbox.c:
	(libbalsa_mailbox_mbox_close_mailbox): keep stream open longer.
	* src/toolbar-prefs.c: (style_button_cb): emit signal correctly.

2007-09-23  Peter Bloomfield

	* src/toolbar-factory.c: (tm_save_model): remove old toolbar
	config before saving new one.

2007-09-23  Peter Bloomfield

	* libbalsa/identity.c: use GTK_RESPONSE_HELP, so that the "Help"
	button is created correctly.

2007-09-23  Peter Bloomfield

	* src/main-window.c: add tooltip for "Quit".
	* src/toolbar-factory.c: (do_popup_menu): allow "Quit" to be a
	toolbar button; use gtk_menu_attach_to_widget only if it allows
	a NULL detacher; add "Customize Toolbars..." item.

2007-09-22  Peter Bloomfield

	* src/main-window.c: make a stack of "opening mailbox..."
	messages; new toolbar api.
	* src/message-window.c: (mw_get_toolbar_model): new toolbar api.
	* src/save-restore.c: (save_toolbars), (load_toolbars): move
	toolbar save and load to toolbar-factory.c.
	* src/sendmsg-window.c: (sw_get_toolbar_model): new toolbar api.
	* src/toolbar-factory.c: create a popup menu for toolbar.
	* src/toolbar-factory.h: new toolbar api.
	* src/toolbar-prefs.c: (style_button_cb), (create_toolbar_page):
	add a button to popup toolbar style menu.

2007-09-21  Peter Bloomfield

	* src/ab-main.c: (bab_window_new): migrate from GnomeApp.
	* src/balsa-app.h: ditto.
	* src/balsa-index.c: (balsa_index_load_mailbox_node): handle
	status messages in main-window.
	* src/balsa-mblist.c: (balsa_mblist_set_status_bar): migrate
	from GnomeApp.
	* src/balsa-mime-widget-text.c: (statusbar_pop), (handle_url),
	(balsa_gtk_html_on_url): ditto.
	* src/information-dialog.c: (balsa_information_list),
	(status_bar_refresh), (balsa_information_bar): ditto.
	* src/mailbox-node.c: (imap_dir_cb): ditto.
	* src/main-window.c: ditto.
	* src/main-window.h: ditto.
	* src/main.c: (threads_init): pass balsa_app.main_window as
	user data.
	* src/message-window.c: (message_window_new): migrate from
	GnomeApp.
	* src/pref-manager.c: (open_preferences_manager), (set_prefs):
	ditto.
	* src/sendmsg-window.c: (sendmsg_window_new): ditto.
	* src/toolbar-prefs.c: (customize_dialog_cb): ditto.

2007-09-18  Peter Bloomfield

	* src/balsa-index.c: (bndx_view_source), (bndx_store_address),
	(bi_toggle_deleted_cb), (bi_toggle_flagged_cb), (bi_toggle_new_cb),
	(bndx_popup_menu_create), (create_stock_menu_item): connect
	signals swapped, to match new handler api.

2007-09-18  Peter Bloomfield

	* libbalsa/mailbox.c: scrap libbalsa_mailbox_register_msgno.
	* libbalsa/mailbox.h: ditto.
	* src/balsa-index.c: (bndx_mailbox_message_expunged_cb),
	(balsa_index_load_mailbox_node): change
	BalsaIndex::{current,next}_msgno if necessary when a message
	is expunged.

2007-09-16  Peter Bloomfield

	* src/sendmsg-window.c: allow the letter 'q' in messages, by
	restoring ctrl+Q accelerator for "Queue" (thank you, Jean-Luc);
	restore Sign and Encrypt toolbar buttons (thank you, Albrecht).

2007-09-15  Peter Bloomfield

	* libbalsa/source-viewer.c: mark more strings for translation.
	* src/ab-main.c: ditto.
	* src/toolbar-factory.c: (tm_add_action),
	(balsa_toolbar_model_add_actions),
	(balsa_toolbar_model_add_toggle_actions), (tm_populate):
	tooltips are set by the ui-manager.

2007-09-15  Peter Bloomfield

	* libbalsa/source-viewer.c: (lbsv_app_set_menus): set
	translation domain to NULL to enable translation.
	* src/ab-main.c: (get_main_menu): ditto
	* src/main-window.c: ditto.
	* src/message-window.c: (mw_get_ui_manager): ditto.
	* src/sendmsg-window.c: (sw_get_ui_manager): ditto.

2007-09-15  Peter Bloomfield

	* src/main-window.c: two more missed translations.

2007-09-15  Peter Bloomfield

	* src/main-window.c: translate main menu.
	* src/message-window.c: ditto.
	* src/sendmsg-window.c: ditto.

2007-09-15  Peter Bloomfield

	* src/main-window.c:
	* src/main-window.h:
	* src/message-window.c: (message_window_new):  build
	  --without-gtkhtml.
	* src/sendmsg-window.c: (sendmsg_window_new):
	* src/toolbar-factory.c: (tm_changed_cb), (tm_toolbar_weak_notify),
	(balsa_toolbar_new):
	* src/toolbar-prefs.c: (customize_dialog_cb): clean up ui-manager
	  object-ref management.

2007-09-14  Peter Bloomfield

	* src/main-window.c:
	* src/message-window.c:
	* src/sendmsg-window.c:
	* src/toolbar-factory.c:
	* src/toolbar-factory.h:
	* src/toolbar-prefs.c: move toolbar-model's "changed" signal
	handling to toolbar-factory.c.

2007-09-14  Peter Bloomfield

	* doc/C/balsa.xml: toolbar editing is now really instant-apply.
	* libbalsa/rfc3156.c: build (--without-ssl ?).
	* src/ab-window.c:
	* src/balsa-app.c:
	* src/balsa-bonobo.c:
	* src/balsa-index.c:
	* src/balsa-index.h:
	* src/balsa-mime-widget-message.c:
	* src/balsa-mime-widget-text.c: drop GtkWidget from argument list.
	* src/main.c: GtkAccelMap is now in ~/.balsa/accelmap.
	* src/pref-manager.c: (apply_prefs): new toolbar api.
	* src/save-restore.c: (config_global_load): notify user about changes.
	* src/main-window.c:
	* src/main-window.h:
	* src/message-window.c:
	* src/message-window.h:
	* src/sendmsg-window.c:
	* src/sendmsg-window.h:
	* src/toolbar-factory.c:
	* src/toolbar-factory.h:
	* src/toolbar-prefs.c: migrate from GnomeUI to GtkUIManager.

2007-09-08  Albrecht Dreß

	* src/sendmsg-window.c: allow the user to select message parts to
	be quoted in the response.

2007-09-07  Pawel Salek

	* libbalsa/imap/imap-handle.c: fix buffer overflow (#474366,
	credit goes to Evil Ninja Squirrel).
	* NEWS, configure.in: release 2.3.20.

2007-09-06  Pawel Salek

	* libbalsa/mailbox_imap.c: handle expunge race.

2007-09-04  Peter Bloomfield

	* src/main-window.c: (balsa_window_enable_mailbox_menus),
	(balsa_window_update_book_menus), (enable_message_menus): manage
	sensitivity of store-address menu item in touch-pad version.

2007-09-03  Peter Bloomfield

	* libinit_balsa/assistant_helper.c:
	(balsa_init_add_table_entry): build with --enable-touch-ui.
	* libinit_balsa/assistant_helper.h: ditto.
	* src/main-window.c: (bw_enable_next_unread), (balsa_window_new),
	(enable_expand_collapse), (balsa_window_enable_mailbox_menus),
	(balsa_window_update_book_menus), (enable_message_menus),
	(balsa_window_set_threading_menu), (show_about_box),
	(show_all_headers_cb), (threading_change_cb), (zoom_cb): remove
	GtkAction code for now.
	* src/main-window.h: ditto.
	* src/sendmsg-window.c: (sendmsg_window_new): build with
	--enable-touch-ui.
	* src/spell-check.c: (balsa_spell_check_init): deprecation
	cleanup.

2007-08-31  Peter Bloomfield

	* src/main-window.c: (bw_enable_next_unread), (balsa_window_new),
	(enable_expand_collapse), (balsa_window_enable_mailbox_menus),
	(balsa_window_set_threading_menu), (contents_cb), (show_about_box),
	(shown_hdrs_radio_cb), (threading_radio_cb), (zoom_in_cb),
	(zoom_out_cb), (zoom_100_cb): incomplete port to GtkAction and
	friends (define USE_GNOMEUIINFO to TRUE in src/main-window.h to
	see how much work remains :()
	* src/main-window.h: ditto.

2007-08-27  Peter Bloomfield

	* libbalsa/send.c: (lbs_process_queue): skip message if it is
	either flagged or deleted--see
	http://mail.gnome.org/archives/balsa-list/2007-August/msg00018.html

2007-08-26  Albrecht Dreß

	* configure.in: s/mime is mature for gpg >= 2.0.4.
	* src/balsa-mblist.c: (bmbl_store_redraw_mbnode): newer icon
	sets distinguish between the "delete" (action) and the "trash
	can" (location) icons.

2007-08-25  Pawel Salek

	* libbalsa/imap/Makefile.am: disable building imap_tst.
	* src/balsa-message.[ch]: choose dialog's parent better.
	* NEWS, configure.in: release 2.3.19.

2007-08-23  Peter Bloomfield

	* src/toolbar-factory.c: gtk_tool_item_set_tooltip_text is since
	(2, 11, 6).

2007-08-23  Peter Bloomfield

	* src/balsa-app.c: (balsa_app_init): deprecation cleanup.
	* src/balsa-app.h: ditto.
	* src/balsa-index.c: (balsa_index_ensure_visible): ditto.
	* src/balsa-message.c: (bm_header_tl_buttons): ditto.
	* src/main-window.c: (balsa_notebook_label_new),
	(balsa_change_window_layout): ditto.
	* src/toolbar-factory.c: ditto.

2007-08-22  Pawel Salek

	* src/sendmsg-window.c: when (auto-)saving a message, do not
	bother the user asing questions about charsets.
	* src/balsa-mime-widget-callbacks.[hc]: parent properly "save part"
	dialog windows.
	* src/balsa-message.c: pass the parent.
	* libbalsa/libbalsa.c,libbalsa/{imap-,}server.c: timeout improvements.

2007-08-20  Pawel Salek

	* src/save-restore.c: show just one column for mailboxes by default.
	* src/balsa-app.c: squash a warning.
	* libinit_balsa/balsa-druid-page-directory.[ch]: finish the port
	to GtkAssistant.
	* libbalsa/imap/imap-commands.c: really add headers when BINARY
	extension is used.

2007-08-19  Pawel Salek

	* libinit_balsa/balsa-druid-page-{welcome,defclient,directory}.[hc]:
	* libinit_balsa/balsa-druid-page-{user,finish}.[hc]:
	* libinit_balsa/init_balsa.c: replace GnomeDruid with GtkAssistant.
	* libinit_balsa/{balsa-initdruid,helper}.{c,h}: ditto.

2007-08-10  Pawel Salek

	* libbalsa/mailbox_imap.c: encode cache file names more robustly.
	* libbalsa/imap/imap-search.c: disable UID ESEARCH for now since
	some interpretations make it useless.

2007-08-08  Pawel Salek

	* src/mailbox-conf.h: needs server.h
	* src/{save-restore,balsa-app}.c: ditto.
	* libinit_balsa/balsa-druid-page-{directory,user}.c: ditto.
	* libbalsa/send.c: do not disclose auth data. (PB)
	* libbalsa/imap-server.c: ditto.
	* libbalsa/{smtp-,}server.c: needs server.h
	* libbalsa/mailbox_imap.c: rework persistent caching.
	* libbalsa/libbalsa.c: disable IMAP timeouts for now - there is
	some deadlock condition.
	* libbalsa/mailbox_pop3.c: needs server.h
	* libbalsa/imap/imap-handle.c: serialize ImapBody, too.
	* libbalsa/imap/imap-commands.[ch]: imap_mbox_handle_fetch_rfc822()
	can fetch many messages at once now.
	
2007-08-06  Albrecht Dreß

	* libbalsa/mime.c: reflow improvements.
	* src/balsa-mime-widget-callbacks.c: programs require uris, not
	filenames.

2007-07-18  Albrecht Dreß

	* configure.in: safe gpg2 version detection.
	* src/main.c: ditto; initialize threads before using any glib
	functions (pb).

2007-07-15  Albrecht Dreß

	* src/balsa-print-object.c: (cairo_print_pixbuf): print icon
	colors correctly regardless of endianness.

2007-07-04  Pawel Salek

	* NEWS, configure.in: release 2.3.17.

2007-07-01  Pawel Salek

	* libbalsa/imap/pop3.c: validate APOP server stamp.
	* libbalsa/imap/imap-search.c: split long SEARCH commands into
	several ones.
	* libbalsa/mailbox_imap.c: return correct bool code on flag store.

2007-06-21  Peter Bloomfield

	* src/main-window.c: (display_new_mail_notification): respect
	balsa_app.notify_new_mail_dialog.
	* libbalsa/address.c: (vcard_qp_decode): build with GMime >=
	2.5.5

2007-06-19  Albrecht Dress

	* libbalsa/address.[hc]: make VCARD support more RFC-compatible.
	* src/balsa-mime-widget-text.c: improve displaying.
	* balsa-print-object-text.[hc]: add printing.
	
2007-06-17  Pawel Salek

	* libbalsa/imap/imap-handle.c: handle ESEARCH response.
	* libbalsa/imap/imap-handle.h: recognize ESEARCH extension.
	* libbalsa/imap/imap-commands.c: use it to optimize searches.
	* libbalsa/imap/imap-search.c: ditto.

2007-06-15  Pawel Salek

	Commit Peter's patches for broader testing...
	* libbalsa/imap/imap-handle.c: detect disconnection.
	* libbalsa/imap/imap-commands.c: check for header existence in client
	side sorting.

2007-06-10  Peter Bloomfield

	* src/balsa-index.c: (bndx_expand_to_row): avoid critical
	warnings from GtkTreeView.

2007-06-07  Pawel Salek

	* src/store-address.[ch]: add ability to create addresses from
	VCARD strings.
	* src/balsa-index.c: use new store_address() function names.
	* src/main-window.c: ditto.
	* src/balsa-mime-widget-text.c: add ability to store attached
	 e-mail addresses.
	* libbalsa/address-book-vcard.c: use common VCARD functions.
	* libbalsa/address.[ch]: move common VCARD functions here.

2007-06-05  Peter Bloomfield

	* libbalsa/mime.c: (unwrap_rfc2646): inline check for "-- \n".
	* libbalsa/mailbox.c: (lbm_try_reassemble): do not get message
	just to test flags.
	* libbalsa/send.c: (lbs_process_queue),
	(libbalsa_process_queue): ditto.
	* src/balsa-index.c: (bndx_mailbox_row_inserted_cb): ditto.

2007-06-05  Peter Bloomfield

	* libbalsa/mailbox.[ch]: new convenience methods
	libbalsa_mailbox_msgno_change_flags and
	libbalsa_mailbox_register_msgno.
	* libbalsa/message.[ch]: new convenience method
	libbalsa_message_change_flags.
	* libbalsa/send.c: use libbalsa_message_change_flags.
	* src/balsa-index.[ch]: replace BalsaIndex::current_message with
	BalsaIndex::current_msgno; new members
	BalsaIndex::has_selection_changed_idle and
	BalsaIndex::has_mailbox_changed_idle to avoid setting GObject
	data; new api balsa_index_selected_msgnos_{new,free}.
	* src/balsa-mblist.c: (bmbl_drag_cb): use new
	balsa_index_selected_msgnos_{new,free} api.
	* src/balsa-message.[ch]: use mailbox and msgno instead of
	message.
	* src/main-window.[ch]: ditto; use new
	balsa_index_selected_msgnos_{new,free} api.
	* src/message-window.[ch]: use mailbox and msgno instead of
	        message.
	* src/sendmsg-window.[ch]: ditto.

2007-06-03  Peter Bloomfield

	* libbalsa/mime.c: (unwrap_rfc2646): detect CRLF-terminated
	signature separator line.

2007-05-28  Peter Bloomfield

	* libbalsa/imap/pop3.c: (pop_get_uid): check for disconnection
	to avoid a failed assertion.

2007-05-27  Pawel Salek

	* src/sendmsg-window.c: Do not wrap for view, if flowed format is
	selected (Albrecht Dreß). 
	* src/balsa-index.c: extend msgno and size columns.
	* libbalsa/mailbox_imap.c: silence few devel warnings.
	* NEWS, configure.in: release 2.3.16.

2007-05-21  Peter Bloomfield

	* libbalsa/mailbox.c: (lbm_get_index_entry_expunged_cb),
	(lbm_get_index_entry): catch expunged and renumbered messages.
	* src/message-window.c: (message_window_move_message),
	(mw_set_selected): check BalsaIndex::current_msgno instead of
	BalsaIndex::current_message.

2007-05-11  Peter Bloomfield

	* libbalsa/html.c: (libbalsa_html_print),
	(libbalsa_html_print_get_pages_num): build on fc6, and on f7test
	--without-gtkprint.
	* libbalsa/html.h: ditto.

2007-05-10  Peter Bloomfield

	* libbalsa/mailbox_mh.c: (libbalsa_mailbox_mh_sync): rename
	message files correctly.
	* libbalsa/mailbox_local.c: (lbm_local_save_tree),
	(libbalsa_mailbox_local_close_mailbox): really check for empty
	tree; always save tree on closing.

2007-05-09  Albrecht Dreß

	* libbalsa/identity.h: add request_mdn field (request MDN by
	default).
	* libbalsa/identity.c: (libbalsa_identity_init),
	(setup_ident_frame), (ident_dialog_update), (display_frame_update),
	(libbalsa_identity_new_config), (libbalsa_identity_save): manage
	it.
	* src/sendmsg-window.c: (update_bsmsg_identity): use it.

2007-05-07  Peter Bloomfield

	* libbalsa/misc.c: (libbalsa_set_fallback_codeset): allocate the
	charset strings.
	* libbalsa/mailbox_local.c: (libbalsa_mailbox_local_get_message):
	check msgno.
	* src/balsa-index.c: (bndx_change_flags), (bndx_tree_expand_cb):
	ditto.
	* libbalsa/misc.c: (libbalsa_set_fallback_codeset): include
	UTF-8 as a charset.
	* src/balsa-message.c: (mdn_dialog_response): do not clear NULL
	error.

2007-05-06  Albrecht Dreß

	* configure.in: add HTML flags and libs.

2007-05-06  Peter Bloomfield

	* libbalsa/html.h: compile with GtkHtml3 and GtkPrint.
	* libbalsa/mailbox.c: (libbalsa_mailbox_get_message): compile
	with threads disabled.
	* libbalsa/mailbox.h: remove LB_MAILBOX_STATE_TREECLEANING from
	LibBalsaMailboxState enum.
	* libbalsa/mailbox.c: (libbalsa_mailbox_msgno_filt_out),
	(lbm_set_threading): remove LB_MAILBOX_STATE_TREECLEANING code;
	(lbm_get_index_entry_real): check that mailbox is still open;
	(libbalsa_mailbox_get_message): lock mailbox before checking
	args.
	* src/balsa-index.h: add current_msgno to BalsaIndex structure,
	and remove selected and selection_changed_id; new public method
	balsa_index_selected_msgnos.
	* src/balsa-index.c: provide GArray of selected messages only
	when needed.
	* src/balsa-mblist.c: (bmbl_drag_cb): use
	balsa_index_selected_msgnos.
	* src/main-window.c: (notebook_drag_received_cb): ditto.
	* src/sendmsg-window.c: ditto.
	* libbalsa/mailbox_local.h: new LibBalsaMailboxLocalMessageInfo
	structure and LibBalsaMailboxLocalClass method get_info; remove
	load_message class method; do not export 
	libbalsa_mailbox_local_queue_sync--it's now static.
	* libbalsa/mailbox_local.c: implement LibBalsaMailboxClass methods
	get_message, messages_change_flags, and msgno_has_flags here
	instead of in back-ends; keep a pool of object-reffed messages.
	* libbalsa/mailbox_maildir.c: remove LibBalsaMailboxClass methods
	get_message, messages_change_flags, and msgno_has_flags.
	* libbalsa/mailbox_mbox.c: ditto
	* libbalsa/mailbox_mh.c: ditto.
	* src/balsa-message.c: (display_part): ensure UTF-8;
	(libbalsa_msg_try_mp_signed), (message_recheck_crypto_cb):
	notify user only once.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text):
	ditto.
	* configure.in: detect GMime version 2.2.7
	* libbalsa/misc.c: (libbalsa_set_fallback_codeset): use
	g_mime_set_user_charsets when it's available.

2007-05-05  Pawel Salek

	* libbalsa/identity.[hc]: signature processing belongs here.
	* src/sendmsg-window.c: use it.
	* libbalsa/html.h: fix bug 435594.

2007-05-04  Peter Bloomfield

	* src/balsa-mime-widget-image.c: (img_check_size): use GDK lock
	in idle callback.

2007-05-03  Peter Bloomfield

	* src/balsa-message.c: (balsa_message_has_next_part),
	(balsa_message_has_previous_part): return FALSE unless we have
	a part.
	* src/main-window.c: (enable_part_menu_items),
	(notebook_switch_page_cb): improve message menu item sensitivity.

2007-05-01  Peter Bloomfield

	* libbalsa/information.c: (libbalsa_information_varg): escape
	more HTML special characters.
	* src/main-window.c: (bw_create_index_widget): sensitize button
	when type of search is changed.
	* src/balsa-index.c: (bndx_selection_changed): clear preview
	more reliably.
	* src/balsa-index.c: (balsa_index_set_threading_type): fix typo.

2007-05-01  Pawel Salek

	* src/mailbox-node.c: do not print null strings.
	* src/toolbar-factory.c: apply patch from bug 410095 ,extended.
	* configure.in, NEWS: release 2.3.15.

2007-04-29  Peter Bloomfield

	* src/information-dialog.c: (balsa_information_real): do not try
	to pop up dialog if main-window is NULL.

2007-04-29  Peter Bloomfield

	* libbalsa/libbalsa.h: add error code for get-duplicates.
	* libbalsa/mailbox.c: (libbalsa_mailbox_move_duplicates): use
	it.
	* libbalsa/mailbox_local.c: check error return from
	prepare-threading.
	* src/balsa-index.c: (balsa_index_set_threading_type): ditto.
	* src/main-window.c: (remove_duplicates_cb): ensure-visible only
	if no error.
	* src/main.c: (balsa_progress_set_text),
	(balsa_progress_set_fraction): check for NULL main-window.

2007-04-29  Peter Bloomfield

	* src/balsa-mime-widget-text.c: (bm_widget_new_html): fix popup
	menu for HTML part.

2007-04-28  Peter Bloomfield

	* libbalsa/information.c: (libbalsa_information_varg): simplify
	conditional code.

2007-04-27  Peter Bloomfield

	* libbalsa/information.c: (libbalsa_information_varg): replace
	'<' with "&lt;" entity in message string.

2007-04-26  Pawel Salek

	* src/balsa-message.c: do not crash on empty address groups.
	* libbalsa/imap/imap-commands.c: make GPGME and BINARY work together.

2007-04-25  Christophe Merlet  <redfox@redfoxcenter.org>

	* configure.in: added "oc" (Occitan) to ALL_LINGUAS.

2007-04-24  Pawel Salek

	* src/balsa-message.c: stop encryption processing if mailbox
	access fails.
	* libbalsa/mailbox_imap.c: attempt to handle fetch errors better.
	* libbalsa/imap/imap-commands.c: BINARY falls back to traditional
	method encountering UNKNOWN-CTE.

2007-04-23  Pawel Salek

	* libbalsa/information.c: build on 64-bit architecture.

2007-04-22  Albrecht Dreß

	* src/balsa-mime-widget-message.c: pass the reported sending code
	to the user.
	* src/{sendmsg-window,balsa-message}.c: ditto.
	* libbalsa/gmime-gpgme-context.c: Work around gpgme "pecularities"
	- fix bug 419903.
	* libbalsa/{rfc3156,send}.{c,h}: ditto.
	* libbalsa/mailbox_imap.c: do not get fooled by shorter binary
	attachments.(PS)

2007-04-21  Pawel Salek

	* libbalsa/mailbox_imap.c: plug memory leaks.
	* libbalsa/imap-server.c: enable binary extension.
	* libbalsa/imap/imap-handle.c: process BINARY output.
	* libbalsa/imap/imap-handle.h: add BINARY to the known capability list.
	* libbalsa/imap/imap-commands.c: issue BINARY commands.
	* libbalsa/information.c: fix memory leak in notify code.

2007-04-21  Peter Bloomfield

	* src/main-window.c: (balsa_window_new),
	(display_new_mail_notification), (cancel_new_mail_notification):
	pop up new-mail notification only if main-window is not active, and
	cancel it when main-window becomes active.

2007-04-20  Albrecht Dreß

	* libbalsa/address-book-ldap.c: support LDAP referrals.

2007-04-20  Peter Bloomfield

	* src/main-window.c: (display_new_mail_notification): use no
	more than one NotifyNotification for new mail.

2007-04-16  Pawel Salek

	* src/balsa-index.c: keep current message visible in the index on
	filter changes.

2007-04-15  Pawel Salek

	* src/main-window.c: use libnotify only if the initialization was
	successful.
	* libbalsa/information.c: ditto.

2007-04-11  Pawel Salek

	* libbalsa/imap/siobuf.c: rename external symbols to avoid
	conflicts with libesmtp.
	
2007-04-10  Johan Brannlund

	* configure.in: detect libnotify.
	* libbalsa/information.c: use it.
	* libbalsa/libbalsa.c: init it.
	* libbalsa/{send,server}.c: downgrade some messages to debug.
	* src/main-window.c: use libnotify for new mail notification.
	* src/balsa-mblist.c: prefer trailing spaces instead of leading ones.
	* libbalsa/imap/imap-handle.c: really disconnect (PS).
	* libbalsa/libbalsa-conf.c: correct CHECK_VERSION (PB).

2007-04-09  Pawel Salek

	* libbalsa/mailbox_imap.c: do not re-try user-aborted actions.
	* libbalsa/libbalsa.[ch]: generalize libbalsa_ask() to implement
	libalsa_abort_on_timeout().
	* libbalsa/imap/imap-handle.c: support for distinguising aborted
	operations from those that timed out.
	* libbalsa/imap/libimap.h: add IME_TIMEOUT event type.
	* libbalsa/imap/imap-handle.h: add imap_handle_op_cancelled().
	* libbalsa/imap/imap_private.h: add op_cancelled field.
	* libbalsa/imap/siobuf.[ch]: core of timeout handling.
	* libbalsa/server.c: ask user what to do on timeout.

2007-04-05  Peter Bloomfield 

	* configure.in: detect gtkhtml-3.14; detect GtkPrint support in
	gtkhtml3; detect GMime version 2.2.5 or later.
	* libbalsa/body.c:
	(libbalsa_message_body_extract_embedded_headers): new GMime api.
	* libbalsa/html.c: don't use Gnome printing api if GtkPrint is
	supported.
	* libbalsa/mailbox_imap.c: new GMime api.
	(internet_address_new_from_imap_address), (lb_set_headers),
	(lbm_imap_construct_body): ditto.
	* libbalsa/message.c: (libbalsa_message_user_hdrs_from_gmime),
	(lbmsg_set_header), (libbalsa_message_set_subject_from_header):
	ditto.
	* src/sendmsg-window.c: ditto.

2007-03-13  Pawel Salek

	* libbalsa/address-entry.c: fix crash reported on balsa-list.

2007-02-26  Pawel Salek

	* libbalsa/mailbox_imap.c: fetch small messages in one shot to get
	rid of one RTT.

2007-02-20  Albrecht Dreß

	* src/Makefile.am: add balsa-cite-bar.[ch] to
	balsa_BASE_SRCLIST.
	* src/balsa-cite-bar.c: (balsa_cite_bar_get_type),
	(balsa_cite_bar_class_init), (balsa_cite_bar_init),
	(balsa_cite_bar_new), (balsa_cite_bar_resize),
	(balsa_cite_bar_destroy), (balsa_cite_bar_realise),
	(balsa_cite_bar_size_request), (balsa_cite_bar_size_allocate),
	(balsa_cite_bar_expose): initial commit.
	* src/balsa-cite-bar.h: initial commit.
	* src/balsa-mime-widget-text.c: (balsa_mime_widget_new_text),
	(quote_tag), (fix_text_widget), (destroy_cite_bars),
	(draw_cite_bar_real), (draw_cite_bars): use cite-bars with
	quoted text.
	* src/balsa-print-object-text.c: (balsa_print_object_text_plain),
	(balsa_print_object_text): use cite-bars only with text/plain
	message part.
	* src/balsa-print-object-text.h: new method
	balsa_print_object_text_plain.
	* src/balsa-print-object.c:
	(balsa_print_objects_append_from_body): use
	balsa_print_object_text_plain.

2007-02-18  Peter Bloomfield

	* libbalsa/mailbox.c: (libbalsa_mailbox_prepare_threading),
	(mbox_set_sort_column_id):
	use success indicator from prepare-threading to avoid crash when
	mailbox is closed during prepare-threading.
	* libbalsa/mailbox.h: new declaration for prepare-threading.
	* libbalsa/mailbox_imap.c:
	(libbalsa_mailbox_imap_prepare_threading): ditto.
	* libbalsa/mailbox_local.c:
	(libbalsa_mailbox_local_prepare_threading): return FALSE if
	mailbox is closed when updating UI.

2007-02-17  Pawel Salek

	* src/mailbox-node.c: save cache only for the top-level nodes.
	* src/main-window.c: remove shortcut conflict.
	* src/address-book-config.c: add ldap:// prefix (Albrecht Dress).
	* libbalsa/address-book-ldap.c: AD compatiblity (Albrecht Dress).
	
2007-02-09 Pema Geyleg  <pema.geyleg@gmail.com>

	* configure.in: added dz to ALL_LINGUAS.

2007-01-23  Peter Bloomfield

	* src/main-window.c: (balsa_window_new): make balsa_app.appbar a
	weak pointer.

2007-01-20  Peter Bloomfield

	* doc/C/balsa.xml: fix typos.

2007-01-20  Peter Bloomfield

	* libbalsa/body.c: (libbalsa_message_body_get_parameter): check
	for NULL content-type.

2007-01-20  Peter Bloomfield, Albrecht Dreß

	* configure.in: check for Subversion instead of CVS; check for
	langinfo.h.
	* src/balsa-app.h: GtkPrint fixes and extensions.
	* src/balsa-print-object-header.c:
	(balsa_print_object_header_destroy),
	(balsa_print_object_header_new_real),
	(balsa_print_object_header_crypto),
	(balsa_print_object_header_draw): ditto.
	* src/balsa-print-object-header.h: ditto.
	* src/balsa-print-object-text.c: (balsa_print_object_text):
	ditto.
	* src/balsa-print-object.c: (split_for_layout): ditto.
	* src/balsa-print-object.h: ditto.
	* src/print-gtk.c: (begin_print), (draw_page),
	(get_default_user_units), (add_font_button), (add_margin_spinbtn),
	(check_margins), (message_prefs_widget), (message_prefs_apply):
	ditto.
	* src/save-restore.c: (restore_gtk_page_setup),
	(config_global_load), (config_save): ditto.

2007-01-15  Peter Bloomfield

	* libbalsa/mailbox.c: (lbm_msgno_changed),
	(lbm_get_index_entry_real): less noise.

2007-01-14  Pawel Salek

	* configure.in: actually use gnome_print_extras.
	* libbalsa/libbalsa-conf.c: glib-2.6.8 has no g_key_file_[sg]et_double().

2007-01-14 Albrecht Dreß

	* configure.in: support GtkPrint.
	* libbalsa/libbalsa-conf.c: (libbalsa_conf_foreach_keys),
	(libbalsa_conf_get_double_with_default_),
	(libbalsa_conf_set_double_): add some missing capability.
	* libbalsa/libbalsa-conf.h: ditto.
	* src/Makefile.am: support GtkPrint.
	* src/balsa-app.c: (balsa_app_init): ditto.
	* src/balsa-app.h: ditto.
	* src/main-window.c: (page_setup_cb): ditto.
	* src/message-window.c: (page_setup_cb): ditto.
	* src/print.h: ditto.
	* src/save-restore.c: (load_gtk_print_setting),
	(restore_gtk_page_setup), (config_global_load),
	(save_gtk_print_setting), (save_gtk_page_setup), (config_save): ditto.
	* src/sendmsg-window.c: ditto.

2007-01-07 Pawel Salek

	* src/mailbox-node.c: g_strconcat() needs trailing NULL.

2007-01-06 Pawel Salek

	* src/mailbox-node.[hc]: cache IMAP mailbox lists.
	* libbalsa/filter-funcs.c: init *entire* date struct.

2006-12-28 Pawel Salek

	* doc/C/balsa.xml: document more advanced IMAP options.
	* libbalsa/imap-server.[ch]: add ability to disable IDLE.
	* libbalsa/mailbox_imap.c: fix locking in imap_exists_cb.
	* libbalsa/imap/imap-handle.[ch]: add ability to disable IDLE.
	* libbalsa/imap/imap_private.h: ditto.
	* src/folder-conf.c: UI for IDLE disabling.
	* src/mailbox-node.c: place mailboxes in scanned locations.

2006-12-12 Pawel Salek

	* src/sendmsg-window.c: set subject for forwarded messages.
	* src/store-address.c: set default address book for gtk-2.10.
	* configure.in, NEWS: release 2.3.14.

2006-12-03 Pawel Salek

	* libbalsa/mailbox.c: libbalsa_mailbox_get_message() may fail.
	* libbalsa/mailbox_imap.c: print a message when it does.

2006-12-02 08:48  PeterB

	* src/sendmsg-window.c: handle "attach" keyword in mailto URLs,
	carefully.

2006-12-01 Pawel Salek

	* libbalsa/imap/imap-handle.c: balsa could not handle some
	response codes.

2006-11-18  Djihed Afifi  <djihed@gmail.com>

	* configure.in: Added Arabic.

2006-11-09 08:56  PeterB

	* src/sendmsg-window.c: no need for count when toggling entries;
	simplify dialog language.

2006-11-08 10:49  PeterB

	* src/sendmsg-window.c: restore bcc= in mailto URLs, with a
	popup, and make sure Bcc: header is shown if set.
	* libbalsa/mailbox_mbox.c: check for NULL mime_message.

2006-11-01 08:46  PeterB

	* src/sendmsg-window.c: disable attach= and bcc= in mailto URLs
	pending security review.
	* src/sendmsg-window.c: handle "attach" keyword in mailto URLs,
	thanks to Johan Brannlund.
	* src/main.c: do not try to expunge a read-only mailbox.

2006-10-26 09:42  PeterB

	* libbalsa/mailbox_mbox.c: drop the mime-stream-shared lock while
	caching the message--we might grab the gdk lock to update the
	display.

2006-10-08  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/pref-manager.c: add a check button to enable or disable
	playing a "new mail sound".
	* src/sendmsg-window.c: German is /not/ always the same.
	* libbalsa/gmime-gpgme-context.c: make a gpgme (crypto) error more
	meaningful.

2006-10-07 11:08  PeterB

	* libbalsa/: mailbox.c, mailbox_local.c: build with
	--disable-threads.

2006-10-04 12:37  PeterB

	* src/sendmsg-window.c: quote message when quoting, and not when
	inlining.
	* libbalsa/mailbox.c: construct new order correctly in imap
	mailbox.

2006-09-24  Pawel Salek

	* src/sendmsg-window.c: quote message bodies, not headers only.

2006-09-21 18:32  PeterB

	* libbalsa/mailbox.c: notify gdk when message info is cached;
	disable lock check for normal use.

2006-09-18 08:10  PeterB

	* libbalsa/message.c: Disposition-Notification-To is not a user
	header.
	* libbalsa/mailbox_mbox.c: more careful check for From_ line.

2006-09-17  Pawel Salek

	* src/sendmsg-window.c: cleanup. Compose and forward will insert
	the signature if requested.

2006-09-15 21:17  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/mailbox_maildir.c,
	libbalsa/mailbox_mh.c, src/balsa-index.c: check
	LibBalsaMailboxIndexEntry for pending idle call; defer adding
	entries to LibBalsaMailbox::mindex, and modify it only in
	mailbox.c; drop LB_MBOX_MESSAGE_COL, and use
	libbalsa_mailbox_get_message instead.
	* libbalsa/mailbox_mbox.c: do not relocate message_info structures,
	so we can make msg_info->message a weak pointer; access them with a
	GPtrArray; do not modify LibBalsaMailbox::mindex.
	* src/main-window.c: more moderate close-icon on notbook tab.

2006-09-12 07:24  PeterB

	* configure.in: remove spaces around '='.

2006-09-11 20:29  PeterB

	* libbalsa/: libbalsa_private.h, mailbox.c, mailbox.h,
	mailbox_local.c: use a sub-thread instead of an idle-handler for
	getting messages; lock mailbox in libbalsa_mailbox_get_message.
	* configure.in: report version of gtkhtml-3.x.

2006-09-04 00:32  PeterB

	* libbalsa/libbalsa_private.h, libbalsa/mailbox.c,
	libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, src/balsa-index.c: use an idle callback
	in lbm_get_index_entry to handle getting messages; as a result, we
	can simplify the API for prepare-threading.

2006-09-04 00:14  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox_imap.c, libbalsa/message.c,
	libbalsa/message.h, src/balsa-message.c,
	src/balsa-mime-widget-message.c, src/sendmsg-window.c: implement
	and use libbalsa_message_set_subject{,_from_header}; fix
	canonize_header_value to handle non-ASCII white space.

2006-09-01  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/message.c: collapse whitespace into a single space.

2006-08-30 07:55  PeterB

	* configure.in: build with autoconf-2.60.

2006-08-28 12:04  PeterB

	* src/main-window.c: make notebook tabs reorderable with drag and
	drop.

2006-08-27 16:35  PeterB

	* libbalsa/: mailbox.c, mailbox_local.c: check for NULL message.

2006-08-27  Pawel Salek

	* libbalsa/address.c: gtk_tree_store not updated until
	gtk_tree_model loses focus (gtk2-2.8.20). Force it.
	* libbalsa/mailbox.c: ... gtk-2.8 should be smart enough to detect
	visible cells - no reason to spent time hinting it (hinting's slow
	on large mailboxes).

2006-08-26 10:08  PeterB

	* libbalsa/message.c: check for NULL headers.

2006-08-23 09:49  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: replace three gbooleans
	with a state variable, and use it to simplify "message has been
	modified" dialog.
	* libbalsa/: body.c, files.c: check for NULL body.

2006-08-22  Pawel Salek

	* src/sendmsg-window.c: set identity for compose, Peter's way.
	* libbalsa/identity.c: do not try unreffing NULL when adding new ident.

2006-08-14 13:07  PeterB

	* src/sendmsg-window.c: restore setting identity in reply or
	continuation.

2006-08-10  Pawel Salek

	* src/sendmsg-window.c: do not use released memory.

2006-08-07 19:46  Pawel Salek

	* src/sendmsg-window.c: add missing mailbox_close() call. Build fixes.
	* src/balsa-mime-widget-message.c: Build fixes.

2006-08-07 Pawel Salek

	* libbalsa/filter.c: use new content2reply().
	* libbalsa/mailbox_local.c: ditto.
	* libbalsa/message.[ch]: extra routines for header manipulation.
	* libbalsa/mime.[ch]: content2reply accepts a message part now.
	* src/balsa-message.c: aim at providing common ancestor to
	LibBalsaMessage and LibBalsaMessageBody.
	* src/balsa-mime-widget-message.[hc]: call reply to
	embedded message.
	* src/sendmsg-window.[hc]: some more related
	refactoring. Implement reply to embedded message.

2006-08-06 Pawel Salek

	* src/ab-window.c: use new Sendmsg API with better separation
	between compose, reply, forward and continue.
	* src/balsa-bonobo.c: ditto.
	* src/balsa-index.c: ditto.
	* src/balsa-mime-widget-message.c: prepare for replying embedded
	messages.
	* src/balsa-mime-widget-text.c: use new API.
	* src/main{-window,}.c: ditto.
	* src/message-window.c: ditto.
	* src/sendmsg-window.[ch]: separate better different compose modes
	so that implementation of replying to embedded messages becomes
	easier.

2006-07-09 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/sendmsg-window.c: do not perform crypto on entire message.

2006-07-04 12:09  PeterB

	* libbalsa/address.c: gtk_list_store_insert_with_values requires
	gtk version 2.6.

2006-06-29 10:47  PeterB

	* src/: balsa-index.c, balsa-mblist.c, balsa-message.c,
	balsa-mime-widget-text.c, balsa-mime-widget.c, pref-manager.c:
	clear face box instead of hiding it; gtk_object_sink is deprecated
	in 2.10--use g_object_ref_sink if available.

2006-06-27  Pawel Salek

	* Makefile.am: gnome specific macros not used any more.
	* libbalsa/imap-server.c: use client-side sorting.
	* libbalsa/mailbox_imap.c: set first_unread correctly.
	* libbalsa/imap/imap-commands.c: implement client-side sorting.
	* libbalsa/imap/imap-handle.[ch]: add CLIENT_SORT option.
	* libbalsa/imap/imap_private.h: add the bit field to ImapMboxHandle.

2006-06-26  Pawel Salek

	* libbalsa/mailbox_imap.c: use the synchronous STORE calls for now.
	* libbalsa/mailbox_local.c: set first_unread more reliably.
	* src/balsa-index.c: fix bug 345638.
	* NEWS: release 2.3.13.

2006-06-25 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/: ab-window.c, ab-window.h: use a table to improve layout of
	address selection dialog.

2006-06-22  Pawel Salek

	* libbalsa/identity.c: fix a regression (patch from PB).
	* libbalsa/address-entry.c: remove non-printable characters on
	text paste (AD).

2006-06-17  Pawel Salek

	* Makefile.am: do not include GNOME_Balsa.server in the tarball.
	* balsa.spec.in: fedora builds do not require gmime.
	* configure.in: prepare for release.
	* libbalsa/identity.c: allow arbitrary sig file names so that
	arguments can be passed to executable sigs.

2006-06-16 08:17  PeterB

	* libbalsa/mailbox_imap.c: get mailbox lock before gdk lock.

2006-06-15 21:55  PeterB

	* libbalsa/mailbox_local.c: drop the gdk lock before returning.

2006-06-01 10:57  PeterB

	* libbalsa/mailbox_imap.c: free cache-manager.
	* src/balsa-mblist.c: append subtree when appending exposed
	unscanned node.

2006-05-31 09:43  PeterB

	* libbalsa/filter-file.c, libbalsa/filter-funcs.c,
	libbalsa/filter.c, libbalsa/filter.h, libbalsa/mailbox.c,
	libbalsa/mailbox_local.c, src/balsa-index.c,
	src/filter-edit-callbacks.c, src/filter-edit-dialog.c,
	src/main-window.c: ref-count LibBalsaCondition instead of cloning.
	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c: free
	mailbox info after closing mailbox-local.

2006-05-30 00:22  PeterB

	* src/balsa-mime-widget-text.c: plug leak.

2006-05-29 15:56  PeterB

	* libbalsa/: mailbox.c, mailbox.h: implement
	LibBalsaMailbox::persistent_view_filter.
	* src/: balsa-index.c, main-window.c: make flag view-filter
	persistent, so we can restore it when closing a local mailbox.
	* libbalsa/mailbox_local.c: restore persistent view-filter before
	saving the tree when closing.

2006-05-26  Pawel Salek

	* libbalsa/mailbox.c: sort IMAP mailboxes correctly (part of the
	information returned by the imap server was ignored at this level).
	* src/balsa-app.c: really respect the "remember passwd" check box.
	* src/balsa-index.c: do not re-sort on index close.

2006-05-25 11:11  PeterB

	* libbalsa/smtp-server.c: do not crash without
	HAVE_SMTP_TLS_CLIENT_CERTIFICATE.

2006-05-20 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/balsa-icons.[hc]: Choose a better icon for the trash mailbox
	when GNOME_STOCK_TRASH is unavailable.
	* configure.in: remove stray '-' as reported by Jean-Luc Coulon.

2006-05-17  Pawel Salek

	* libbalsa/imap/imap-commands.c: fix return codes of async routines.
	* libbalsa/imap/imap{-handle,_private}.c: ditto.
	* libbalsa/mailbox_imap.c: use changed return codes.

2006-05-15  Pawel Salek

	* libbalsa/imap/imap-handle.c: reset idle_issued flag. handle
	message-other right, this includes message/delivery-status.
	* src/balsa-mime-widget.c: display message/delivery-status parts.

2006-05-14 10:46  PeterB

	* src/sendmsg-window.c: make Yes the default response when user
	closes unsaved compose window; add Cancel option when user closes
	auto-saved compose window.
	* src/sendmsg-window.c: unref, not free, a GObject.

2006-05-13  Pawel Salek

	* libbalsa/mailbox_imap.c: use async interface for STORE commands.
	* libbalsa/mailbox_mbox.c: do not use file_set_contents() on OSX.
	* libbalsa/imap/imap-commands.c: async store_flag_a()
	* libbalsa/imap/imap-commands.h: proper prototypes.
	* libbalsa/imap/imap-handle.c: generalize IDLE response handlers
	to general async command response handlers.
	* libbalsa/imap/imap_private.h: provide support for handle locking
	and asynchronous command handling.
	* src/balsa-index.c: scroll first, fetch messages later.

2006-05-12 09:10  PeterB

	* website/faq.html: restore website/faq.html, with a new entry for
	format=flowed.

2006-05-09  Pawel Salek

	* src/main.c: fix -a handling when GOption API is used.
	
2006-05-07 14:26  PeterB

	* libbalsa/imap/imap-handle.c: add message_id to cache.

2006-05-03 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/mime.c: Improve recognition of multi-line URLs.
	* libbalsa/misc.h: store a flag whether URL is in a flowed message.
	* src/balsa-mime-widget-text.c: initialize this flag.

2006-04-25  Carlos Morgado  <chbm gnome.org>

	* libbalsa/address.c (addrlist_drag_drop_cb): fix broken cast on 64b

2006-04-21 09:46  PeterB

	* libbalsa/mailbox.c: total message count can change while we're
	working on the tree, so we save it and remove assertions.

2006-04-17  Pawel Salek

	* libbalsa/address.[ch]: address list of edit vidget is now a drop
	target.
	* libbalsa/mailbox_imap.c: get rid of one RTT for simple messages.
	* libbalsa/mailbox_mbox.c: silence spurious warnings on OSX.
	* libbalsa/send.c: failure to send a message is an error.
	* src/ab-main.c: support D&D and address lists.

2006-04-17  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Remove obsolete no_NO locale.
	* po/no.po: And the translation.

2006-04-07  Carlos Morgado  <chbm chbm.net>

	* src/balsa-message.c (add_multipart_mixed): fix build without GPGME

2006-04-05 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/balsa-message.c: fix MDN syntax; add option to show all parts
	inline.

2006-04-05 13:17  PeterB

	* src/save-restore.c: do not save UNSET show or subscribe values.

2006-04-01 09:52  PeterB

	* src/pref-manager.c: do not crash if address book changes are
	applied after pref manager is closed.
	* src/address-book-config.c: allow only one dialog per address
	book.
	* libbalsa/mailbox.c: don't clear counts until we know they're
	wrong.

2006-03-27 07:55  PeterB

	* src/main-window.c: cut down console messages.
	* src/balsa-mblist.c: if mailbox isn't subscribed for checking,
	don't notify user about new mail and don't emit BalsaMBList signal.

2006-03-24 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/libbalsa.c: proper regex's for highlighting quoted
	lines.
	* configure.in: libesmtp sometimes needs -lpthread.

2006-03-24 08:44  PeterB

	* libbalsa/smtp-server.c: build without
	HAVE_SMTP_TLS_CLIENT_CERTIFICATE.
	* libbalsa/mime.c: include ctype header file.
	* src/balsa-mblist.c: unref the correct object; hold gdk lock while
	closing mbnode.

2006-03-23  Pawel Salek

	* libbalsa/send.c: report MAIL FROM SMTP command errors.

2006-03-21  Pawel Salek

	* libbalsa/mi{me,sc}.c: move PCRE dependency to mime.c
	* libbalsa/mailbox.c: copy the "deleted" flag as well (Emanuel).

2006-03-18  Pawel Salek

	* libbalsa/libbalsa.[hc]:
	* libbalsa/misc.[hc]: move library-dependent stuff to libbalsa.c.

2006-03-17  Pawel Salek

	* configure.in: create separately list of balsa-ab libraries (12
	libs removed). Albrecht Dreß fixed detection of buggy gpgme.
	* src/Makefile.am: use it.
	* libbalsa/libbalsa.[hc]:
	* libbalsa/misc.[hc]: move object-independent stuff to misc.c.
	* libbalsa/mailbox_pop3.c: include misc.h
	* src/ab-main.c: register only used objects.

2006-03-16 19:56  PeterB

	* libbalsa/mailbox.c: notify Gtk when msgno changes.

2006-03-09  Pawel Salek

	* libbalsa/address-book-ldap.c: use openldap-2.3.x compatible API.
	* libbalsa/libbalsa.c: the same.
	* libbalsa/imap/imap-handle.c: treat OpenSSL errors as critical.
	* src/balsa-mblist.c: don't be mad if an icon is not found.

2006-03-08 10:40  PeterB

	* src/main-window.c: ensure visible message after changing view
	filter.

2006-03-06  Ahmad Riza H Nst  <rizahnst@eriagempita.co.id>

	* configure.in: Added "id" (Indonesian) to the ALL_LINGUAS line

2006-03-05 10:23  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h, src/balsa-index.c: check
	whether user closed mailbox during long view-filter update.

2006-03-04  Pawel Salek

	* libbalsa/mailbox_mbox.c:  do not reference freed memory.
	* NEWS, configure.in: release 2.3.12.


2006-02-28  Pawel Salek

	* src/balsa-app.c: check mbnode fetched by gtk_tree_model_get()...
	* src/balsa-mblist.c: ... fixing bug 332980.
	* NEWS, configure.in: release 2.3.11.

2006-02-27 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/sendmsg-window.c: explicitly update gpg-mode when identity is
	changed, as apparently the callback is now called only when the
	check-button's state is changed.

2006-02-26 19:28  PeterB

	* src/balsa-index.c: scroll to ensure a visible message only if
	there isn't one.
	* doc/C/balsa.xml, src/pref-manager.c: arrange the help file to
	match the new prefs window; use section titles instead of notebook
	page numbers to locate help sections.

2006-02-25 13:56  PeterB

	* src/: balsa-index.c, balsa-index.h, main-window.c: implement
	balsa_index_ensure_visible, and use it.
	* src/main.c: set GNOME_PARAM_APP_DATADIR.
	* libbalsa/address-book-ldap.c, libbalsa/address-book.c,
	src/address-book-config.c, src/pref-manager.c: give user control
	over LibBalsaAddressBook::is_expensive.
	* src/balsa-index.c: try to leave messages showing after changing
	view filter.

2006-02-15  Pawel Salek

	* libbalsa/html.c: silence printf().
	* libbalsa/{message,mailbox_mbox}.c: remove remains of msg counting.
	* libbalsa/mailbox_imap.c: fix a crash in low index selection on
	cache restore (spotted by PeterB).
	* libbalsa/imap/imap-commands.c: check more return codes.
	* libbalsa/imap/imap-{handle,search}.c: ditto.

2006-02-21 10:53  PeterB

	* src/balsa-mblist.c: hide title and make column natural size when
	using single column.

2006-02-20 22:51  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: save reflow widget in
	BalsaSendmsg, in case user opens multiple windows.

2006-02-19 12:39  PeterB

	* src/balsa-mblist.c, libbalsa/mailbox.c: show count of hidden
	messages on status bar; show only non-zero counts.
	* src/balsa-message.c: make sure widget can focus.

2006-02-18 15:31  PeterB

	* src/sendmsg-window.c, libbalsa/address-entry.c,
	libbalsa/address-entry.h: use Escape instead of ctrl+R for manual
	address completion.
	* libbalsa/address-book-ldap.c: make LDAP address book expensive.
	* src/pref-manager.c: edit address book on row-activated; add
	closure to add_button_to_box.

2006-02-18 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/balsa-mime-widget-text.c: fix bug 330093 -- 'copy URL' when
	right-clicking one in a mail.

2006-02-17 21:26  PeterB

	* src/: balsa-message.c, balsa-message.h,
	balsa-mime-widget-callbacks.c, main-window.c, main-window.h:
	one-key mail reading using space bar.
	* src/main.c: drop gdk lock before syncing mailboxes.
	* src/mailbox-node.c: check mailbox in an idle handler.
	* src/balsa-index.c: use the gdk lock to control access to
	LibBalsaMailbox::msg_tree.
	* libbalsa/: libbalsa.c, libbalsa.h, mailbox.c, mailbox.h,
	mailbox_imap.c, mailbox_local.c: use the gdk lock to control access
	to LibBalsaMailbox::msg_tree.

2006-02-15  Pawel Salek

	* balsa.desktop.in: Terminal=0 -> Terminal=false
	* libbalsa/rfc3156.c: failed gpg execution is warning, not just info
	(Albrecht Dreß).

2006-02-13 22:42  PeterB

	* src/: balsa-mblist.c, balsa-icons.c, balsa-icons.h: use icon-name
	GtkTreeViewColumn attribute.
	* src/: balsa-index.c, balsa-index.h, main-window.c,
	message-window.c: reset view filter to show unread message.
	* src/pref-manager.c: move message-window group to display-options
	page; move format group to character-set page and rename page.
	* src/balsa-mblist.c: unref pixbufs; dup string only when
	necessary.

2006-02-12 15:11  PeterB

	* src/pref-manager.c: let lists expand vertically.
	* src/pref-manager.c: align controls.
	* src/pref-manager.c: try to fill pages, as per HIG.

2006-02-11 15:32  PeterB

	* src/balsa-mblist.c: show unread count in parentheses when not
	showing info columns.

2006-02-10 08:22  PeterB

	* src/: balsa-app.c, balsa-index.c: check for NULL index.

2006-02-09 13:11  PeterB

	* libbalsa/misc.c: disable bracket-checking.

2006-02-07 07:29  PeterB

	* src/balsa-mblist.c: schedule only one idle callback at a time;
	move UI update to idle callback.
	* libbalsa/mailbox_local.c: clear total when restore-tree fails.

2006-02-06 15:46  PeterB

	* src/main-window.c: use NULL instead of empty string when it will
	be translated.
	* src/pref-manager.c: move utf8 out of translated string.
	* src/balsa-index.c: fix another typo in earlier commit.
	* libbalsa/rfc3156.c: fix typo in previous commit.
	* libbalsa/gmime-gpgme-signature.c, libbalsa/mailbox_pop3.c,
	libbalsa/misc.c, libbalsa/rfc3156.c, po/POTFILES.in,
	src/balsa-index.c, src/save-restore.c, src/sendmsg-window.c,
	src/spell-check.c: fix strings--bug 330085.

2006-02-05 21:18  PeterB

	* src/pref-manager.c: hide notebook borders and remove extra
	border-width.

2006-02-05  Carlos Morgado  <chbm gnome.org>

	* src/pref-manager.c (pspell_settings_group): fix pedantic pspell build

2006-02-05 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/pref-manager.c: use unicode for special characters; let
	gtk-label wrap lines.

2006-02-04 12:24  PeterB

	* libbalsa/misc.c: plug object leak.
	* src/pref-manager.c: plug widget leak.

2006-02-03 22:04  PeterB

	* src/pref-manager.c: use tree control instead of nested notebooks.
	* src/mailbox-conf.c: less ugly alignment.

2006-02-03  Pawel Salek

	* libbalsa/smtp-server.c: include misc.h for libbalsa_create_label.

2006-02-01 20:30  PeterB

	* src/address-book-config.c, src/balsa-app.c, src/balsa-app.h,
	src/balsa-index.c, src/folder-conf.c, src/mailbox-conf.c,
	libbalsa/identity.c, libbalsa/misc.c, libbalsa/misc.h,
	libbalsa/smtp-server.c: more consistent dialogs.
	* libbalsa/mailbox_mbox.c: use cache file to speed up
	mailbox-check.
	* src/mailbox-conf.c: create only one dialog for new mailbox and to
	modify POP3 mailbox.
	* src/mailbox-conf.c: check for NULL mailbox.

2006-01-29 20:39  PeterB

	* libbalsa/message.c: avoid infinite recursion.
	* src/balsa-index.c, src/balsa-index.h, src/balsa-mblist.c,
	src/balsa-mblist.h, src/mailbox-conf.c, src/main-window.c,
	src/main.c, src/save-restore.c, libbalsa/mailbox.c,
	libbalsa/mailbox.h: next-unread chains to all mailboxes with unread
	mail.
	* libbalsa/message.c: encode broken headers before passing them to
	GMime for decoding.

2006-01-29  Pawel Salek

	* NEWS: release 2.3.10.
	* src/sendmsg-window.c: parent error dialog properly. gtk-2.4.x
	compatibility. Do not crash referencing NULL bsmsg->charset in
	is_charset_ok() when the first entry to this function was
	cancelled by user.
	
2006-01-28 22:14  PeterB

	* src/sendmsg-window.c: don't try to set NULL language for
	spell-checking; remember if user set utf8.

2006-01-27 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/misc.c: a new attempt for proper quote highlighting
	re's in the composer.
	* src/balsa-mime-widget-text.c: fixed the never ending highlighting.
	* libbalsa/rfc3156.c: remove gnome dependency.
	* configure.in: mime icon install configuration.
	* images/Makefile.am: ditto.

2006-01-26 05:42  PeterB

	* src/sendmsg-window.c: leave draft-message nonNULL.

2006-01-24  Pawel Salek

	* src/main.c, src/ab-main.c: achieve compatibility with
	libgnome-devel-2.13.7 (bug 178650).

2006-01-24 12:17  PeterB

	* libbalsa/mailbox.c: update view-filter before setting threading.
	* src/filter-run-callbacks.c: scroll to selected filter.

2006-01-23 19:02  PeterB

	* libbalsa/mailbox_mbox.c: check cache file more carefully; better
	buffering in readln.
	* src/sendmsg-window.c: initialize retval.

2006-01-22 20:49  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: simpler
	utf8-confirmation; delete draft message if it was auto-saved but
	not user-saved.

2006-01-22 PeterB, Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/sendmsg-window.c: dialogs suggested by Mişu Moldovan <dumol
	at gnome dot ro>.

2006-01-22 14:30  PeterB

	* libbalsa/mailbox_mbox.c: use our own rdline function.
	* libbalsa/mailbox_mbox.c: step to a From_ line before parsing.
	* libbalsa/mailbox.c: prepare parent messages for threading as well
	as siblings.

2006-01-20 11:15  PeterB

	* src/sendmsg-window.c: restore state only for continued messages.
	* src/: sendmsg-window.c, sendmsg-window.h: fix saving and
	restoring spell-checker state when postponing; build
	--without-gtkspell.

2006-01-19 23:27  PeterB

	* src/sendmsg-window.c: save format=flowed or fixed, and
	spell-check-language, when postponing a message.

2006-01-18 14:36  PeterB

	* libbalsa/: mailbox_local.c, mailbox_local.h, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: don't set first-unread to a deleted
	message; check recent messages for message/partial; load-message is
	a LibBalsaMailboxLocal method; prepare all recent messages for
	threading.
	* src/main.c: reset LibBalsaProgress when we're done with the
	progress bar.

2006-01-17 13:45  PeterB

	* src/balsa-index.c: scroll-on-open immediately, not in idle
	handler.

2006-01-16 18:09  PeterB

	* src/main.c: re-enable updating progress bar from a subthread,
	using gdk lock.
	* libbalsa/mailbox_local.c: downgrade information messages to
	debug.
	* libbalsa/libbalsa.h: fix mangled comment.
	* src/balsa-index.c: schedule only one idle callback when mailbox
	is changed.
	* libbalsa/libbalsa.h, src/main.c: use symbolic constants; disable
	updating progress bar from a subthread.

2006-01-15 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/message.h, libbalsa/send.c, src/sendmsg-window.c: save
	and restore crypto and MDN settings when postponing and continuing.

2006-01-14 19:20  PeterB

	* src/: balsa-index.c, main-window.c: no need to prepare
	threading--mailbox code takes care of caching info.
	* libbalsa/mailbox.c: show progress when filtering-on-reception.
	* libbalsa/mailbox_local.c, src/main.c: use new LibBalsaProgress
	api.
	* libbalsa/mailbox.c: copy flags when copying message instead of
	getting message; show progress when reassembling message/partial;
	use new LibBalsaProgress api.
	* libbalsa/: libbalsa.c, libbalsa.h: simplify LibBalsaProgress and
	make it more opaque.

2006-01-13 22:15  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox_local.c, src/balsa-index.c,
	src/main-window.c, src/main.c: simplify progress bar updates; use
	it for filtering.
	* libbalsa/mailbox_mbox.c: save mailbox info with glib < 2.8;
	disable debug output.

2006-01-14  Chao-Hsiung Liao  <j_h_liau@yahoo.com.tw>

	* configure.in: Add "zh_HK" to ALL_LINGUAS.
	
2006-01-12 12:08  PeterB

	* libbalsa/mailbox.c: must use get-message to get the flags.

2006-01-11 15:45  PeterB

	* src/balsa-mime-widget-text.c: one more.
	* src/balsa-mime-widget-text.c: use glib's type conversion macros
	for gint <=> gpointer.
	* src/sendmsg-window.c: build with gcc < 4.1.
	* libbalsa/mailbox_mbox.c: better: use %zd format specifier.
	* libbalsa/mailbox_mbox.c: cast value to gint for g_print.
	* libbalsa/: mailbox.c, message.c: reset stream after loading
	envelope.
	* libbalsa/mailbox.c: reset stream before adding message.
	* src/: main-window.c, toolbar-factory.c: add optional toolbar
	button for expunge.
	* src/pref-manager.c, src/save-restore.c, libbalsa/smtp-server.c,
	libbalsa/smtp-server.h: implement and use
	libbalsa_smtp_server_add_to_list--deletes existing server if new
	name is a duplicate.
	* libbalsa/mailbox_mbox.c: don't include From_ line in message
	length.

2006-01-10 23:43  PeterB

	* libbalsa/message.c: set message->size from
	g_mime_stream_length().
	* src/main.c: use g_idle_add and data instead of g_io_add_watch and
	pipes.
	* src/main-window.c, src/main-window.h: set progress text in status
	bar; run main loop only if needed.
	* libbalsa/mailbox_mbox.c: save and restore message info.
	* src/balsa-index.c: prepare threading/sorting before setting
	non-flags-only filter.
	* libbalsa/mailbox_local.c: cache file is not created for empty
	mailbox.
	* libbalsa/mailbox.c: use progess bar when copying messages.
	* src/balsa-index.c, src/main-window.c, src/main-window.h,
	src/main.c, libbalsa/libbalsa.c, libbalsa/libbalsa.h: use progress
	bar to show fractional progress; implement wrappers for libbalsa;
	use it when preparing for threading/sorting.
	* libbalsa/: mailbox.c, mailbox_local.c, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: simplify local mailbox caching; use
	progress bar.
	* src/information-dialog.c: do not stack status-bar messages.
	* libbalsa/: mime-stream-shared.c, mime-stream-shared.h: shared
	lock for LibBalsaMimeStreamShared.

2006-01-10 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/misc.c, libbalsa/misc.h, src/balsa-mime-widget-text.c,
	src/sendmsg-window.c, src/sendmsg-window.h: configure GtkSourceView
	with default=no; use it for hacker-highlighting and multi-level
	undo.

2006-01-09 10:49  PeterB

	* src/balsa-message.c: g_return_* argument must not have
	side-effects.

2006-01-06  Pawel Salek

	* configure.in, NEWS: release 2.3.9.

2006-01-06 08:48  PeterB

	* src/main-window.c: check that Balsa didn't quit.

2006-01-05 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* configure.in: GnuPG encryption is stable.

2006-01-05 20:35  PeterB

	* libbalsa/mailbox.c: always set tree-changed if msgno is removed.
	* libbalsa/misc.c: check for anonymous tag.

2006-01-04 20:48  PeterB

	* libbalsa/address.c: don't use InternetAddress::name if it's
	non-NULL but empty.
	* libbalsa/: mailbox.c, mailbox.h, mailbox_imap.c, mailbox_local.c:
	new member LibBalsaMailbox::msg_tree_changed; use it to save tree
	only when needed; manage mailbox->view_filter in mailbox.c.

2006-01-03 22:27  PeterB

	* libbalsa/libbalsa.c: more careful mailbox lock.

2006-01-01 14:10  PeterB

	* src/: balsa-app.h, sendmsg-window.c: build without GTKSPELL.

2006-01-01  Carlos Morgado  <chbm gnome.org>

	* src/sendmsg-window.c, src/balsa-app.h:
	fix build without GTKSPELL
	(first commit!!)

2005-12-31 09:27  PeterB

	* libbalsa/mailbox_local.c: set first-unread when restoring the
	tree.
	* src/balsa-index.h: deadwood.

2005-12-31 08:01  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/: sendmsg-window.c, sendmsg-window.h: keep spell-check
	menu-item consistent with toolbar button.

2005-12-30 12:15  PeterB

	* libbalsa/mailbox_local.c: downgrade warnings to messages and make
	them more people-friendly.

2005-12-29 20:16  PeterB

	* src/: balsa-app.c, balsa-app.h, save-restore.c, sendmsg-window.c:
	handle GtkSpell errors; reattach spell-checker when language is
	changed; spell-checker language persists until spell-checking is
	disabled.
	* libbalsa/mailbox_local.c: special-case flags-only view-filter;
	prepare threading for all messages in the mailbox.

2005-12-28 07:39  PeterB

	* libbalsa/imap-server.c: lock imap-servers before checking for
	non-NULL.

2005-12-28  Pawel Salek

	* libbalsa/imap-server.c: yet another shot at portable mutex
	locking.

2005-12-27 16:25  PeterB

	* libbalsa/imap-server.c: do not try to lock when no servers have
	been created.
	* libbalsa/mailbox_mbox.c: make sure message is cached at
	mailbox-local and mailbox levels.

2005-12-27  Pawel Salek

	* configure.in, NEWS: release 2.3.8.

2005-12-27 12:33  PeterB

	* libbalsa/: imap-server.c, server.c: build with gcc-4.1.
	* libbalsa/mailbox_local.c: check msgno before accessing array.

2005-12-26 23:22  PeterB

	* src/balsa-index.c: remove unnecessary gdk_threads_{leave,enter};
	undo SOS filter before closing, so we save the tree that we need
	when reopening.
	* libbalsa/mailbox_local.c: cache sender for filtering;
	save-tree-file with one record is OK.
	* libbalsa/mailbox_local.c: use g_file_set_contents when available.

2005-12-25 18:50  PeterB

	* libbalsa/mailbox.c: disable some time-consuming sanity checks.
	* libbalsa/mailbox_local.c: more robust, less time-consuming tree
	file checking.

2005-12-24 23:31  PeterB

	* src/: balsa-index.c, balsa-index.h: scroll in an idle handler;
	use prepare-theading.
	* libbalsa/: mailbox.c, mailbox.h, mailbox_imap.c, mailbox_local.c,
	mailbox_local.h, mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c:
	save and restore sorted and threaded view.

2005-12-23 22:02  PeterB

	* libbalsa/address-book.c, src/balsa-mime-widget-callbacks.c,
	src/print.c: harmonize strings.
	* src/balsa-message.c, libbalsa/identity.c, libbalsa/misc.c,
	libbalsa/send.c, src/sendmsg-window.c: fix strings (Mişu Moldovan)
	and comment them (Jean-Luc Coulon).

2005-12-19 07:22  PeterB

	* src/balsa-mime-widget.c: lock a GMimeStream.

2005-12-18  Pawel Salek

	* libbalsa/mailbox_imap.c(find_duplicates): do not send UID=0.
	* libalsa/mailbox.c: attempting to expunge read-only mboxes would
	be a waste of time.

2005-12-15  Pawel Salek

	* libbalsa/send.c: use proper time zone in Date: (bug 323871).
	* src/balsa-index.c: disconnect "selection-changed" handler
	explicitely - do not trash on mbox close with gtk2-2.8.9.

2005-12-13 08:03  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: fix bug 323871; clean
	up undo/redo.

2005-12-11 18:14  PeterB

	* src/mailbox-conf.c: use new api for
	libbalsa_mailbox_local_set_path.
	* libbalsa/: mailbox_maildir.c, mailbox_maildir.h, mailbox_mbox.c,
	mailbox_mbox.h, mailbox_mh.c, mailbox_mh.h: implement check-files
	and set-path methods; simplify new and get-message methods;
	fixes bug 323448.
	* libbalsa/: mailbox_local.c, mailbox_local.h: new class methods
	check-files and set-path; change api for
	libbalsa_Mailbox_local_set_path.
	* libbalsa/: mailbox_local.c, mailbox_mh.c, mailbox_mh.h,
	message.c: fix bug 323448.
	* src/: toolbar-factory.h, toolbar-prefs.h: remove some obsolete
	defines and replace some others with an enum.

2005-12-09  Jens Granseuer

	* src/sendmsg-window.c: compile with gcc-2.95 (bug 323617).
	* libbalsa/send.c: compile --without-smtp (bug 323618).
	* src/sendmsg-window.c: compile --without-gtkspell (PS).
	
2005-12-08 07:43  PeterB

	* src/: save-restore.c, sendmsg-window.c: remember spell-check
	state when using GtkSpell (Marcin Deranek, bug 323458).
	* src/pref-manager.c: no spell-check options when using GtkSpell.
	* src/: balsa-app.c, balsa-app.h: spell-check members are
	conditional on HAVE_GTKSPELL.

2005-12-07  Pawel Salek

	* libbalsa/identity.c: fix a warning with gcc-3.4.x
	* libbalsa/mailbox_imap.c: use proper arguments to the
	server-changed signal, fixing a possible crash on server settings'
	update.

2005-12-07 13:35  PeterB

	* src/filter-run-callbacks.c: fix bug 323442.

2005-12-04 Pawel Salek

	* NEWS: release 2.3.7.

2005-12-03 Pawel Salek

	* balsa.spec.in: require gmime-2.1.17.
	* libbalsa/{imap-,smtp-,}server.c: clean up saving the config,
	enable anonymous access.
	* libbalsa/server.h: add try_anonymous field and config-changed
	signal.
	* libbalsa/mailbox_imap.c: ditto.
	* libbalsa/imap/imap-handle.[hc]: respect name space.
	* src/balsa-app.c: respect "remember password" checkbox in the
	password dialog.
	* src/balsa-index.c: remove redundant scroll_to_cell() call.
	* src/{folder,mailbox}-conf.c: config anonymous access.
	* src/mailbox-node.c: listen to "config-changed" signal.
	* src/save-restore.c: the same.
	* doc/C/balsa.xml: document anonymous access.

2005-11-28 15:19  PeterB

	* src/balsa-message.c, src/sendmsg-window.c, libbalsa/filter.c,
	libbalsa/mailbox_local.c, libbalsa/message.c, libbalsa/message.h,
	libbalsa/send.c: implement and use accessors for user-headers.

2005-11-27 08:34  PeterB

	* libbalsa/identity.c: GtkFileChooserButton requires gtk version
	2.6.

2005-11-26 16:35  PeterB

	* libbalsa/mailbox_mbox.c: don't leak message.
	* libbalsa/mailbox_pop3.c: adjust total size for skipped messages.

2005-11-26 Pawel Salek

	* libbalsa/identity.c: add missing #include "misc.h"
	* libbalsa/mailbox_pop3.c: handle procmail-filtered messages.
	* src/main-window.[hc]: fix a regression: set right default view
	filter for sentbox.
	* src/balsa-index.c:
	* src/balsa-mblist.c: ditto.

2005-11-19 08:47  PeterB

	* src/balsa-index.c: don't scroll back to current message after
	mailbox changes.
	* src/sendmsg-window.c: create Face or X-Face user header from path
	in identity.
	* src/balsa-message.c: display face from Face or X-Face header.
	* libbalsa/send.c: use user-headers correctly.
	* libbalsa/: misc.c, misc.h: new public methods
	libbalsa_get_image_from_{,x_}face_header and a corresponding GError
	domain.
	* libbalsa/: identity.c, identity.h: port signature-path to
	GtkFileChooserButton; add Face and X-Face header file paths; change
	some prototypes to reduce dynamic casting.
	* configure.in: new configure option --with-compface=no.
	* acinclude.m4: stop some autotool whining.

2005-11-09 19:11  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_imap.c,
	mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c, mailbox_pop3.c,
	message.c, message.h, send.c: change LibBalsaMailbox add-message
	method to take a GMimeStream and LibBalsaMessageFlag instead of a
	message; move libbalsa_mailbox_copy_message to message.c and rename
	libbalsa_message_copy; use new add-message method in mailbox-pop3.

2005-11-06 21:15 Pawel Salek

	* libbalsa/mailbox_pop3.c: use Mh temporary mailbox until an
	add_message_from_stream() method is implemented.

2005-11-06 13:42  PeterB

	* libbalsa/mailbox_mh.c: implement load-config method; use
	g_mkstemp to make temporary files; sync mailbox even if
	.mh_sequences doesn't exist.
	* libbalsa/mailbox_pop3.c: use g_file_open_tmp to open the temp
	file.

2005-11-06 Pawel Salek

	* libbalsa/mailbox_pop3.c: last commit broke direct Pop delivery -
	fix it.
	* src/sendmsg-window.c: fix compilation without GtkSpell.
	* Makefile.am: make variables must start in the first column.

2005-11-05 17:15  PeterB

	* src/Makefile.am: define balsa_gtkspell_extra_dist before using
	it.
	* configure.in, src/Makefile.am, src/sendmsg-window.c,
	src/sendmsg-window.h, src/toolbar-factory.c: new configure option
	--with-gtkspell, default = no.
	* src/main-window.c: don't clip close-button icon.

2005-11-04 18:53  PeterB

	* configure.in: gtkhtml3 has yet another version: 3.8.

2005-11-02 Pawel Salek

	* libbalsa/mailbox_pop3.c: no need to update config; fix memory leaks.
	* src/save-restore.c: "config-updated" signal does not exist any more.

2005-10-30 07:54  PeterB

	* src/sendmsg-window.c: do not mark forwarded message as answered.

2005-10-29 Pawel Salek

	* src/main-window.[ch]: iron out problems with the last patch
	* src/balsa-index.c:    and switching between different mboxes.

2005-10-29 Pawel Salek

	* libbalsa/mailbox_imap.c: last commit could trigger recursive
	searches under certain circumstances. Do it differently.
	* libbalsa/mailbox.c: more information about move errors.
	* libbalsa/imap/imap-auth.c: AUTH={PLAIN,ANONYMOUS} implemented.
	* libbalsa/imap/imap-handle.[hc]: anon support.
	* libbalsa/imap/imap-search.c: fix a bug in searching.
	* libbalsa/imap/imap_private.h: add enable_anonymous and
	enable_binary fields.
	* libbalsa/imap/pop3.c: minor cleanup.
	* src/balsa-index.[hc]: extend SoS filter.
	* src/main-window.[hc]: related changes.

2005-10-28 Pawel Salek

	* libbalsa/mailbox_imap.c: fix unread msg counts on concurrent mbox
	access.

2005-10-28 06:37  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: use separate members
	for the message we're replying to, and the draft message we saved.
	* libbalsa/mailbox_local.c: reverse a loop.
	* libbalsa/mailbox_mbox.c: look for appended messages in the
	correct place; always save the from-offset as the start of the
	message.

2005-10-27 17:56  PeterB

	* src/save-restore.c: set filters-trash-mbox.

2005-10-23 Pawel Salek

	* NEWS, configure.in: release 2.3.6

2005-10-19 Pawel Salek

	* libbalsa/imap/imap-tls.c: be compatible with openssl-0.9.8.
	* libbalsa/libbalsa-conf.c: fix memory leaks.

2005-10-14 06:53  PeterB

	* libbalsa/mailbox.c: check for NULL user-data.

2005-10-10 Pawel Salek

	* libbalsa/imap-server.c: distinguish between failed and cancelled
	authentication.
	* libbalsa/libbalsa.h: add cancelled authentication error code.
	* libbalsa/mailbox_imap.c: handle better errors in ::add_message.
	* libbalsa/imap/imap-auth.c, auth-{cram,gssapi}.c: cancelled vs failed.
	* libbalsa/imap/libimap.h: add apriopriate error code.
	* src/balsa-index.c: do not retry if the authentication was cancelled.
	* src/sendmsg-window.c:
	* src/spell-check.c: parent properly spell checking error messages.

2005-10-07 11:25  PeterB

	* libbalsa/libbalsa-conf.c: fix bug 318171.
	* src/: filter-edit-callbacks.c, save-restore.c: improve language,
	per Craig Routledge.

2005-10-06 19:22  PeterB

	* libbalsa/mailbox.c: sanity check.
	* src/: filter-edit-callbacks.c, filter-edit-dialog.c: fix various
	sensitivity problems, including one that blocked deleting the last
	filter.

2005-09-29 13:01  PeterB

	* libbalsa/body.c, libbalsa/body.h, libbalsa/misc.c,
	libbalsa/misc.h, src/balsa-message.c,
	src/balsa-mime-widget-callbacks.c, src/sendmsg-window.c: fix bug
	317240: use mode 0666 to save attachments.

2005-09-28 23:06  PeterB

	* doc/C/balsa.xml: update identities doc.
	* doc/C/balsa.xml: document per-identity SMTP server and message
	splitting.

2005-09-27 20:31  PeterB

	* src/: balsa-message.c, main-window.c: move BalsaMessage show/hide
	to balsa-message.c; fix a startup visual glitch.
	* src/main-window.c: hide irrelevant scrollbar--thanks to Sebastian
	Zerbe.
	* libbalsa/mailbox_mbox.c: write separating newline before
	appending new message, not after.
	* libinit_balsa/balsa-druid-page-directory.c: manage
	LibBalsaMailbox::no_reassemble.
	* src/mailbox-node.c, src/save-restore.c, libbalsa/mailbox.c:
	manage and use LibBalsaMailbox::no_reassemble; check for a
	message/partial part that has been wrapped in a multipart/*
	message.
	* libbalsa/mailbox.h: new member LibBalsaMailbox::no_reassemble,
	used to distinguish outbox.
	* libbalsa/rfc3156.c: check that a GMimeMultipartSigned has both
	its subparts.

2005-09-22 10:28  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: update parent style when child is
	read.
	* libbalsa/body.c: allow saving non-GMimePart message parts.

2005-09-20 23:05  PeterB

	* libbalsa/: mailbox.c, mailbox_mbox.c, send.c: implement message
	fragmentation and reconstruction using "message/partial" mime type.
	* libbalsa/: smtp-server.c, smtp-server.h: add guint
	LibBalsaSmtpServer::big_message and manage it in the dialog.

2005-09-20 Pawel Salek

	* libbalsa/imap/imap-handle.c: handle lack of headers.
	* NEWS, configure.in: release 2.3.5

2005-09-15 10:12  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_mbox.c: fix unthreaded
	build.

2005-09-14  Craig Routledge

	* doc/C/balsa.xml: update compose window file attaching doc.

2005-09-13 Pawel Salek

	* libbalsa/mailbox_imap.c: return correctly TRUE/FALSE on success.
	* src/spell-check.c: unavailable word list is a critical error.

2005-09-13 09:36  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_mbox.c: implement
	lock_store class method and public functions.
	* src/balsa-index.c, libbalsa/body.c,
	libbalsa/gmime-part-rfc2440.c, libbalsa/html.c, libbalsa/message.c,
	mailbox_imap.c, mailbox_maildir.c, mailbox_mh.c,
	libbalsa/rfc3156.c, libbalsa/send.c, libbalsa/source-viewer.c,
	src/balsa-message.c: lock the mail store instead of a GMimeStream,
	to avoid unnecessary IMAP fetches.

2005-09-11  Carlos Morgado  <chbm gnome.org>

	* po (Module): update for stats

2005-09-06 Pawel Salek

	* configure.in: SuSE changes broke FC. Negotiate a common solution.

2005-09-05 Pawel Salek

	* configure.in: merge SuSE kerberos path fixes.
	* libbalsa/body.[hc]: provide more info on error in save(),
	save_fd(), save_temporary(), get_content() and get_stream().
	* libbalsa/libbalsa.h: add MAILBOX_ACCESS_ERROR code.
	* libbalsa/mailbox.[ch]: get_message_part() sets GError.
	* libbalsa/mailbox_{imap,local}.c: modify implementation accordingly.
	* libbalsa/{message,mime}.c: adjust to changed API.
	* src/balsa-message.c: ditto.
	* src/balsa-mime-widget-{callbacks,message,text}.c: 
	* src/balsa-mime-widget.c: ditto.
	* src/print.c: 
	* src/sendmsg-window.c: ditto when forwarding message.

2005-09-01 11:04  PeterB

	* src/pref-manager.c: connect file-chooser signal in an idle
	handler, after the chooser is initialized; test whether user
	changed window-layout; update toolbars if necessary.

2005-08-28 11:29  PeterB

	* src/balsa-index.c: simpler fix.
	* src/balsa-index.c: redisplay current message if filtering cleared
	it.

2005-08-25 19:55  PeterB

	* src/pref-manager.c: fix spacing.

2005-08-25 Pawel Salek

	* configure.in: support selection of the preferred GtkHtml widget.
	* README: matching description.
	* libbalsa/address-book-ldap.[ch]: support arbitrary locations of
	the private address book.
	* libbalsa/send.c: handle informatively errors of DATA command.
	* src/ab-window.c: fix reload action.
	* src/address-book-config.c: support extended LDAP config.
	* src/balsa-index.c: "Run" is the default action of "Pipe through"
	
2005-08-22 07:46  PeterB

	* doc/C/balsa.xml: cleanup.
	* src/toolbar-factory.c: set button label and tooltip
	appropriately.

2005-08-21  Jens Seidel  <jseidel@cvs.gnome.org>

	* src/filter-export-callbacks.c:
	* macros/gnome-bonobo-check.m4:
	* libbalsa/mailbox_mbox.c: Fixed the typo "occured"
	(also in all effected PO files to avoid fuzzyness)

2005-08-21 09:04  PeterB

	* doc/C/: balsa.xml, figures/message-window.png,
	figures/msg-part-select.png: message window documentation
	contributed by Craig Routledge <webstuff at craigroutledge dot
	cm,dom>; fix "unmatched element" warnings.

2005-08-17 19:03  PeterB

	* src/balsa-app.c: free filters after destroying mailboxes (fixes a
	crash-on-exit).

2005-08-04 14:14  PeterB

	* src/filter-run-callbacks.c, src/filter-run-dialog.c,
	src/filter-run.h, doc/C/balsa.xml: use separate "apply" buttons for
	selected available filters and for mailbox filters.

2005-08-01 09:35  PeterB

	* src/sendmsg-window.c: better fix for bug 312105; plug memory
	leak.

2005-07-31 22:26  PeterB

	* src/sendmsg-window.c: fix bug 312105.
	* src/sendmsg-window.c: fix bug 312091.

2005-07-29 09:52  PeterB

	* src/: balsa-mime-widget-text.c, sendmsg-window.c: fix some gcc
	nitpicking.

2005-07-27 18:54  PeterB

	* libbalsa/libbalsa-conf.c: use blank comment lines only to
	separate groups.
	* libbalsa/gmime-gpgme-context.c: compile with -D_FORTIFY_SOURCE=2.

2005-07-24  Carlos Morgado  <chbm chbm.net>

	* libbalsa/rfc3156.c: fix FC4 build

2005-07-24 09:03  PeterB

	* configure.in, src/save-restore.c, src/threads.h,
	libbalsa/address-book-extern.c, libbalsa/libbalsa.c,
	libbalsa/mailbox_imap.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, libbalsa/send.c, libbalsa/send.h,
	libbalsa/imap/imap-commands.c, libbalsa/imap/imap-handle.c: compile
	with -D_FORTIFY_SOURCE=2.
	* src/balsa-mime-widget-message.c: do not create separate Fcc
	header.
	* libbalsa/message.c: make a single References user-header.
	* libbalsa/abook-completion.c: match quoted names and
	angle-bracketed mailboxes.

2005-07-23  Pawan Chitrakar  <pawan@nplinux.org>

	* configure.in: Added ne in ALL_LINGUAS

2005-07-18 08:04  PeterB

	* src/sendmsg-window.c: make References header according to RFC
	2822.

2005-07-15 10:53  PeterB

	* src/sendmsg-window.c: replace CR and LF in subject header with
	spaces.

2005-07-12 13:32  PeterB

	* src/save-restore.c: fix typo; clean up old filters correctly.
	* src/filter-edit-dialog.c: set button sensitivity when filter name
	is changed.
	* libbalsa/: libbalsa-conf.c, libbalsa-conf.h: use default GKeyFile
	list separator; implement libbalsa_conf_get_vector_with_default
	directly instead of as a macro.

2005-07-11 12:32  PeterB

	* src/store-address.c: use balsa_information instead of writing in
	appbar.
	* src/spell-check.c: use values from correct enum.
	* src/mailbox-node.c: use consistent return sequence.
	* src/: filter-edit-callbacks.c, filter-edit-dialog.c,
	filter-edit.h: use a single field-frame.

2005-07-09 23:33  PeterB

	* src/information-dialog.c: use only single-line messages in status
	bar.

2005-07-08 Pawel Salek

	* configure.in: -Wdeclare-after-statement is gcc>=4.0 specific.

2005-07-07 23:27  PeterB

	* src/balsa-index.c: lock a GMimeStream.
	* src/: save-restore.c, save-restore.h: export
	config_address_books_load.
	* src/mailbox-node.c: downgrade scanning problem from error to
	warning.
	* src/balsa-app.c: clean up.
	* src/address-book-config.c: no need to include address-book-gpe.h.
	* src/: ab-window.c, ab-window.h: reimport all address books after
	editing.
	* src/ab-main.c: show default address book initially.
	* libbalsa/rfc3156.c, src/pref-manager.c, src/sendmsg-window.c:
	translate strings marked for translation.
	* libbalsa/: libbalsa.c, libbalsa.h: include address-book-gpe.h in
	libbalsa.h.
	* libbalsa/libbalsa-conf.c: detect external modification of config
	file.
	* configure.in: catch declaration-after-statement.

2005-07-06 Jens Granseuer

	* src/filter-run-callbacks.c: fix bug 309574.

2005-07-06 Pawel Salek

	* src/ab-window.c: use our address book editor.
	* NEWS, configure.in: release balsa-2.3.4.

2005-07-01 16:14  PeterB

	* libbalsa/mailbox_pop3.c: destroy LibBalsaMailboxView for POP
	temporary mailbox.

2005-07-01  Pawel Salek

	* libbalsa/imap/pop3.c: fix handling rejected POP3 TLS certs #308932.

2005-06-30 21:41  PeterB

	* libbalsa/imap/imap-commands.c: use more of the GString api.
	* src/address-book-config.c: make sure filename is shown for
	LibBalsaAddressBookText.
	* src/ab-main.c: show address book type in window title; implement
	File->delete.
	* libbalsa/address-book-text.c: invalidate time stamp when we
	change the address book.
	* libbalsa/address-book-ldif.c: ensure blank line before new entry.
	* src/main-window.c: make progress bar faster than a snail.
	* libbalsa/libbalsa-conf.c: use g_file_set_contents to rewrite
	config files.

2005-06-24 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/body.[hc]: implement libbalsa_message_body_protect_state().
	* src/Makefile.am: add 7+7 balsa-mime-widget source files.
	* src/balsa-message.[ch]: use the cleaner design from balsa-mime-widget.

2005-06-22  Pawel Salek

	* libbalsa/mailbox_imap.c: fix date searching when only upper
	limit is present.
	* libbalsa/mailbox_pop3.c: fix memory leak.
	* libbalsa/imap/imap-search.c: date::range must be signed.
	* src/filter-edit-callbacks.c: clean up filter dialog.
	* src/filter-run-{callbacks,dialog}.c: fix "run filters".
	* src/filter-run.h: add fr_apply_pressed() prototype.

2005-06-17 08:31  PeterB

	* libbalsa/address-book-vcard.c, libbalsa/address.c,
	src/Makefile.am, src/ab-main.c, src/address-book-config.c,
	src/address-book-config.h: implement File->New and File->Properties
	in balsa-ab.

2005-06-16  Pawel Salek

	* libbalsa/imap/auth-gssapi.c: 6th parameter to gss_{un,}wrap is int*.

2005-06-14 12:48  PeterB

	* src/sendmsg-window.c: clear BalsaSendmsg::in_reply_to.
	* src/sendmsg-window.h: omitted from yesterday's commit.

2005-06-13 23:59  PeterB

	* src/sendmsg-window.c: create in-reply-to string when we begin a
	reply, so we can save and restore it without reference to the
	original message.
	* src/: balsa-message.c, information-dialog.c: use
	GTK_WRAP_WORD_CHAR instead of GTK_WRAP_WORD, to allow wrapping of
	long words.
	* libbalsa/misc.c: trim trailing whitespace beyond the wrap length.
	* src/balsa-app.h: use only Monospace and Sans as default fonts.

2005-06-11  Pawel Salek

	* libbalsa/imap/imap-handle.c: fix trivial bug introduced yesterday.

2005-06-10  Pawel Salek

	* libbalsa/mailbox_imap.c: survive better cases
	when number of messages changed in the broken connection. Resync
	header caches more aggresively.
	* libbalsa/imap/imap-commands.c: use UID search support.
	* libbalsa/imap/imap-handle.h: allow searching ranges of messages.
	* libbalsa/imap/imap-handle.c: never insert cmd==0 to response queue.
	* libbalsa/imap/imap-search.c: implement it.
	* src/ab-window.c: Fix "No-address-book" case (bug 158939).
	* src/main-window.[hc]: ditto.
	* src/pref-manager.c: ditto.

2005-06-08 Andrew Lau

	* libbalsa/address-book-ldap.c: include "i18n.h".

2005-06-08 14:13  PeterB

	* src/balsa-message.c, src/print.c, src/sendmsg-window.c,
	libbalsa/libbalsa.c, libbalsa/libbalsa.h, libbalsa/mailbox.c,
	libbalsa/message.h: rename libbalsa_date_to_gchar as
	libbalsa_date_to_utf8, and return a UTF-8 string.
	* src/ab-main.c: reuse edit widget for smoother update; reload
	address book after changing it.
	* src/address-book-config.c: use new LibBalsaAddressBook subclass
	structure.
	* libbalsa/Makefile.am: add dependencies.
	* libbalsa/: address.c, address.h: use an editable GtkTreeView to
	edit email addresses; implement libbalsa_address_set_edit_entries
	to reuse an edit widget.
	* libbalsa/: address-book-ldif.c, address-book-ldif.h,
	address-book-text.c, address-book-text.h, address-book-vcard.c,
	address-book-vcard.h, address-book.c, address-book.h: new class
	LibBalsaAddressBookText, subclass of LibBalsaAddressBook, with
	LibBalsaAddressBook{Ldif,Vcard} as subclasses.

2005-06-07 11:56  PeterB

	* libbalsa/: rfc3156.c, gmime-part-rfc2440.c: lock GMimeStreams.

2005-06-06  Pawel Salek

	* libbalsa/gmime-gpgme-signature.c: check gpgme_get_key() result.
	* libbalsa/libbalsa.c: fix bug 306666.
	* libbalsa/send.c: allow the user to check certificates w/o threads.
	* src/main-window.c: mbnode->name can be NULL - do not use it
	and perhaps fix 306636.
	* NEWS: update for real 2.3.3 release this time.

2005-06-05  Pawel Salek

	* libbalsa/mailbox_imap.c: Peter found one more fault in imap scanning.
	* NEWS, configure.in: update for release 2.3.3

2005-06-04  Pawel Salek

	* balsa.spec.in: extend list of dependencies.
	* libbalsa/folder-scanners.c: flags are passed by value.
	* libbalsa/imap/auth-gssapi.c: continue authentication on invalid key.
	* libbalsa/imap/imap-handle.c: pass flags by value - address was
	truncated by the marshaller on 64-bit machines.

2005-06-01 20:54  PeterB

	* libbalsa/message.c: lock a GMimeStream.

2005-05-28 23:12  PeterB

	* libbalsa/libbalsa.c: look for /var/mail/$USER before
	/var/spool/mail/$USER: fixes bug 305659.
	* src/mailbox-node.c: make popup menu more appropriate: fixes
	bug 305668.

2005-05-26 16:13  PeterB

	* src/ab-main.c: make radio list work; set window title to be
	address book name.
	* libbalsa/source-viewer.c: lock a GMimeStream.

2005-05-24 09:09  PeterB

	* libbalsa/gmime-part-rfc2440.c: lock a GMimeStream.

2005-05-24 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/gmime-gpgme-signature.c: fix the signature verification
	output.
	* src/balsa-message.c: check the result of
	libbalsa_mailbox_get_message_part().
	* balsa.spec.in: clean up and fedora extras adaptation.

2005-05-23 19:36  PeterB

	* configure.in, libbalsa/address-book-gpe.c,
	libbalsa/address-book-gpe.h, src/address-book-config.c: support
	SQLite Version 3--fixes bug 305152.
	* libbalsa/libbalsa-conf.c: compile on systems where gsize !=
	guint.

2005-05-22 17:11  PeterB

	* libbalsa/: Makefile.am, body.c, gmime-part-rfc2440.c, html.c,
	mailbox_imap.c, mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c,
	message.c, mime-stream-shared.c, mime-stream-shared.h, rfc3156.c,
	send.c: implement LibBalsaMimeStreamShared, a subclass of
	GMimeStreamFs with a lock; use it in LibBalsaMailboxMbox in place
	of the fine-grained mailbox lock.

2005-05-21  Pawel Salek

	* libbalsa/mailbox_imap.c: get properly signed parts.
	* src/balsa-message.c: do not reset status of a checked sig.

2005-05-21 09:41  PeterB

	* src/save-restore.c: save message counts only when they are
	time-stamped.

2005-05-20 23:56  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h,
	libbalsa/mailbox_maildir.c, libbalsa/mailbox_maildir.h,
	libbalsa/mailbox_mbox.c, libbalsa/mailbox_mh.c,
	libbalsa/mailbox_mh.h, src/save-restore.c: save and restore
	mod_time for local mailboxes.

2005-05-12 18:08  PeterB

	* libbalsa/mailbox_mbox.c: use light-weight parser at get-message
	time.
	* src/save-restore.c: really remove unused mailbox views.
	* libbalsa/address-book-extern.c: fix last part of bug 155382.

2005-05-09 08:32  PeterB

	* src/balsa-index.c: non-modal pipe-message dialog.

2005-05-07  Pawel Salek

	* libbalsa/libbalsa{,-conf}.c: disable debugging output.
	* NEWS, configure.in: release 2.3.2

2005-05-07  Pawel Salek

	* balsa.1.in: merge patch in DBTS #269787, bugzilla 303422.
	* libbalsa/address-book-extern.c: fix DBTS#306556, bugzilla 303421.
	* libbalsa/address-book-gpe.c: remove duplicates from the returned list.
	* src/ab-window.c: select initially displayed list in the combo.
	* src/address-book-config.c: fix bad_path() for gtk < 2.6.0.
	* src/pref-manager.c: Display type of extern address book.
	* src/balsa-app.c: do not crash when non-existing mailbox specified with -o.
	* src/balsa-mblist.c: fix -u command line option.
	* src/main.c: ditto + fix -a when passing it via bonobo.

2005-05-06 23:19  PeterB

	* src/save-restore.c: slightly more 2.0.x compatibility.
	* libbalsa/mailbox_mbox.c: use a separate pthread_mutex_t for
	lbm_mbox_mime_stream_lock().
	* src/: filter-edit-callbacks.c, filter-edit-dialog.c,
	filter-edit.h: manage button sensitivity better.

2005-05-06  Pawel Salek

	* src/mailbox-conf.c: do not attempt opening closed mailboxes just
	because their configuration is about to get changed.
	* src/save-restore.c: s,sa --learn,sa-learn --spam,g.

2005-05-04  Pawel Salek

	* libbalsa/imap/imap-handle.c: nail down the broken IDLE connection
	problem.

2005-05-03 22:43  PeterB

	* src/: balsa-app.h, balsa-index.c, balsa-index.h, main-window.c,
	save-restore.c: add a drop-down list of most recently used pipe
	commands; pipe all selected messages through command.
	* libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_maildir.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, libbalsa/message.c, libbalsa/message.h,
	libbalsa/send.c, libbalsa/source-viewer.c, src/main-window.c:
	replace message argument of libbalsa_mailbox_get_message_stream with
	msgno; implement and use libbalsa_message_stream(LibBalsaMessage *
	message).

2005-05-02 23:58  PeterB

	* libinit_balsa/balsa-druid-page-user.c: fix bug 302782.

2005-05-02  Pawel Salek

	* NEWS, configure.in: release 2.3.1.
	* libbalsa/mailbox_imap.c: handle empty msg-id over imap right.

2005-05-01  Pawel Salek

	* libbalsa/mailbox_imap.c: implement remove-duplicates for imap too.
	* libbalsa/imap/imap-commands.c: FetchBodyCb callbacks get seqno now.
	* libbalsa/imap/imap-commands.h: add imap_mbox_complete_msgids.
	* libbalsa/imap/imap-handle.c: handle arbitrary header fetches.

2005-04-30 19:57  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_local.c,
	src/main-window.c: restore remove-duplicates functionality.

2005-04-28  Pawel Salek

	* libbalsa/folder-scanners.c: don't break with uw-imap server.

2005-04-27 20:17  PeterB

	* libbalsa/folder-scanners.c, libbalsa/folder-scanners.h,
	src/mailbox-node.c: simplify folder scanning.

2005-04-26 14:08  PeterB

	* libbalsa/identity.c, src/pref-manager.c: compile --without-esmtp
	and --without-gpgme.

2005-04-21  Pawel Salek

	* libbalsa/folder-scanners.c: block list-response when asking
	for a delimiter.
	* libbalsa/imap-server.[ch]: allow checking for new mail with STATUS.
	* libbalsa/smtp-server.c: keep old behavior and always save passwd.
	* libbalsa/imap/imap-commands.[ch]: implement imap_mbox_status().
	* libbalsa/imap/imap-handle.c: handle its response.
	* libbalsa/imap/imap_private.h: even for several issued in parallel.
	* src/folder-conf.c: configure it.

2005-04-20 21:26  PeterB

	* src/sendmsg-window.c: simplify setting identity.
	* libbalsa/imap-server.c, libbalsa/mailbox_pop3.c,
	libbalsa/server.c, libbalsa/server.h, libbalsa/smtp-server.c,
	src/folder-conf.c, src/pref-manager.c: lose LibBalsaServer::type.
	* libbalsa/mailbox.c, libbalsa/mailbox.h,
	libbalsa/mailbox_maildir.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, src/balsa-mblist.c, src/save-restore.c: add
	unread and total members to LibBalsaMailboxView, and save them in
	the config file.
	* libbalsa/libbalsa-conf.c: preserve blank lines between sections
	in the config file.

2005-04-19  Pawel Salek

	* libbalsa/folder-scanners.[hc]: avoid redundant queries for IMAP
	hierarchy delimiters.
	* src/mailbox-node.[ch]: ... because we store earlier answers.

2005-04-18  Pawel Salek

	* libbalsa/imap/imap-handle.c: silence output on the terminal.
	* src/balsa-icons.c: silence icon debugging.
	* src/sendmsg-window.c: specify exactly file names in messages -
	important when attaching multiple messages at once.

2005-04-17 10:57  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_local.c: don't keep
	selected message displayed when changing view filter.

2005-04-16 22:37  PeterB

	* src/save-restore.c, libbalsa/identity.c: compile with gpgme but
	without libesmtp.
	* src/pref-manager.c: append server to balsa_app.smtp_servers when
	the user OKs it.

2005-04-16 20:23  Pawel Salek

	* libbalsa/identity.[ch]: compile --without-gpgme
	* libbalsa/imap/imap-handle.c: survive better broken connections.
	* src/mailbox-conf.c: generate shorter identity names.
	* src/save-restore.c: more robust smtp server config loading.

2005-04-16 08:01  PeterB

	* libbalsa/i18n.h: comment that this header must be included last.
	* libbalsa/smtp-server.c: include "i18n.h" last.

2005-04-15 17:28  PeterB

	* libbalsa/Makefile.am, libbalsa/identity.c, libbalsa/identity.h,
	libbalsa/libbalsa.h, libbalsa/message.c, libbalsa/send.c,
	libbalsa/send.h, libbalsa/server.h, libbalsa/smtp-server.c,
	libbalsa/smtp-server.h, libinit_balsa/balsa-druid-page-user.c,
	src/balsa-app.c, src/balsa-app.h, src/balsa-message.c,
	src/main-window.c, src/pref-manager.c, src/save-restore.c,
	src/sendmsg-window.c: implement LibBalsaSmtpServer; use it for
	per-identity server.

2005-04-12 12:31  PeterB

	* libbalsa/html.c: convert charset more carefully.

2005-04-10 20:28  PeterB

	* libbalsa/mailbox_maildir.c: do not overwrite message when
	renaming.
	* libbalsa/mailbox_maildir.c: remember correct file name.

2005-04-08 14:30  PeterB

	* src/save-restore.c: use correct filter group name; remove filter
	groups with malformed names.

2005-04-07 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/balsa-message.c: save multiple parts.

2005-04-07 11:18  PeterB

	* src/sendmsg-window.c: check for NULL charset.

2005-04-06 16:45  PeterB

	* libbalsa/body.c: ensure stream is a filter-stream.

2005-04-05 20:36  PeterB

	* src/sendmsg-window.c, src/sendmsg-window.h, libbalsa/filter.c,
	libbalsa/mailbox_local.c, libbalsa/mime.c, libbalsa/mime.h: yet
	another shot at finding the best charset in the compose window.
	* src/sendmsg-window.c: destroy file-chooser dialogs with
	their parent.

2005-04-05 Pawel Salek

	* libbalsa/imap/imap-handle.c: proper types for list-response
	signal handlers.
	* libbalsa/imap/libimap-marshal.list: ditto.
	* libbalsa/imap/imap-search.c: compile on darwin.
	
2005-04-03 Pawel Salek

	* Makefile.am: s,m4,macros,g;
	* balsa.spec.in: compile on suse.
	* configure.in:
	* libbalsa/imap/auth-gssapi.c: compile against heimdal.

2005-04-01  Steve Murphy  <murf@e-tools.com>

        * configure.in: Added "rw" to ALL_LINGUAS.

2005-04-01 18:46  PeterB

	* src/sendmsg-window.c: omit all identity addresses from cc header.
	* src/balsa-message.c, src/print.c, libbalsa/body.c,
	libbalsa/html.c, libbalsa/html.h: move charset conversion for html
	parts to libbalsa/html.c, as it's handled differently by the two
	widgets.

2005-03-31 19:58  PeterB

	* src/sendmsg-window.c: remember folder when including file in
	message content.

2005-03-30 19:45  PeterB

	* src/balsa-message.c: fix bug 172145.

2005-03-29 21:16  PeterB

	* src/balsa-message.c: fix bug 172005.
	* libbalsa/rfc3156.c: pass NULL to g_locale_to_utf8 instead of
	(ssize_t *), to keep gcc4 quiet.
	* src/: balsa-message.c, sendmsg-window.c: use glib macros to cast
	int to pointer and back.

2005-03-26 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/rfc3156.c: plug in recently introduced DoS.

2005-03-24 06:59  PeterB

	* src/ab-main.c: set all locales.
	* src/main.c: set all locales.
	* src/main-window.c: make label localizable.

2005-03-24 Pawel Salek

	* libbalsa/address-book-ldap.c: add missing libbalsa-conf.h
	* balsa.spec.in: update icon cache after rpm installation.
	* images/Makefile.am: bug 171388.

2005-03-23 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/balsa-message.c, libbalsa/gmime-gpgme-context.c,
	libbalsa/gmime-gpgme-context.h, libbalsa/identity.c,
	libbalsa/identity.h, libbalsa/rfc3156.c, libbalsa/rfc3156.h,
	libbalsa/send.c: (1) plug a minor security problem when checking
	the gpg subkey status; (2) improve dealing with low-validity uid's
	for encryption; (3) several smaller fixes.

2005-03-23 PeterB

	* libbalsa/rfc3156.c: fix bug 171415.
	* libbalsa/address-book-ldap.c, src/ab-main.c: complete migration
	from GnomeConfig to LibbalsaConf.
	* src/sendmsg-window.c: strip parameter variables from exec string.

2005-03-22 22:07  PeterB

	* libbalsa/: libbalsa-conf.c, libbalsa-conf.h: set up correctly for
	new user.
	* libbalsa/libbalsa-conf.c: more careful rewrite, more user
	feedback.
	* src/main.c: set balsa_icon.png as default window icon.
	* src/: balsa-message.c, sendmsg-window.c: always pass URI to
	gnome_vfs_mime_application_launch.
	* src/sendmsg-window.c: more appropriate version checks.
	* libbalsa/libbalsa-conf.c: organize key-file info into structures.

2005-03-21 08:08  PeterB

	* configure.in, src/balsa-message.c, src/sendmsg-window.c: check
	for GnomeVFS version 2.9 instead of 2.8.

2005-03-20 15:03  PeterB

	* libbalsa/libbalsa-conf.c: initialize only once in non-threaded
	build.
	* libbalsa/libbalsa-conf.c: store new config files in ~/.balsa.
	* configure.in, libbalsa/misc.c, libbalsa/misc.h,
	src/balsa-message.c, src/sendmsg-window.c: more appropriate version
	checks.

2005-03-20 Pawel Salek

	* src/address-book-config.c: s,GNOME_DISABLE_DEPR,GTK_DISABLE_DEPR,

2005-03-19 23:00  PeterB

	* libbalsa/libbalsa-conf.h: check Gtk version.
	* libbalsa/Makefile.am, libbalsa/address-book-ldif.c,
	libbalsa/address-book.c, libbalsa/body.c, libbalsa/files.c,
	libbalsa/filter-file.c, libbalsa/filter.h,
	libbalsa/folder-scanners.c, libbalsa/gmime-part-rfc2440.c,
	libbalsa/html.c, libbalsa/identity.c, libbalsa/libbalsa-conf.c,
	libbalsa/libbalsa-conf.h, libbalsa/libbalsa.c,
	libbalsa/mailbox-filter.c, libbalsa/mailbox.c, libbalsa/mailbox.h,
	libbalsa/mailbox_imap.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, libbalsa/message.c, libbalsa/misc.c,
	libbalsa/rfc3156.c, libbalsa/send.c, libbalsa/source-viewer.c,
	libbalsa/imap/imap-commands.c, libbalsa/imap/imap-commands.h,
	libbalsa/imap/md5-utils.c, libbalsa/imap/md5-utils.h,
	libbalsa/imap/util.c, libbalsa/imap/util.h,
	libinit_balsa/Makefile.am, src/Makefile.am, src/ab-main.c,
	src/balsa-message.c, src/filter-edit-callbacks.c,
	src/mailbox-node.c, src/print.c, src/quote-color.c,
	src/quote-color.h, src/save-restore.c, src/sendmsg-window.c: more
	Gnome deprecation cleanup, including a GKeyFile replacement for
	GnomeConfig; fix some nit-picking from gcc 4; restore the
	*_DISABLE_DEPRECATED defs.
	* src/sendmsg-window.c: check whether CP125x charset is ok.

2005-03-18 16:29  PeterB

	* src/main.c: get mbnode before checking it.

2005-03-17 Pawel Salek

	* libbalsa/imap/imap-handle.c: make the IDLE code behave better
	on broken connections.
	* src/balsa-app.h: add pipe_cmd field.
	* src/main-window.c: allow for piping a message through an
	external program. (bug 153386).
	* src/save-restore.c: save and restore last pipe_cmd.
	
2005-03-16 Pawel Salek

	* libbalsa/imap/imap-handle.c: provide more info on SSL-related
	failures.

2005-03-15 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/send.c: don't unref NULL GObject.

2005-03-15 13:03  PeterB

	* libbalsa/body.c: convert charset also for html parts (fixes
	bug 170456).
	* libbalsa/mailbox_imap.c: use delim to build path when renaming;
	use g_build_path() for IMAP paths.

2005-03-14 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/message.h, libbalsa/send.c, libbalsa/send.h,
	src/balsa-app.c, src/balsa-app.h, src/balsa-message.c,
	src/pref-manager.c, src/save-restore.c, src/sendmsg-window.c: use
	only quoted-printable encoding.

2005-03-14 19:42  PeterB

	* libbalsa/body.c: use string returned by
	g_mime_filter_windows_real_charset() before it's deallocated.

2005-03-10 10:42  PeterB

	* libbalsa/body.c, libbalsa/filter.c, libbalsa/mailbox_local.c,
	libbalsa/message.c, libbalsa/mime.c, libbalsa/mime.h,
	src/sendmsg-window.c, src/sendmsg-window.h: keep track of charset
	instead of using g_mime_charset_best().

2005-03-08 18:40 Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/gmime-part-rfc2440.c: replace use of
	g_mime_content_type_[gs]et_parameter() by
	g_mime_object_[gs]et_content_type_parameter(), and
	g_mime_part_get_content_type() by g_mime_object_get_content_type().

2005-03-08 10:43  PeterB

	* libbalsa/: mailbox.c, mailbox.h: remember that we loaded filters.
	* src/filter-edit-callbacks.c: don't set empty filename; comment
	out unused LIBESD condition.
	* libbalsa/Makefile.am, libbalsa/filter-file.c, libbalsa/filter.h,
	libbalsa/libbalsa-conf.c, libbalsa/libbalsa-conf.h,
	libbalsa/mailbox-filter.c, src/save-restore.c: move all
	GnomeConfigIterator code to (new) libbalsa-conf.c; implement
	GnomeConfig version of libbalsa_conf_foreach_section.

2005-03-04 19:56  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/gmime-part-rfc2440.c, src/balsa-message.c,
	src/balsa-message.h, src/sendmsg-window.c: add and evaluate the RFC
	2440 headers properly; write the stream to a new (plain) stream;
	rename libbalsa_msg_perform_crypto to balsa_message_perform_crypto,
	add a parameter to decrypt only and export the function; call
	balsa_message_perform_crypto() to fix the bug Kacper reported.

2005-03-03 20:07  PeterB

	* libbalsa/: mailbox_mbox.c, mailbox_mbox.h: implement
	lbm_mbox_mime_stream_{lock,unlock}; use them to avoid interruption
	of a sequence of GMimeStream operations.

2005-03-01 09:49  PeterB

	* src/sendmsg-window.c: make file choosers transient for compose
	window.

2005-02-28 09:09  PeterB

	* libbalsa/libbalsa.c, libbalsa/libbalsa.h, libbalsa/mailbox.c,
	src/main.c: move balsa_threads_{enter,leave} to
	libbalsa/libbalsa.c; change libbalsa_lock_mailbox to reflect
	recursive gdk lock and remove assumptions about
	main-thread/sub-thread; hold mailbox lock before asking for gdk
	lock.
	* libbalsa/imap/imap-handle.c: downgrade warnings to messages.
	* libbalsa/misc.c: fix test for "<URL:" [fixes Bug 168732].
	* src/balsa-index.c: mysterious adjustment to width of icon
	columns [fixes Bug 168733].

2005-02-27 14:35  PeterB

	* libbalsa/message.c, libbalsa/message.h, libbalsa/send.c,
	src/sendmsg-window.c, src/sendmsg-window.h: use
	g_mime_charset_best() to encode message content.
	* libbalsa/mailbox_local.c: get message when needed for matching
	(2 commits).
	* libbalsa/mailbox.c: check for zero message count before changing
	flags.

2005-02-25 11:29  PeterB

	* src/address-book-config.c: use correct Gtk response.

2005-02-24  Pawel Salek

	* src/pref-manager.c: compile with C89 (contributed by Jens Granseuer).

2005-02-23  Pawel Salek

	* NEWS: release 2.3.0
	* libbalsa/mailbox_local.c: fix one of the problems with msg filtering.

2005-02-22 19:53  PeterB

	* src/main-window.c: remove ctrl+F accelerator from forward-inline.

2005-02-20 Kacper Wysocki <kacperw at online dot no>

	* libbalsa/imap/pop3.c: const char *service should not be static.

2005-02-20  Pawel Salek

	* balsa.spec.in: icon-related updates.
	* libbalsa/imap/imap-commands.c: enable IDLE only when really disabled.
	* libinit_balsa/balsa-druid-page-user.c: do not require incoming server

2005-02-20 12:05  PeterB

	* src/: balsa-icons.h, balsa-index.c, main-window.c: remove
	BALSA_PIXMAP_MENU_* definitions.
	* src/balsa-message.c: make OK the default response in save dialog.

2005-02-20 Craig Routledge <webstuff at craigroutledge dot com>

	* src/main-window.c: bump the date in the about dialog.
	* doc/C/balsa.xml: bring the Main Window section of the help file
	up to sync with the user interface.
	* src/balsa-message.c: add tooltips to the "check crypto" and
	"attachment" icons.

2005-02-16 20:20  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* libbalsa/misc.c, libbalsa/misc.h, src/balsa-message.c,
	src/sendmsg-window.c: implement libbalsa_ia_rfc2821_equal and use
	it to exclude self from cc list.

2005-02-16 09:13  PeterB

	* src/mailbox-conf.c: manage sensitivity of the OK/Update button.

2005-02-15 21:48  Craig Routledge <webstuff@craigroutledge.com>

	* src/balsa-message.c: better handling of
	"application/octet-stream".

2005-02-15 21:48  PeterB

	* src/balsa-message.c: don't allocate unnecessary address strings.
	* libbalsa/: body.c, mailbox_mbox.c: let GMimeStreams work
	end-to-end when possible.

2005-02-14  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Add «nb» to ALL_LINGUAS.

2005-02-11 19:38  PeterB

	* src/sendmsg-window.c, libbalsa/misc.c: use
	"application/octet-stream" as a last resort.

2005-02-09 20:33  PeterB

	* libbalsa/mailbox.c: don't lock mailbox to change a pseudo-flag.
	* src/main-window.c: fix the About dialog.

2005-02-08 17:33  PeterB

	* src/save-restore.c: save the sanitized toolbar.
	* libbalsa/imap/imap-handle.c: typo.

2005-02-08  Pawel Salek

	* libbalsa/imap/imap-handle.c: unregister IDLE listener on
	error.
	* libbalsa/imap/imap-tls.c: related connection shutting cleanup.
	* libbalsa/imap/imap_private.h: add imap_handle_disconnect() proto.

2005-02-07 20:45  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/: save-restore.c, toolbar-factory.c, toolbar-factory.h: fix
	old toolbar button compatibility.

2005-02-07  Pawel Salek

	* src/address-book-config.c: compile with gtk-2.4
	* balsa.spec.in: distribute new icons.
	* configure.in: bump version to 2.3.0.
	* images/24x24/Makefile.am: fix install-data-hook:
	* libbalsa/Makefile.am: add missing i18n.h file.
	* libbalsa/mailbox_imap.c: remove debugging output.
	
2005-02-06 20:43  PeterB

	* configure.in, images/16x16/Makefile, images/16x16/Makefile.in,
	images/24x24/Makefile, images/24x24/Makefile.in,
	libbalsa/address-book-extern.c, libbalsa/address-book-ldif.c,
	libbalsa/address-book-vcard.c, libbalsa/address-book.c,
	libbalsa/address.c, libbalsa/body.c, libbalsa/filter-error.c,
	libbalsa/filter-file.c, libbalsa/filter.c,
	libbalsa/gmime-application-pkcs7.c, libbalsa/gmime-gpgme-context.c,
	libbalsa/i18n.h, libbalsa/identity.c, libbalsa/imap-server.c,
	libbalsa/libbalsa-conf.h, libbalsa/libbalsa.c,
	libbalsa/mailbox-filter.c, libbalsa/mailbox.c,
	libbalsa/mailbox_imap.c, libbalsa/mailbox_local.c,
	libbalsa/mailbox_maildir.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, libbalsa/mailbox_pop3.c, libbalsa/message.c,
	libbalsa/mime.c, libbalsa/misc.c, libbalsa/send.c,
	libbalsa/server.c, libbalsa/source-viewer.c,
	libinit_balsa/balsa-druid-page-defclient.c,
	libinit_balsa/balsa-druid-page-directory.c,
	libinit_balsa/balsa-druid-page-finish.c,
	libinit_balsa/balsa-druid-page-user.c,
	libinit_balsa/balsa-druid-page-welcome.c,
	libinit_balsa/balsa-initdruid.c, libinit_balsa/helper.c,
	libinit_balsa/init_balsa.c, src/ab-window.c,
	src/address-book-config.c, src/address-book-config.h,
	src/balsa-app.c, src/balsa-index.c, src/balsa-mblist.c,
	src/balsa-message.c, src/filter-edit-callbacks.c,
	src/filter-edit-dialog.c, src/filter-export-callbacks.c,
	src/filter-export-dialog.c, src/filter-run-callbacks.c,
	src/filter-run-dialog.c, src/folder-conf.c,
	src/information-dialog.c, src/mailbox-conf.c, src/mailbox-node.c,
	src/main-window.c, src/main.c, src/message-window.c,
	src/pref-manager.c, src/print.c, src/save-restore.c,
	src/sendmsg-window.c, src/spell-check.c, src/store-address.c,
	src/toolbar-factory.c, src/toolbar-prefs.c: install and use
	libbalsa/i18n.h; migrate from GnomeFileEntry to GtkFileChooser;
	other Gnome-deprecation cleanup.

2005-02-06 18:45   Albrecht Dreß <albrecht dot dress at arcor dot de>

	* configure.in, images/Makefile.am, images/16x16/Makefile,
	images/16x16/Makefile.am, images/16x16/Makefile.in,
	images/16x16/balsa-encrypted.png, images/16x16/balsa-mark-all.png,
	images/16x16/balsa-mbox-draft.png,
	images/16x16/balsa-mbox-sent.png,
	images/16x16/balsa-mbox-tray-empty.png,
	images/16x16/balsa-mbox-tray-full.png,
	images/16x16/balsa-next-flagged.png,
	images/16x16/balsa-next-part.png,
	images/16x16/balsa-next-unread.png, images/16x16/balsa-next.png,
	images/16x16/balsa-postpone.png,
	images/16x16/balsa-previous-part.png,
	images/16x16/balsa-previous.png, images/16x16/balsa-reply-all.png,
	images/16x16/balsa-signature-bad.png,
	images/16x16/balsa-signature-good.png,
	images/16x16/balsa-signature-notrust.png,
	images/16x16/balsa-signature-unknown.png, images/24x24/Makefile,
	images/24x24/Makefile.am, images/24x24/Makefile.in,
	images/24x24/balsa-crypt-check.png, images/24x24/balsa-encrypt.png,
	images/24x24/balsa-encrypted.png, images/24x24/balsa-mark-all.png,
	images/24x24/balsa-marked-new.png,
	images/24x24/balsa-next-flagged.png,
	images/24x24/balsa-next-part.png,
	images/24x24/balsa-next-unread.png, images/24x24/balsa-next.png,
	images/24x24/balsa-postpone.png, images/24x24/balsa-preview.png,
	images/24x24/balsa-previous-part.png,
	images/24x24/balsa-previous.png, images/24x24/balsa-reply-all.png,
	images/24x24/balsa-sign.png, images/24x24/balsa-signature-bad.png,
	images/24x24/balsa-signature-good.png,
	images/24x24/balsa-signature-notrust.png,
	images/24x24/balsa-signature-unknown.png,
	images/24x24/balsa-trash-empty.png, images/mimetypes/Makefile.am,
	src/balsa-icons.c, src/balsa-icons.h, src/balsa-index.c,
	src/balsa-mblist.c, src/balsa-message.c, src/filter-edit-dialog.c,
	src/main-window.c, src/message-window.c, src/sendmsg-window.c,
	src/spell-check.c, src/toolbar-factory.c, src/toolbar-prefs.c:
	themable icons.

2005-02-06  Pawel Salek

	* libbalsa/mailbox_imap.c: fix some corner cases for
	LibBalsaMessageBody-to-imap section transformation.
	* libbalsa/mailbox_pop3.c: use backend SSL option.
	* libbalsa/imap/imap-commands.[ch]: do not guess whether part headers
	are to be fetched - say it clearly.
	* libbalsa/imap/imap-handle.c: process all data in IDLE callback.

2005-02-06  Pawel Salek

	* libbalsa/body.[hc]: filter CRLF on saving text parts.
	* src/balsa-message.c, sendmsg-window.c: adapt to changed API.
	* libbalsa/html.c: HAVE_GNOME related fixes.

2005-02-05 17:50  PeterB

	* libbalsa/Makefile.am, libinit_balsa/Makefile.am, src/Makefile.am:
	temporarily allow deprecated methods.

2005-02-05 17:49  Albrecht Dreß <albrecht dot dress at arcor dot de>

	* src/sendmsg-window.c: fix DnD problem with escaped filenames.

2005-02-03  Pawel Salek

	* libbalsa/imap/imap-handle.c: clean handle->sio field.

2005-02-02  Pawel Salek

	* configure.in: minor reordering fixes.
	* libbalsa/address-book-gpe.c:  fix InternerAddress regression.
	* libbalsa/source-viewer.c: do not expand menu (regression fixed).
	* libbalsa/imap/imap-commands.c: enable/disable IDLE.
	* libbalsa/imap/imap-{handle,search}.c: ditto.
	* libbalsa/imap/imap_private.h: add IDLE related fields.

2005-01-29  Pawel Salek

	* configure.in: do it by the book (literally).
	* libbalsa/address-book-extern.c: remove uneeded GNOME dependency.
	* libbalsa/*.c: ditto.
	* libinit_balsa/*.c: Druid needs GNOME.
	* src/balsa-app.c: remove BALSA_MAJOR <2 remains.
	* src/print.c: drop old gnomeprint-1.* support.

2005-01-29 09:23  PeterB

	* src/folder-conf.c: fix typo.

2005-01-28 08:44  Craig Routledge <webstuff at craigroutledge dot com>

	* libbalsa/mailbox_local.c: fix bug #147380.

2005-01-27  Pawel Salek

	* libbalsa/address-book-ldap.c: fix InternerAddress regression.

2005-01-22  Pawel Salek

	* libbalsa/mailbox_imap.c: do not loose content type paramters -
	fix message wrapping on replying.

2005-01-20  Pawel Salek

	* libbalsa/address-entry.c: fix crashes on: domain-expanded
	address selection; unparsable address.

2005-01-17 23:02  PeterB

	* src/: balsa-message.c, sendmsg-window.c: port from
	GtkFileSelection to GtkFileChooserDialog.

2005-01-17 18:14  Albrecht Dreß <albrecht.dress@arcor.de>

	* src/balsa-message.c, libbalsa/misc.c, libbalsa/misc.h: multiline
	URL highlighting.

2005-01-17  Pawel Salek

	* libbalsa/address-entry.c: add missing #include.
	* libbalsa/identity.h: 
	* libinit_balsa/balsa-druid-page-user.c: port it to InternetAddress.

2005-01-17 14:32  PeterB

	* libbalsa/address-entry.c: use list->address instead of
	internet_address_list_get_address.

2005-01-17 13:41  PeterB

	* src/balsa-message.c, src/message-window.c, src/print.c,
	src/save-restore.c, src/sendmsg-window.c, src/store-address.c,
	libbalsa/abook-completion.c, libbalsa/abook-completion.h,
	libbalsa/address-book-ldif.c, libbalsa/address-book-vcard.c,
	libbalsa/address-entry.c, libbalsa/address-entry.h,
	libbalsa/address.c, libbalsa/address.h, libbalsa/body.h,
	libbalsa/files.h, libbalsa/filter.c, libbalsa/identity.c,
	libbalsa/identity.h, libbalsa/libbalsa.h,
	libbalsa/libbalsa_private.h, libbalsa/mailbox.c,
	libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/mailbox_mbox.c,
	libbalsa/message.c, libbalsa/message.h, libbalsa/misc.c,
	libbalsa/misc.h, libbalsa/send.c: use GMime's InternetAddress
	instead of LibBalsaAddress, except for address-book entries.

2005-01-17 10:36  PeterB

	* src/: toolbar-factory.c, toolbar-prefs.c: remove redundant
	includes.

2005-01-14 08:32  PeterB

	* configure.in, images/Makefile.am, src/balsa-message.c,
	src/expand-alias.c, src/expand-alias.h, src/sendmsg-window.c,
	images/mimetypes/Makefile, images/mimetypes/Makefile.am,
	images/mimetypes/Makefile.in,
	images/mimetypes/gnome-mime-application-pgp-signature.png,
	images/mimetypes/gnome-mime-application-pkcs7-mime.png,
	images/mimetypes/gnome-mime-application-pkcs7-signature.png,
	images/mimetypes/gnome-mime-application-x-pkcs7-signature.png,
	images/mimetypes/gnome-mime-message-disposition-notification.png,
	images/mimetypes/gnome-mime-message-external-body.png,
	images/mimetypes/gnome-mime-message.png,
	images/mimetypes/gnome-mime-multipart-alternative.png,
	images/mimetypes/gnome-mime-multipart-encrypted.png,
	images/mimetypes/gnome-mime-multipart-signed.png,
	images/mimetypes/gnome-mime-multipart.png: install mime type icons;
	simplify icon search.

2005-01-13 14:56  PeterB

	* configure.in, libbalsa/address-entry.c, libbalsa/address-entry.h,
	libbalsa/files.c, libbalsa/identity.c, libbalsa/mailbox.c,
	libbalsa/misc.c, libbalsa/misc.h, libbalsa/send.c,
	libbalsa/source-viewer.c, libinit_balsa/helper.c, src/Makefile.am,
	src/ab-main.c, src/ab-window.c, src/balsa-app.c, src/balsa-index.c,
	src/balsa-mblist.c, src/filter-edit-callbacks.c,
	src/filter-edit-dialog.c, src/filter-edit.h, src/mailbox-conf.c,
	src/main-window.c, src/main.c, src/pref-manager.c,
	src/sendmsg-window.c, src/sendmsg-window.h, src/store-address.c,
	src/toolbar-factory.c: require gtk+-2.0 >= 2.4 and remove
	GTK_CHECK_VERSION(2,4,0) tests.

2005-01-12  Pawel Salek

	* libbalsa/imap/imap-commands.c: work around broken dovecot indexes.

2005-01-07 09:47  PeterB

	* src/main-window.c: Use hyphen instead of underscore in translator
	credits.
	* src/balsa-mblist.c: restore separator in
	balsa_mblist_mru_option_menu(); remove unused variable.

2005-01-07  Pawel Salek

	* libbalsa/libbalsa.h: add mailbox manipulation error codes.
	* libbalsa/mailbox_imap.[hc]: return more info on error.
	* src/folder-conf.c: handle errors better.
	* src/mailbox-conf.c: ditto.

2005-01-06  Pawel Salek

	* libbalsa/imap/imap-handle.c: silence debugging output.
	* libinit_balsa/balsa-druid-page-user.[hc]: port initial wizard
	improvements.
	* src/balsa-mblist.c: protect against D&D crashes.

2005-01-05 09:05  PeterB

	* libbalsa/mailbox_local.c: use second GNode tree in jwz-threading.

2005-01-04  Pawel Salek

	* libbalsa/mailbox_local.c: remove bogus test from msg matching (PB).

2005-01-03 19:09  PeterB/manu <eallaud@yahoo.fr>

	* libbalsa/mailbox_local.c: check for NULL msg-id.

2006-01-02  Pawel Salek

	* libbalsa/filter.c, libbalsa/misc.[hc]: move in_string_utf8() to misc
	* libbalsa/libbalsa_private.h:
	* libbalsa/mailbox.c: move LibBalsaMailboxEntry def to private.h
	* libbalsa/mailbox_local.c: implement faster searching code
	(manyfold speedup for large mailboxes).

2004-12-31 12:08  Albrecht Dreß <albrecht.dress@arcor.de>

	* libbalsa/body.h, libbalsa/files.c, libbalsa/files.h,
	libbalsa/send.c, src/balsa-message.c, src/print.c,
	src/sendmsg-window.c, src/pixmaps/info_lock.xpm,
	src/pixmaps/info_lock_bad.xpm, src/pixmaps/info_lock_encr.xpm,
	src/pixmaps/info_lock_good.xpm, src/pixmaps/info_lock_sigtrust.xpm:
	new attachment handling code.

2004-12-30 17:04  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_local.c: reduce the
	amount of tree modification when updating threading.
	* libbalsa/send.c: convert file name to utf-8 for GMime.

2004-12-29 11:49  PeterB

	* src/main-window.c: use BALSA_PIXMAP_CLOSE_MBOX instead of
	GTK_STOCK_CLOSE for Close-mailbox menu item; use
	GTK_ICON_SIZE_BUTTON for notebook label close button.

2004-12-27 10:02  PeterB

	* libbalsa/files.c: do not bypass theme when mime-type and filename
	are both NULL.

2004-12-26 18:45  PeterB

	* libbalsa/body.c: g_mime_data_wrapper_write_to_stream() decodes
	the transfer-encoding--we must not.
	* libbalsa/files.c: look for themed mime-type icon.

2004-12-24  Pawel Salek

	* libbalsa/body.c: always call gdk_pixbuf_loader_close().
	* libbalsa/mailbox_pop3.c: do not try to move messages filtered
	out by procmail.

2004-12-22 13:25  Albrecht Dreß <albrecht.dress@arcor.de>

	* libbalsa/: body.c, mime.c: two minor gpg related fixes.

2004-12-20 12:33  PeterB

	* src/: balsa-index.c, balsa-index.h: re-implement
	balsa_index_{next,previous}_msgno.
	* src/message-window.c: save more menu items; use
	balsa_index_{next,previous}_msgno() to correctly manage menu item
	and button sensitivity.

2004-12-18  Pawel Salek

	* libbalsa/imap/imap-handle.c: forgive errors in BODYSTRUCTURE response
	(work around #160083).

2004-12-18  Craig Routledge
	
	* src/balsa-app.[ch]: add mw_action_after_move.
	* src/message-window.c: use it.
	* src/pref-manager.c: configure it.
	* src/save-restore.c: save/restore it.

2004-12-16 14:34  PeterB

	* libbalsa/body.c: if body->mime_part is a GMimeMessagePart, get
	the stream for its message, not the part.

2004-12-15 06:43  PeterB

	* libbalsa/body.c: add some checks.

2004-12-13 09:41  PeterB

	* libbalsa/html.c: do not write zero bytes, to avoid a
	gtkhtml-CRITICAL.

2004-12-12 12:23  PeterB

	* libbalsa/mailbox_imap.c: check for NULL handle.

2004-12-09 15:45  PeterB

	* libbalsa/address-entry.c, libbalsa/address-entry.h,
	src/sendmsg-window.c: implement libbalsa_address_entry_addresses()
	and use it to move address-counting to libbalsa.

2004-12-08 15:11  PeterB

	* libbalsa/address.c: use InternetAddress methods to manage quoting
	and stringifying.
	* libbalsa/address-entry.c: use a hash table to hold
	LibBalsaAddress objects; parse quoted strings more carefully.

2004-12-07 18:57  PeterB

	* src/sendmsg-window.c: use libbalsa_wrap_rfc2646() to ensure
	space-stuffing.
	* libbalsa/misc.c: append spaces for DelSp=Yes.
	* libbalsa/gmime-gpgme-context.h: replace GMIME_CHECK_* macros with
	G_TYPE_*.
	* libbalsa/mailbox_mbox.c: simplify From_ line armoring.

2004-12-06 16:23  PeterB

	* libbalsa/: address.c, address.h: parse string with group address;
	implement libbalsa_address_set_copy_member() to make a copy of a
	LibBalsaAddress containing only one mailbox.
	* libbalsa/address-entry.c: parse entry text with group address;
	make only one completion item per address.
	* libbalsa/address-book-vcard.c: when not in dist_list_mode and a
	completion item has more than one address, make multiple
	single-address LibBalsaAddress objects.
	* libbalsa/: address.c, address.h, message.c: implement and use
	libbalsa_address_new_list_from_gmime(); do not ignore RFC 2822
	group addresses.

2004-12-04 08:39  PeterB

	* src/: balsa-index.c, balsa-index.h, message-window.c: remove
	balsa_index_next_.*_msgno api; implement balsa_index_select() and
	use it to manage highlighting in the mailbox index.


2004-06-10  Pawel Salek

	* src/balsa-message.c: proper msg popup menus (Albrecht Dreß).
	* src/folder-conf.c: use gtk_dialog_run as required by spec.

2004-06-08  Pawel Salek

	* libbalsa/mailbox-filter.c: compile.
	* libbalsa/imap/imap-commands.c: set the readonly argument
	also when the handle has been already selected.
	* libbalsa/mailbox_{maildir,mbox,mh}.c: set readonly flag
	in a more robust way.

2004-06-07 16:51  PeterB

	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c:
	manage `recent' flag.
	* libbalsa/: message.c, message.h: drop
	libbalsa_message_clear_recent--it's the driver's responsibility.
	* libbalsa/mailbox.c, src/balsa-index.c: check message number when
	searching.
	* libbalsa/mailbox-filter.c: match URL exactly when looking up
	filter section.
	* libbalsa/mailbox_local.c: retrieve user headers more reliably.

2004-06-06 20:11  PeterB

	* libbalsa/source-viewer.c, src/sendmsg-window.c:
	GTK_WRAP_WORD_CHAR is since gtk-2.4.0.
	* libbalsa/mailbox_mbox.c: change preface or postface only when
	non-NULL.
	* libbalsa/mailbox_mbox.c: space-stuff From_ lines in multipart
	preface and postface.

2004-06-04 17:47  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/mailbox_maildir.c,
	libbalsa/mailbox_mbox.c, libbalsa/mailbox_mh.c, libbalsa/message.c,
	libbalsa/message.h, src/balsa-message.c: drop
	message->{status,attach}_icon.
	* src/filter-edit-callbacks.c: don't crash on new filter.
	* src/filter-edit-callbacks.c: allow editing of compound
	conditions.
	* libbalsa/filter-funcs.c: eat space between left and right
	conditions.
	* src/main-window.c: document, and fix typo.
	* src/: balsa-app.c, balsa-index.c, filter-run-callbacks.c,
	main-window.c, main-window.h, pref-manager.c: don't refer to
	balsa_app.main_window in src/main-window.c.

2004-06-02 12:51  PeterB

	* src/toolbar-factory.c: simplify balsa_toolbar_remove_all; make
	bti->widget a weak pointer.

2004-05-31  Pawel Salek

	* libbalsa/libbalsa.[ch]: simplify thread recognition, do not
	destroy static mutexes.
	* libbalsa/{mailbox_local,rfc3156.c}.c: use
	libbalsa_am_i_subthread().
	* libbalsa/imap/imap-commands.c: actually do rename.
	* src/balsa-app.c: do not destroy static mutexes. Use
	libbalsa_am_i_subthread(). Fix multiple IMAP server tree scanning.
	* src/balsa-mblist.c: use fixed balsa_find_dir().
	* src/mailbox-node.c: ditto.
	* src/main-window.c: check for main window existence before
	refreshing.
	
2004-05-28 14:21  PeterB

	* libbalsa/source-viewer.c, src/sendmsg-window.c: allow GtkTextView
	to break words when it's in a widget that doesn't allow horizontal
	scrolling.
	* src/main-window.c: tweak border width.
	* src/: balsa-index.c, balsa-index.h: rest of the previous commit!
	* doc/C/balsa.xml, src/main-window.c: redesign Edit->Find dialog,
	and add help.

2004-05-27 07:11  PeterB

	* libbalsa/: mailbox_pop3.c, mailbox_pop3.h: dump
	pop->last_popped_uid.

2004-05-26 14:06  PeterB

	* doc/C/balsa.xml, libbalsa/folder-scanners.c,
	libbalsa/folder-scanners.h, src/balsa-app.c, src/balsa-app.h,
	src/mailbox-node.c, src/pref-manager.c, src/save-restore.c:
	deferred folder scanning for local folder trees.

2004-05-26 11:04  PeterB

	* src/balsa-index.c: build with gtk+-2.0 < 2.2.0.
	* src/balsa-index.c: Manu: one more recursion killed, in
	bndx_expand_to_row; deselect hidden messages when a new message
	is selected.

2004-05-25 18:51  PeterB

	* src/: balsa-app.c, balsa-index.c, mailbox-node.c, main-window.c:
	bullet-proof against closing during startup.
	* libbalsa/mailbox.c: Manu: make get-path-helper nonrecursive.
	* libbalsa/mailbox.c: run filters on recent undeleted messages, not
	all recent.
	* src/: main-window.c, main-window.h: pass BalsaWindow as an
	argument to balsa_window_enable_mailbox_menus, instead of using
	balsa_app.main_window.
	* src/balsa-index.c: supply new argument to
	balsa_window_enable_mailbox_menus; check BALSA_IS_INDEX(index) in
	exported select methods.

2004-05-24 18:59  PeterB

	* src/: mailbox-conf.c, main-window.c, main-window.h: update the
	display when a special mailbox name is changed.

2004-05-24 17:34  PeterB

	* libbalsa/folder-scanners.c, libbalsa/folder-scanners.h,
	libbalsa/mailbox_local.c, src/balsa-app.c, src/balsa-app.h,
	src/balsa-index.c, src/balsa-mblist.c, src/balsa-mblist.h,
	src/filter-edit-callbacks.c, src/folder-conf.c, src/mailbox-conf.c,
	src/mailbox-node.c, src/mailbox-node.h, src/main-window.c,
	src/main-window.h, src/main.c, src/pref-manager.c,
	src/save-restore.c, src/save-restore.h: remove
	BalsaApplication::mailbox_nodes;
	BalsaApplication::mblist_tree_store owns its BalsaMailboxNodes.

2004-05-24 09:05  PeterB

	* libbalsa/mailbox.[ch], libbalsa/message.c, src/balsa-message.c:
	update the cached icon as well as the message icon; shift the
	responsibility for signalling "row-changed" to the mailbox code.

2004-05-22  Pawel Salek

	* balsa.spec.in: Balsa.idl should be distributed.
	* configure.in, NEWS: release 2.1.3.
	* src/Makefile.am: proper location of Balsa.idl

2004-05-22  Pawel Salek

	* libbalsa/imap-server.c. libinit_balsa/balsa-druid-page-directory.c:
	compile without SSL.
	* Makefile.am, balsa.desktop.in: 
	* po/POTFILES.in: i18n patch from report 142769.
	* src/Makefile.am: bug 142958.
	* libbalsa/gmime-gpgme-{context,signature}.c: compile without GPGME.
	* libbalsa/gmime-part-rfc2440.c: ditto.
	* src/mailbox-conf.c: fix configuration of IMAP mailboxes.
	
2004-05-15 16:12  PeterB

	* src/message-window.c: keep MessageWindow::bmessage alive while we
	change MessageWindow::message.

2004-05-11 15:02  PeterB

	* src/main-window.c: make commit item insensitive for readonly
	mailbox.
	* src/main-window.c: don't sync read-only mailbox.

2004-05-09  Albrecht Dreß

	* libbalsa/body.[hc]: cleanup.
	* libbalsa/mailbox.c: same here.
	* libbalsa/message.c: same here.
	* src/balsa-message.c: fetch signed part earlier.

2004-05-09  Pawel Salek

	* libbalsa/mailbox_imap.c, libbalsa/imap/pop3.c
	* src/information-dialog.c, src/main-window.c: format fixes.
	* src/message-window.c: unregister weak references in proper order.

2004-05-08  Pawel Salek

	* libbalsa/imap-server.c: allow disabling TLS.
	* libbalsa/{mailbox_pop3,server}.c: ditto.
	* libbalsa/server.h: declare related constants.
	* libbalsa/imap/imap-handle.[ch]: backend support for that.
	* libbalsa/imap/{imap_private,libimap}.h: ditto.
	* libbalsa/imap/pop3.[hc]: same for POP.
	* src/{folder,mailbox}-conf.c: UI for this functionality.
	* src/mailbox-node.c: ditto.
	* src/save-restore.c: clean mailbox-node section before saving.

2004-05-08 08:23  PeterB

	* libbalsa/mailbox.c: don't cache has-unseen-child.

2004-05-07 07:06  PeterB

	* libbalsa/mailbox.c: ditto

2004-05-07  Pawel Salek

	* libbalsa/mailbox.c: do not assume you have all the entries.

2004-05-07 00:44  PeterB

	* libbalsa/: mailbox_maildir.c, mailbox_mh.c: load flags correctly.
	* libbalsa/mailbox.c: check for NULL entry.
	* libbalsa/mailbox.c: manage has-unseen-child flag.

2004-05-06 17:25  PeterB

	* src/message-window.c: keep the message reffed, to hold the window
	open until the mailbox is closed.
	* libbalsa/source-viewer.c: ref the message instead of weak-ref.
	* src/balsa-index.c: clean up selected list when closing.
	* libbalsa/mailbox_mbox.c: use weak-ref, not weak-pointer--Pawel
	had it right!

2004-05-05 15:40  PeterB

	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c: set msg->flags from
	msg_info->flags.
	* src/message-window.c: plug ref leak.
	* src/balsa-index.c: prune dead code.
	* src/mailbox-node.c: restore new mail check in closed mailboxes.
	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c:
	restore new mail check in closed mailboxes; manage message
	references.
	* libbalsa/: mailbox_local.c, mailbox_local.h, message.c: simplify
	mailbox locking; restore threading in local mailboxes.
	* libbalsa/: mailbox.c, mailbox.h: simplify mailbox locking; drop
	LibBalsaMailboxIndexEntry::msgno; add accessors for
	LibBalsaMailboxIndexEntry members.
	* libbalsa/: filter.c, filter.h, libbalsa_private.h,
	mailbox_imap.c: simplify mailbox locking.

2004-05-05  Pawel Salek

	* libbalsa/mailbox.[ch]: be more compatible with --disable-threads.
	* libbalsa/mailbox_mbox.c: fix old and new bugs.
	* src/balsa-mblist.c: gtk can pass empty list of selected messages
	for d&d.

2004-05-04  Pawel Salek

	* libbalsa/folder-scanners.c: report IMAP server messages.
	* libbalsa/imap-server.[hc],libbalsa.h: ditto.
	* libbalsa/mailbox.[ch]: more detailed error messages.
	* libbalsa/mailbox_{imap,maildir,mbox,mh,pop3}.c: ditto.
	* libbalsa/send.c: adjust to changed API.
	* libbalsa/imap/{auth-cram,imap-auth}.c:
	* libbalsa/imap/imap{-handle.c,_private.h}:
	store last server msg.
	* libbalsa/imap/pop3.c: respect DISABLE_APOP flag.
	* src/balsa-index.[hc]: adjust to changed API.
	* src/filter-run-dialog.c:
	* src/{main,sendmsg}-window.c: ditto.
	* src/mailbox-conf.c: reenable APOP disabling.

2004-05-03  Pawel Salek

	* configure.in: use GTK_CHECK_VERSION instead of HAVE_GTK24.
	* libbalsa/filter-funcs.c: use reentrant localtime_r().
	* libbalsa/rfc3156.c: ditto.
	* src/filter-edit-callbacks.c: ditto.
	* libbalsa/libbalsa.[ch]: move libbalsa_date_to_gchar() and
	libbalsa_get_icon_from_flags() here.
	* libbalsa/mailbox.[hc]: implement LibBalsaMailboxEntry to reduce
	memory usage.
	* libbalsa/mailbox_{imap,local,maildir,mbox,mh,pop3}.c: use it.
	* libbalsa/message.[ch]: add code to aid Message reference debugging.
	* libbalsa/send.c: ref and unref correctly.
	* src/{balsa-index,main-window,sendmsg-window}.c: ditto.

2004-04-29  Pawel Salek

	* configure.in: INTLTOOL needed for FC2.
	* src/sendmsg-window.c: postpone messages very carefully.
	* bootstrap.sh: cheap autogen.sh replacement.

2004-04-27 11:07  PeterB

	* libbalsa/rfc3156.c: build --with-gpgme --disable-threads.

2004-04-26 20:00  PeterB

	* libbalsa/filter-file.c, libbalsa/filter-funcs.c,
	libbalsa/filter.h, libbalsa/mailbox.c, src/filter-edit-callbacks.c,
	src/save-restore.c: ease migration of filters from 2.0-style config
	to 2.1-style.

2004-04-25 11:35  PeterB

	* libbalsa/send.c: check for error return from
	libbalsa_mailbox_open.

2004-04-24  Carlos Morgado  <chbm gnome.org>

	* libbalsa/Makefile.am: back out reintroduction of _DEPRECATED, 
	we're not trying to be 2.6 clean yet

2004-04-24  Pawel Salek

	* libbalsa/message.c: do not release too many headers on body_unref().

2004-04-23 08:14  PeterB

	* src/balsa-mblist.c: split message (bug #116604).

2004-04-22  Pawel Salek

	* libbalsa/libbalsa.c: no-SSL build fixes.
	* libbalsa/send.c: libesmtp-1.0.3 release delayed.

2004-04-21 12:42  PeterB

	* libbalsa/mailbox_imap.c: map IMBENC_OTHER to
	GMIME_PART_ENCODING_DEFAULT.
	* src/: balsa-mblist.c, main-window.c: use ngettext--fix for bug
	#116604.
	* libbalsa/message.c: libbalsa_message_set_headers_from_string sets
	all headers again.

2004-04-20  Pawel Salek

	* libbalsa/libbalsa.[hc]: unify SMTP/IMAP/POP certificate management.
	* libbalsa/send.c: support better SMTP TLS (requires libesmtp-1.0.3).
	* libbalsa/server.[hc]: simplify.
	* src/main-window.c: respect "Cancel" button.
	* libbalsa/gmime-gpgme-context.c: pass name (Albrecht Dress).

2004-04-20 15:44  PeterB

	* libbalsa/message.c: don't add to user_hdrs when processing basic
	headers.
	* src/message-window.c: set title bar when message is set.
	* src/balsa-message.c: check GMIME_IS_PART(info->body->mime_part).
	* libbalsa/gmime-part-rfc2440.c: check for empty content.
	* libbalsa/filter.c, libbalsa/mailbox.c, libbalsa/mailbox.h,
	libbalsa/mailbox_local.c, src/balsa-index.c, src/main-window.c:
	check messages against view-filter after filtering; allow NULL
	condition and search-iter.

2004-04-20 00:30  PeterB

	* libbalsa/message.c: clear message->has_all_headers when extra
	headers are destroyed.
	* libbalsa/message.c: don't add standard headers to user_hdrs.

2004-04-19  Pawel Salek

	* libbalsa/filter.c: update argument list of message_body_ref().
	* libbalsa/send.c: ditto.
	* libbalsa/mailbox_imap.c: correctly fetch-headers on fetch-struct.
	* libbalsa/mailbox_local.c: ditto.
	* libbalsa/mailbox_mbox.c: set message length.
	* libbalsa/message.[ch]: fetch msg structure and headers in one shot.
	* src/balsa-message.c: update argument list of message_body_ref().
	* src/{sendmsg-window,print}.c: ditto.
	* libbalsa/mailbox.c: make sure not to break group-reply.

2004-04-19 09:17  PeterB

	* src/balsa-message.c: emit "row-changed" signal after updating the
	attach icon.

2004-04-18  Albrecht Dress

	large GPG patch as in 124905, attachment 26752.
	
2004-04-16  Adam Weinberger  <adamw@gnome.org>

	* en_CA.po: Added en_CA to ALL_LINGUAS.

2004-04-14  Pawel Salek

	* libbalsa/html.c: change op order to make gtkhtml2 happy.

2004-04-14 05:50  PeterB

	* src/sendmsg-window.c: clear old auto-bcc when changing
	identities, if that's the only bcc entry.
	* src/sendmsg-window.c: be more careful when changing identities.

2004-04-13 21:34  PeterB

	* libbalsa/: imap-server.c, mailbox_imap.c, mailbox_imap.h: lock
	the mailbox in "expunge-notify" handler; remove unnecessary handler
	in imap-server and unused hook in mailbox-imap.

2004-04-12  Pawel Salek

	* libbalsa/misc.c: fix fcntl() locking.
	* src/balsa-icons.[hc]: make "deleted" icon size match other icons.

2004-04-12  Pawel Salek

	* libbalsa/mailbox.[hc]: fetch headers smarter.
	* libbalsa/mailbox_imap.c: provide subclasses for _fetch_headers.
	* libbalsa/mailbox_local.c: ditto.
	* libbalsa/message.[hc]: use it.
	* libbalsa/imap/imap-commands.c: cleanup.
	* src/sendmsg-window.c: make sure we know all the relevant headers.

2004-04-11  Carlos Morgado  <chbm gnome.org>

	* libbalsa/Makefile.am: 
	remove *_DISABLE_DEPRECATED

2004-04-11  Pawel Salek

	* libbalsa/mailbox_imap.c: fetch references and list-post. 
	* libbalsa/message.c: remove unused data. Parse sequences of headers.xo
	* libbalsa/imap/imap-commands.[hc]: simplify fetching code.
	* libbalsa/imap/imap-handle.[hc]: handle HEADER.FIELDS.NOT.

2004-04-07  Pawel Salek

	* libbalsa/mailbox_imap.c: do not quit when talking to non-IMAP servers
	* src/sendmsg-window.c: check message_postpone() return code.

2004-04-07 06:55  PeterB

	* libbalsa/imap/pop3.c: free pop->host.
	* libbalsa/: mailbox_local.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c, message.c, message.h: scrap
	LibBalsaMessage::references_for_threading and create the list on
	the fly instead; allocate extra headers in body-ref and deallocate
	them in body-unref.

2004-04-06  Pawel Salek

	* libbalsa/mailbox.c: make nth_child return correct answer for closed
	mailboxes.
	* libbalsa/message.c: simplify prepend_header_misc().
	* libbalsa/imap/pop3.c: gracefully handle timeouts after initial
	greeting but before authentication.

2003-04-05  Emmanuel Allaud

	* src/mailbox-conf.c: fix crash on IMAP mailbox configuration.

2004-04-05  Pawel Salek

	* NEWS, configure.in: release balsa-2.1.2

2004-04-04  Pawel Salek

	* libbalsa/mailbox_local.c: make sure to kill the delayed sync handler
	before closing the mailbox. Lock properly, too.
	* libbalsa/mailbox_pop3.c: cleanup and improve progress indication.
	* libbalsa/imap/pop3.[ch]: armour the code against broken connections.
	* src/main-window.c: change slightly displaying format.

2004-04-03  Pawel Salek

	* libbalsa/imap/pop3.h: implement pipelined pop3 fetching.
	* libbalsa/mailbox_pop3.c: use it.

2004-04-02 06:45  PeterB

	* libbalsa/mailbox_mbox.c: when rewriting the mbox in a sync, use
	g_mime_stream_write_to_stream instead of
	g_mime_message_write_to_stream.

2004-04-01 11:50  PeterB

	* src/: balsa-index.c, balsa-index.h: desensitize menu items that
	change flags in a readonly mailbox.
	* libbalsa/message.c: warn if we try to change flags in a readonly
	mailbox.
	* libbalsa/mailbox.c: set theading only in an open mailbox; don't
	try to change flags in a readonly mailbox.

2004-04-01  Pawel Salek

	* libbalsa/imap/*.c: compile without SSL and with gmime-2.1.3.

2004-03-31  Carlos Morgado  <chbm gnome.org>

	* src/balsa-message.c: quote argument when we invoke a vfs command

2004-03-31 09:24  PeterB

	* src/main-window.c: handle mailbox-changed signal in an idle
	handler.
	* libbalsa/imap/imap-handle.c: declaration out of order.

2004-03-30 15:39  PeterB

	* libbalsa/: mailbox_local.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c: use libbalsa_mailbox_run_filters_on_reception in
	libbalsa_mailbox_local_load_messages instead of the individual
	drivers.
	* libbalsa/mailbox_imap.c: implement
	LibBalsaMailboxImap::search_stamp; new api for
	libbalsa_mailbox_run_filters_on_reception; remove dead code.
	* libbalsa/: mailbox.c, mailbox.h: scrap
	libbalsa_mailbox_invalidate_iters, and invalidate them only when
	really necessary; clean up
	libbalsa_mailbox_run_filters_on_reception; use separate keys for
	added and promoted.

2004-03-29 21:34  PeterB

	* src/main-window.c: clear BalsaWindow::current_message in destroy
	method--it seems to be called twice.

2004-03-29  Pawel Salek

	* configure.in: do not bother checking for intltool - we do not use it.
	* libbalsa/mailbox_local.[hc]: adaptive syncing delay.
	* libbalsa/mailbox_{mbox,maildir,mh}.c: matching changes.
	* libbalsa/imap/pop3.c: close the descriptor.
	* src/Makefile.am: test compilation on GNOME-2.6
	* src/toolbar-factory.c: toolbar modification on gtk2.4

2004-03-28 14:33  PeterB

	* libbalsa/libbalsa.c: lock the mutex before waiting on the
	condition.

2004-03-28  Pawel Salek

	* libbalsa/mailbox_local.c: remove the idle sync handler on finalize.
	Wait for three idle seconds before running.
	* libbalsa/mailbox_mh.c: do not leak descriptors.
	* libbalsa/mailbox_pop3.c: creat() returns a descriptor that has
	to be closed.

2004-03-27 23:24  PeterB

	* src/: main-window.c, balsa-mblist.c: manage notebook-tab
	label-style in main-window.c instead of balsa-mblist.c.
	* src/mailbox-node.c: don't die on invalid local mailbox type.
	* libbalsa/mailbox.c: check that a file is empty or begins with
	"From " before deciding it's a LibBalsaMailboxMbox; check for NULL
	condition.

2004-03-27  Pawel Salek

	* libbalsa/Makefile.am: remove old POP3 support.
	* libbalsa/server.[hc]:
	* libbalsa/imap-server.c: share SSL code between IMAP and POP.
	* libbalsa/mailbox_imap.[hc]: remove old crust.
	* libbalsa/mailbox_pop3.[hc]: use new POP3 code, fix 104963, 134912.
	* libbalsa/misc.c: remove plenty of space.
	* libbalsa/imap/Makefile.am: add new POP support.

	* libbalsa/imap/{auth-cram,imap-auth}.c: share code between pop
	and IMAP.
	* libbalsa/imap/{imap-auth.h,imap-handle.c,imap_private.h}: ditto.
	* src/ab-window.c: revoke libbalsa_option_menu() patch of 2004-03-07:
	it was a bad idea.
	* src/store-address.c, etc: ditto.
	* libbalsa/imap/pop3.[hc]: implement pop3s for the sake of completness.

2004-03-26 17:05  PeterB

	* libbalsa/mime.c: file descriptor leak.
	* libbalsa/mailbox.c: lock the mailbox while searching it.
	* libbalsa/body.c: use the GError argument of g_file_open_tmp.
	* libbalsa/: mailbox_maildir.c, mailbox_maildir.h: test the subdirs
	for write permission, as well as the main dir--set readonly if any
	fails.

2004-03-25 12:45  PeterB

	* src/balsa-index.c: report errors when copying or moving messages.
	* libbalsa/mailbox_mbox.c: open read-only mailbox correctly.
	* src/filter-run-callbacks.c, libbalsa/filter.c, libbalsa/filter.h,
	libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/message.c: use a GArray to pass a list of message numbers;
	implement and use libbalsa_mailbox_register_msgnos, to update
	message numbers in a GArray when a message is expunged.

2004-03-22 21:02  PeterB

	* src/sendmsg-window.c: body_ref the message before getting
	charset; check libbalsa_mailbox_open for errors and re-enable
	message save.
	* src/balsa-index.c: get first_unread on-screen, if possible.
	* libbalsa/mailbox_imap.c: keep first_unread current.
	* configure.in: detect libgtkhtml-3.1.

2004-03-22  Pawel Salek

	* libbalsa/libbalsa.c: release gdk lock when waiting for mailbox
	lock.
	* libbalsa/mailbox{,_imap}.c: update counters in an idle function.
	* src/main-window.c: show message source without preview active.

2004-03-20 08:13  PeterB

	* libbalsa/mailbox_imap.c: (libbalsa_mailbox_imap_messages_copy)
	allow NULL search_iter.
	* libbalsa/: mailbox.c, message.c: use bulk copy and move methods.
	* src/balsa-index.c: use a LibBalsaMailboxSearchIter, to allow
	caching of search results.
	* libbalsa/: mailbox.c, mailbox.h: implement
	libbalsa_mailbox_search_iter_view.

2004-03-19 21:51  PeterB

	* src/: balsa-index.c, balsa-index.h: maintain list of selected
	messages; check a message that leaves the list against the current
	view-filter; keep multiple selections.
	* libbalsa/mailbox_local.c: check the msg_tree when changing
	view-filter.
	* libbalsa/: mailbox.c, mailbox.h: implement
	libbalsa_mailbox_msgno_deselected.
	* libbalsa/: mailbox_maildir.c, mailbox_mh.c: be more careful
	dereferencing message info array.

2004-03-18  Pawel Salek

	* libbalsa/mailbox_imap.c: process flags in batches.
	* libbalsa/imap/imap-commands.c: send batches of flags via imap_cb
	* libbalsa/imap/imap-handle.c: similarly here.
	* libbalsa/imap/imap-handle.h: change imap_cb typedef.

2004-03-16 17:13  PeterB

	* libbalsa/mailbox.c: show unread status of deleted messages.
	* libbalsa/mailbox.c: set the value even if the tree-view is not
	realized.

2004-03-15 15:02  PeterB

	* src/balsa-index.c: don't connect to mailbox's "row-changed"
	signal--"changed" is enough.
	* src/balsa-mblist.c: update total messages when mailbox is closed.
	* libbalsa/: message.c, message.h: check that flags really change.
	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c:
	signal new mailbox size when closing.
	* libbalsa/mailbox_local.c: don't emit signal; set unread-messages
	flag only if new mail arrived.
	* libbalsa/mailbox.c: check that message flags really change.

2004-03-14 09:15  PeterB

	* src/balsa-mblist.c: connect to mailbox's "changed" signal instead
	of "set-unread-messages-flag" and "messages-status-changed".
	* libbalsa/message.c: libbalsa_mailbox_copy_message returns +/-1,
	not TRUE/FALSE.
	* libbalsa/mailbox_imap.c: check for mailbox lock in flags- and
	exists- callbacks; sort msgnos when copying.
	* libbalsa/: mailbox.c, mailbox.h: scrap "messages-status-changed"
	and "set-unread-messages-flag" signals; emit "changed" when we
	might need to inform the front-end; streamline counting unread
	messages.
	* libbalsa/filter-funcs.c: Manu: use macro.

2004-03-13 13:06  PeterB

	* libbalsa/body.c: empty GMimePart is OK.

2004-03-12 22:33  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, message.c: in imap mailbox,
	apply filters in EXISTS response handler; clean up flags-handling.
	* libbalsa/: body.c, mailbox_imap.c, mailbox_local.c:
	get_message_part returns NULL if the part is not a GMimePart.
	* libbalsa/mailbox_mbox.c: crlf-filter incoming message, not just
	text parts.

2004-03-12  Pawel Salek

	* src/sendmsg-window.c: disentangle charset/attachment
	initialization order.
	* libbalsa/filter.c: compare filter names correctly (Emmanuel).

2004-03-10 11:39  PeterB

	* configure.in: when $prefix is `NONE', replace with correct
	default `/usr/local'.

2004-03-08  Pawel Salek

	* libbalsa/folder-scanners.[ch]: pass around Marked mailbox flag.
	* libbalsa/mailbox.c: lock mailbox in ::set_threading.
	* src/balsa-index.c: set fixed column sizes.
	* src/balsa-mblist.c: use Marked mailbox flags.
	* src/mailbox-node.c: ditto.

2004-03-07  Pawel Salek

	* configure.in: check for gtk2.3
	* libbalsa/Makefile.am: add option_menu.[hc]
	* libbalsa/files.c: try harder when looking for images.
	* libbalsa/mailbox.c: use fixed_height gtk2.4 mode.
	* libbalsa/imap/imap-{handle,tls}.c: silence.
	* src/Makefile.am: enable deprecated for gtk-2.4
	* src/ab-window.c: use option_menu
	* src/store-address.c: ditto.
	* src/balsa-index.c: setup fixed_height mode.
	* src/mailbox-conf.c: compile against gnome-2.6
	* src/main.c: do not panic on missing icons.
	* src/pref-manager.c: ask gnome-2.6 to enable deprecated stuff.

2004-03-07 12:33  PeterB

	* libbalsa/filter.c, libbalsa/filter.h, libbalsa/libbalsa.h,
	libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/message.c, libbalsa/message.h,
	libbalsa/imap/imap-commands.c, libbalsa/imap/imap-search.c,
	src/filter-run-callbacks.c: re-enable filters.

2004-03-06 16:59  PeterB

	* libbalsa/body.c: check for NULL GMime filter.
	* libbalsa/: mailbox.c, message.c: lock source mailbox when copying
	or moving messages.
	* libbalsa/libbalsa_private.h: complete previous commit.
	* libbalsa/: libbalsa_private.h, mailbox_imap.c: define and use
	HAVE_MAILBOX_LOCKED(mailbox) to check locking.
	* libbalsa/body.c, libbalsa/mailbox-filter.c,
	libbalsa/mailbox_imap.c, libbalsa/imap/imap-commands.c,
	src/balsa-index.c, src/balsa-message.c: plug memory leaks.

2004-03-05  Pawel Salek

	* libbalsa/mailbox_imap.c: use single API for one and multiple
	message copying/flagging.

	* libbalsa/imap/imap-commands.[hc]: add function for copying
	multiple messages. merge store_flag and store_flag_m().
	
2004-03-04 15:02  PeterB

	* libbalsa/mailbox_mbox.c: crlf-filter message parts, not the whole
	message.
	* libbalsa/filter-funcs.c: step over closing '"'.
	* configure.in, libbalsa/html.c: require gmime-2.0 >= 2.1.2; drop
	HAVE_GMIME21.

2004-02-03  Pawel Salek

	* libbalsa/imap/imap-auth.c: cleanup.
	* libbalsa/imap/imap-commands.[hc]: use proper UTF-7 encoding.
	* libbalsa/imap/imap-handle.[hc]: ditto. Cleanup.
	* libbalsa/imap/util.[hc]: add routines for UTF-7 encoding.

2004-02-30  Pawel Salek

	* configure.in, NEWS: release 2.1.1
	* libbalsa/mailbox.c: do not die when an unvisible message is
	  modified.
	* src/main-window.c: improve filtering support.

2004-02-29 11:22  PeterB

	* src/balsa-index.c: emit "changed" signal even when no message is
	selected.
	* src/main-window.c: implement persistent search-iters.
	* src/: balsa-index.c, balsa-index.h: implement persistent
	search-iters; rearrange search code.
	* libbalsa/mailbox_local.c: new name for match_condition.
	* libbalsa/mailbox_imap.c: implement persistent search-iters.
	* libbalsa/: mailbox.c, mailbox.h: support persistent search-iters.
	* libbalsa/: filter.c, filter.h: rename match_condition as
	libbalsa_condition_matches; implement libbalsa_condition_can_match.

2004-02-28  Pawel Salek

	* libbalsa/filter-funcs.c: implement libbalsa_condition_new_date()
	* libbalsa/filter.h: add proper prototype.
	* libbalsa/mailbox_imap.c: fix lbmi_build_imap_query to handle
	properly multiple fields to be searched for simultaneously.
	* libbalsa/imap/imap-commands.c: adapt to changes in imap_write_key()
	* libbalsa/imap/imap-handle.c: move IS_ATOM_CHAR to imap_private.h
	* libbalsa/imap/imap_private.h: add this macro here.
	* libbalsa/imap/imap-handle.h: add searching for sizes and dates.
	* libbalsa/imap/imap-search.c: ditto.
	* src/main-window.c: extend the test.

2004-02-27 07:06  PeterB

	* src/main-window.c: don't free the condition used by find_real.
	* src/: balsa-index.c, balsa-index.h: use LibBalsaMailboxSearchIter
	and revise search code; remove unnecessary searches; remove
	"row-collapsed" signal handler.
	* libbalsa/: mailbox_imap.c, mailbox_local.c: new api for
	message_match class method; new search_iter_free class method for
	freeing backend-specific data.
	* libbalsa/: mailbox.c, mailbox.h: implement LibBalsaMailboxSearchIter:
	change api for libbalsa_mailbox_message_match;
	implement libbalsa_mailbox_search_iter_{new,free,step};
	remove libbalsa_mailbox_find.
	* libbalsa/filter-funcs.c: add missing lines (typos?).

2004-02-26  Abel Cheung  <maddog@linux.org.hk>

	* balsa.desktop: Fix badly encoded strings.

2004-02-26  Pawel Salek

	* libbalsa/imap/imap-commands.[hc]: add imap_mbox_filter_msgnos().
	* libbalsa/imap/imap-commands.c: 1. send 8-bit strings to servers
	without LITERAL+. 2. Send long queries right.
	* libbalsa/imap/imap-handle.c: Part two of 2.
	* libbalsa/imap/imap-search.c: Part two of 1.
	* src/main-window.c: Modify the search stress-tester.

2004-02-25  Pawel Salek

	* libbalsa/filter-funcs.c: add libbalsa_condition_new_string().
	* libbalsa/filter.[hc]: remove IMAP stuff which does not belong there.
	* libbalsa/mailbox_imap.c: build imap queries here - adapt to
	new 8-bit safe style.
	* libbalsa/imap/Makefile.am: add imap-search.c

	* libbalsa/imap/imap-commands.[ch]: adapt to new 8-bit safe searching
	style.
	* libbalsa/imap/imap-handle.c: move state macros to imap_private.h
	* libbalsa/imap/imap_private.h: 
	* libbalsa/imap/imap-handle.h: recognize more extensions.

	* src/main-window.c: add a demo for new matching code.

2004-02-22  Pawel Salek

	* libbalsa/imap-server.c: support SSL/imaps.
	* libbalsa/imap/imap-handle.[ch]: ditto.
	* libbalsa/imap/imap{-tls.c,_private.h}: share TLS/SSL routines.

2004-02-20 12:19  PeterB

	* src/sendmsg-window.c: use accessor function
	libbalsa_message_find_user_hdr() instead of accessing
	message->headers->user_hdrs directly.

2004-02-18  Pawel Salek

	* libbalsa/imap-server.c: compare agains a number of certificates.
	* libbalsa/imap/imap-tls.c: correctly check wildcard certificates.

2004-02-15 13:16  PeterB

	* src/main-window.c: get balsa_app.mblist_width and
	balsa_app.notebook_height from gtk_paned_get_position() instead of
	from allocation dimensions (avoids dimension creep when they're
	used in gtk_paned_set_position()).
	* libbalsa/: mailbox.c, mailbox_imap.c: revert yesterday's
	change--lock the mailbox in imap_flags_cb() instead of in
	libbalsa_mailbox_messages_status_changed().

2004-02-14  Pawel Salek

	* libbalsa/imap-server.c: store certificated accepted for the session.
	* libbalsa/mailbox_imap.c: use proper hierarchy delimiter.
	* libbalsa/server.c: handle NULL passwords.
	* src/balsa-index.c: do not try scrolling when no messages are present.
	* src/folder-conf.c: connect ask_password.

2004-02-14 07:17  PeterB

	* libbalsa/mailbox.c: lock mailbox while changing message flags.
	* libbalsa/body.c: check this body's id only if it has a mime-part.

2004-02-13 23:18  PeterB

	* libbalsa/send.c: prohibit smtp from sending Status and X-Status
	headers.
	* libbalsa/mailbox_pop3.c: set RECENT flag on incoming messages (as
	well as NEW).

2004-02-12  Pawel Salek

	* libbalsa/libbalsa.c: extra debugging for cert validation.
	* libbalsa/mailbox.c: use set_static_string() whenever possible.
	* libbalsa/message.c: 
	* src/balsa-message.c: delay "set_read()" as much as possible.
	* libbalsa/mailbox_imap.c: reduce RTT on open and on fetching new msgs.

2004-02-13 11:36  PeterB

	* libbalsa/mailbox_mbox.c: set msg_info.start as
	g_mime_parser_get_from_offset() instead of end of previous message
	(they can be different, if previous message has trailing garbage,
	like some sent by the Balsa list-server!).

2004-02-12 21:44  PeterB

	* libbalsa/mailbox_local.c, libbalsa/mailbox_local.h,
	libbalsa/mailbox_maildir.c, libbalsa/mailbox_mbox.c,
	libbalsa/mailbox_mh.c, src/main-window.c: remove
	LibBalsaMailboxLocal::msg_list.
	* libbalsa/mailbox_mbox.c: set message->msgno and message->mailbox
	when creating msg_info.message.

2004-02-11 21:48  PeterB

	* src/balsa-message.c: possible fix for bug #134173.
	* libbalsa/send.c: msg_queue_item_new() doesn't need to set
	LibBalsaMessage; use libbalsa_mailbox_get_message() instead of
	LIBBALSA_MAILBOX_LOCAL(outbox)->msg_list; lock/unlock only if
	BALSA_USE_THREADS.
	* libbalsa/mailbox_pop3.c: use libbalsa_mailbox_get_message()
	instead of LIBBALSA_MAILBOX_LOCAL()->msg_list.
	* libbalsa/mailbox_mbox.c: rewrite message status headers in place,
	if possible; use new GMime g_mime_parser_set_respect_content_length
	API to avoid bar From_ lines in libmutt mboxes; use only one
	GMimeStream to access mbox when syncing; fix interpretation of 'O'
	status flag ('O' => not recent).
	* libbalsa/mailbox_local.c: fix comment.
	* libbalsa/mailbox.c: check whether mailbox->msg_tree has been
	created.

2004-02-09  Pawel Salek

	* libbalsa/mailbox.c: be more careful when destroying msg_tree.
	Set holding_thread carefully.
	* libbalsa/message.c: first check, then thread.
	* libbalsa/imap/imap-commands.c: set unseen on reopening.
	* src/balsa-index.[ch]: scroll to last if no unseen.
	* src/main-window.[ch]: remove deadlocks in a brute way.

2004-02-08  Pawel Salek

	* libbalsa/mailbox.h: add first_unseen field.
	* libbalsa/mailbox_{imap,local}.c: add support for it.
	* src/balsa-index.[ch]: use it to scroll on open.
	* src/main-window.c: ditto.

2004-02-08 Darko Obradovic <dobradovic gmx.de>

	* src/main-window.c: fix 114041

2004-02-08  Pawel Salek

	Install as default mailer if requested by user (see bug 131606,
	closely based on the patch by Michael Petullo)
	* libinit_balsa/Makefile.am: add balsa-druid-page-defclient.[hc]

	* libinit_balsa/balsa-druid-page-{directory,finish,user,welcome}.c:
	* libinit_balsa/helper.c: remove 1.x remainings.
	* libinit_balsa/balsa-initdruid.c: plug in defuser page.
	* src/balsa-app.h: add default_client field.
	* src/main.c: update gconf data if requested.
	* src/save-restore.[hc]: implement config_defclient_save().

2004-02-07 18:08  PeterB

	* src/sendmsg-window.c: Steve Wall <balsa-user@wallfamily.us>;
	smarter choice of identity, better handling of signatures.

2004-02-07  Pawel Salek

	* libbalsa/mailbox.[hc]: do not sort/thread unless requested.
	Add persistent view filters.
	* libbalsa/mailbox_imap.c: modify accordingly.
	* libbalsa/mailbox_{local,maildir,mbox,mh}.c: ditto.
	* libbalsa/{message,send}.c: do not thread without need.
	* src/balsa-app.h: remove global view filter - do it per mailbox.
	* src/main-window.[hc]: support for per-mailbox view filters.
	* src/save-restore.c: config support for that.

	(part 2)
	* src/main-window.c: (msg) thread in (p)thread without gdk lock
	* libbalsa/mailbox.c(lbm_threads_enter): support for nested gdk locks.
	* libbalsa/mailbox_imap.c, libbalsa/imap/imap_commands.[hc]:
	obey the namespace rules.
	
2004-02-06 05:20  PeterB

	* libbalsa/mailbox_mbox.c: change parser to check for start < end
	before adding message; make sure message is terminated with '\n',
	and add one blank line before From_ line; remove dead code; remove
	Content-Length headers when armoring; pop up warnings when
	add_message fails.

2004-02-04  Pawel Salek

	* libbalsa/folder-scanners.[hc]: add IMAP error handling.
	* libbalsa/imap-server.c: show more info when certificate verify fails.
	* libbalsa/libbalsa.c: ditto.
	* libbalsa/libbalsa.h: try introducing GError to libbalsa.
	* libbalsa/misc.c: fix libbalsa_expand_path() and sig problem.
	* libbalsa/imap/imap-handle.c: error handling.
	* src/mailbox-node.c: receive GError.

2004-02-04 09:00  PeterB

	* libbalsa/mailbox.c: simplify handling of unread message count and
	flag.
	* libbalsa/imap-server.c, libbalsa/imap-server.h, src/main.c:
	implement --debug-imap (-D) switch to control monitoring imap
	server dialog.

2004-02-03  Pawel Salek

	* libbalsa/imap-server.c: store accepted certificates.
	* libbalsa/libbalsa.c: small fixes to the verification dialog.
	* libbalsa/send.c: cleanup.
	* libbalsa/imap/imap-handle.c: improve RFC2595 conformance.
	* libbalsa/imap/imap-tls.c: ditto.
	* libbalsa/imap/imap-handle.h: add using_tls field.
	* libbalsa/imap/imap.h: add IMAP_UNSECURE result.

2004-02-03 00:07  PeterB

	* libbalsa/mailbox_imap.c: update unread_messages when server
	notifies us about a change in LIBBALSA_MESSAGE_FLAG_NEW.

2004-02-02 08:34  PeterB

	* libbalsa/mailbox_pop3.c: use rmdir to remove temp mailbox.

2004-02-01  Pawel Salek

	(correcting myself)
	* libbalsa/libbalsa.h: fix the build ---disable-threads
	* libbalsa/imap/imap-tls.c: same.
	* libbalsa/imap/auth-cram.c: initialize pointers.

2004-02-01  Pawel Salek

	* libbalsa/imap-server.c: try harder on failed cert verification.
	* libbalsa/libbalsa.[ch]: convert UI of cert v-fy to the new code.
	* libbalsa/imap/imap-tls.c: fix SSL threading. Improve server v-fy.

2004-02-01  Robert Sedak  <robert.sedak@sk.htnet.hr>

        * configure.in: Added "hr" (Croatian) to ALL_LINGUAS.

2004-02-01 10:06  PeterB

	* libbalsa/: address-entry.c, address-entry.h: streamline includes.
	* libbalsa/address-entry.c: replace control characters with spaces;
	fill input after button press event (should fix vanishing
	addresses); don't add null addresses to list.

2004-01-28  Pawel Salek

	* libbalsa/imap/imap-commands.c: temporary workaround for
	appending messages containing NUL characters.

2004-01-28 23:53  PeterB

	* libbalsa/: mailbox_local.c, mailbox_local.h, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c, message.c, message.h: make
	GMimeMessage for mbox only when needed; implement
	fetch_message_structure method for mbox; populate message headers
	for mbox at parse time instead of load-message time; move release
	method from local backends to LibBalsaMailboxLocal; add separate
	GMimeMessage argument to libbalsa_message_headers_update.
	* libbalsa/mailbox_pop3.c: use a local variable instead of dynamic
	cast.
	* libbalsa/pop3.c: copy uid to caller's buffer only if it's valid.
	* libbalsa/imap/: imap-commands.c, imap-handle.h: implement
	imap_mbox_find_unseen(): gets the list and count of unseen
	messages.
	* libbalsa/mailbox_imap.c: implement lbm_imap_get_unseen(): gets
	unread messages and sets mailbox->unread_messages and
	mailbox->has_unread_messages.

2004-01-25 20:25  PeterB

	* libbalsa/imap/imap-tls.c: compile with threads disabled.
	* libbalsa/source-viewer.c: plug memory leak.
	* libbalsa/address-entry.c, libbalsa/send.c, src/balsa-mblist.c,
	src/main.c, src/sendmsg-window.c: plug memory leaks.

2004-01-25  Pawel Salek

	Do not store authorization data in ImapMboxHandle.
	* libbalsa/imap-server.c: make imap alerts work with balsa.
	* libbalsa/mailbox.c: stick to C comment style.
	* libbalsa/mailbox_imap.c: decode attachment names. clean cache.

	* libbalsa/imap/auth-cram.c: use user_cb to get whatever
	authorization data is needed.
	* libbalsa/imap/imap-auth.[hc]: same.	
	* libbalsa/imap/imap{-handle.c,_private.h}: remove user/pass fields.
	* libbalsa/imap/imap-tls.c: get user acceptance.
	* src/information-dialog.[hc]: display messages in the status bar.
	* src/pref-manager.c: configure this.
	
2004-01-25 10:14  PeterB

	* src/: balsa-app.c, balsa-app.h, balsa-mblist.c, pref-manager.c,
	save-restore.c: use bold and oblique names to indicate mailboxes
	with unread mail and folders containing such mailboxes,
	respectively; remove all support for balsa_app.mblist_unread_color.

2004-01-24 13:01  PeterB

	* src/: balsa-message.c, balsa-message.h: BalsaMessage can subclass
	GtkNotebook--no need for a container.
	* src/balsa-message.c: connect only to widget signals, so they are
	disconnected automatically when widget is destroyed.
	* libbalsa/mailbox.c, libbalsa/mailbox.h, src/balsa-index.c: New
	mailbox column LB_MBOX_STYLE_COL, which is PANGO_STYLE_OBLIQUE for
	a message with unread children.

2004-01-23 00:36  PeterB

	* libbalsa/body.c: Make sure subject in embedded header is valid
	utf-8.
	* src/balsa-message.c: set message background correctly for all
	known themes; reset header colors when theme is changed.

2004-01-22 16:43  PeterB

	* libbalsa/mailbox_mbox.c: check for new messages before syncing;
	escape "From " lines when rewriting mailbox.

2004-01-22  Pawel Salek

	* configure.in: add USE_TLS flag for compatibilty with libesmtp.
	* libbalsa/libbalsa.c: compile --with-ssl
	* libbalsa/mailbox.c: remove false warnings.
	* libbalsa/imap/Makefile.am: add imap-tls.c

	* libbalsa/imap/imap-commands.c: update manually flags when doing
	Flags.Silent.
	* libbalsa/imap/imap-commands.h: add imap_handle_starttls().
	* libbalsa/imap/imap-handle.c: use TLS when available.
	* libbalsa/imap/siobuf.[hc]: merge updates from libesmtp.
	* src/balsa-app.[hc]: cleanup libmutt remainings.
	* src/main.c: ditto.
	* src/main-window.c: remove debugging output.
	
2004-01-22 06:14  PeterB

	* libbalsa/message.c: Make sure subject is valid utf-8.

2004-01-21 15:03  PeterB

	* src/message-window.c: Add `next unread' item to message menu with
	ctrl+N binding, and manage its sensitivity; add zoom controls for
	html parts.
	* src/balsa-message.c: In a multipart message, make current_part
	the part that's actually shown instead of the multipart parent.

2004-01-20 16:59  PeterB

	* src/balsa-index.c: expand tree on opening, if requested.
	* src/main-window.c: frame the paned contents.

2004-01-19 22:41  PeterB

	* src/: balsa-message.c, balsa-message.h: make BalsaMessage
	subclass GtkVbox instead of GtkViewport--no need for scrollbars
	since it became a notebook, and the frame is just visual clutter.
	* src/balsa-message.c: use macros to access header text and message
	content widgets; set border and background colors of header widget
	from theme colors; set background of message to base of message
	text, even with pixmap themes.
	* src/balsa-index.c: disable experimental code.
	* libbalsa/mailbox.c: move declarations to start of block; check
	that tree-view widget is realized.
	* src/sendmsg-window.c: show window before setting `From:' address,
	so its text doesn't get selected.

2004-01-18  Pawel Salek

	* libbalsa/html.c: compile against libgtkhtml2.
	* libbalsa/imap-server.c: remove servers from hash on finalize.
	* libbalsa/address.c: set fallback charset globally.
	* libbalsa/mailbox.c: ditto. Make iterators work correctly even
	for closed mailboxes.
	* libbalsa/mailbox_imap.c: sanitize subjects.
	* libbalsa/mailbox_mbox.c: keep quiet if you have nothing to say.
	* libbalsa/misc.[hc]: support for setting fallback codeset.
	* libbalsa/rfc3156.c: adjust apriopriately.
	* libbalsa/source-viewer.c: same.
	* src/{balsa-message,pref-manager,print,save-restore,sendmsg-window}.c:
	ditto.

2004-01-17 16:40  PeterB

	* src/balsa-message.c: implement and use bm_message_widget to
	create the main message and to put a frame around an embedded
	message; set the background style of the view-port instead of using
	an event-box.

2004-01-15 22:13  PeterB

	* src/: balsa-message.c, balsa-message.h: Nest embedded messages
	with increasing border width.
	* src/balsa-message.c: Set embedded headers in the same style of
	widget as message headers.

2004-01-14 17:53  PeterB

	* src/balsa-bonobo.c: use new api for add_attachment.
	* src/: main.c, sendmsg-window.c, sendmsg-window.h: fix GNOME
	bugzilla #126379: show attachments when invoked with `-a' (Mike
	Petullo <mike@flyn.org>).

2004-01-14 09:43  PeterB

	* src/balsa-index.c: Use balsa_index_selected_list instead of
	gtk_tree_selection_get_selected_rows to view message source: it's
	simpler and doesn't introduce a dependence on gtk+-2.0 version
	2.2.x.
	* libbalsa/mailbox_mh.c: Use libbalsa_str_has_prefix for
	compatibility with older glib-2.0.
	* libbalsa/mailbox.c: Suppress some debugging messages.
	* libbalsa/: misc.c, misc.h: Implement libbalsa_str_has_prefix as a
	compatibility wrapper for g_str_has_prefix.
	* configure.in: Check whether we have glib-2.0 version 2.2.0 or
	newer.

2004-01-13 23:45  PeterB

	* libbalsa/mailbox.c: Flag partial messages so we don't keep making
	the whole message.
	* src/print.c: Use GMime filter to print text/enriched and
	text/richtext parts as html.
	* src/balsa-message.c: Detect when GMime can filter text/enriched
	and text/richtext; use libbalsa_mailbox api; use g_list_free1() to
	free a list of one item.
	* src/balsa-index.c: Plug a memory leak.
	* configure.in, libbalsa/html.c, libbalsa/html.h, libbalsa/mime.c:
	Detect when GMime can filter text/enriched and text/richtext.
	* libbalsa/message.c, src/sendmsg-window.c: Keep references in the
	correct order.

2004-01-11  Pawel Salek

	* Makefile.am: add intltool-*.in to EXTRA_DIST
	* NEWS: release 2.1.0
	* balsa.spec.in: wrap gmime in.
	* libbalsa/libbalsa.c: clear some libmutt remainings.

	* libbalsa/mailbox_imap.c: set address to null if strings are null
	for consistency with the rest of balsa.
	* src/Makefile.am: add Balsa.idl to EXTRA_DIST.
	* src/main-window.c: update author list.

2004-01-11 15:54  PeterB

	* libbalsa/: mailbox.c, mailbox.h, mailbox_imap.c, mailbox_local.c,
	message.c, message.h, imap/imap-commands.c, imap/imap-handle.c,
	imap/imap-handle.h: add GMimeContentType *content_type member to
	LiBBalsaMessageHeaders and remove related gboolean members from
	LiBBalsaMessage; fix libbalsa_message_set_header_from_string(); use
	BODY.PEEK[HEADER.FIELDS (CONTENT-TYPE)] to get content-type for
	imap messages; untested support for message/partial.
	* src/balsa-message.c: Plug a memory leak; allow 2-pixel motion
	tolerance when activating a URL.

2004-01-11  Pawel Salek

	* libbalsa/filter-funcs.[hc]: fix remaining problems with
	converting LibBalsaCondition to/from string.
	* src/filter-edit-{callbacks,dialog}.c: edit conditions correctly.
	* src/save-restore.c: append filters to the filter list.

	* libbalsa/mailbox_imap.c: enable server-side copy under certain
	conditions.
	* libbalsa/imap/imap-commands.[hc]: add imap_mbox_handle_copy().

2004-01-10 05:28  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox.h, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/mailbox_maildir.c,
	libbalsa/mailbox_mbox.c, libbalsa/mailbox_mh.c,
	libbalsa/mailbox_pop3.c, libbalsa/send.c, src/balsa-mblist.c,
	src/main-window.c, src/message-window.c: Replace total_messages
	member of LibBalsaMailbox with libbalsa_mailbox_total_messages();
	add total_messages method to LibBalsaMailboxClass and implement in
	backends.

2004-01-09 06:11  PeterB

	* libbalsa/imap/imap-handle.c: Free all of ImapAddress.
	* libbalsa/mime.c: Don't assume body has a mime-part.

2004-01-07 19:15  PeterB

	* libbalsa/mailbox_imap.c: Fix last commit.
	* src/balsa-mblist.c: new_messages member has gone away.
	* src/balsa-index.c: Don't connect to column "clicked"; remove
	callback and simplify helpers; use LibBalsaMailboxColumn enum.
	* libbalsa/send.c: Rethread after copying to fccbox.
	* libbalsa/message.c: Rethread destination after moving and copying
	messages.
	* libbalsa/mailbox_pop3.c: messages member has gone.
	* libbalsa/mailbox_mh.c: messages and new_messages members have
	gone; leave inserting message to the check method.
	* libbalsa/mailbox_mbox.c: new_messages and messages members have
	gone.
	* libbalsa/mailbox_maildir.c: Add load_config method for setting
	curdir and newdir members; messages and new_messages members have
	been dropped; leave inserting a new message to the check method.
	* libbalsa/mailbox_local.h: Change api for load_message class
	method and libbalsa_mailbox_local_load_messages().
	* libbalsa/mailbox_local.c: Move message init from
	libbalsa_mailbox_local_load_messages() to
	libbalsa_mailbox_local_load_message(); add msgno argument to
	libbalsa_mailbox_local_load_message(); use
	libbalsa_mailbox_msgno_filt_{in,out}.
	* libbalsa/: mailbox.c, mailbox.h: Drop redundant sort_column_id
	and order members, and use view->sort_field and view->sort_type
	instead; drop messages and new_messages members;
	libbalsa_mailbox_set_msg_tree() and lbm_update_msg_tree() must
	handle a new tree with different messages from the current tree.

2004-01-06  Pawel Salek

	* libbalsa/mailbox.[ch]: add libbalsa_mailbox_change_msgs_flags()
	to change many flags of many messages in one transaction. Fix
	handling of "deleted" flag in
	libbalsa_mailbox_messages_status_changed().

	* libbalsa/mailbox_imap.c: subclass it for IMAP - particularly
	important! lbm_imap_construct_body(): set ::filename in the same
	way as GMime does. Create message structure in same way as the
	rest of balsa does.

	* libbalsa/message.c: use change_msgs_flags().

	* libbalsa/imap/imap-commands.c: support for change_msgs_flags().
	Sort by MSGNO for filtered views.
	* libbalsa/imap/imap.h: add IMSO_MSGNO enum.
	* libbalsa/imap/imap-handle.c: make mbox_view_append_no() visible.
	
2004-01-06 15:38  PeterB

	* src/balsa-message.c: Show and hide the appropriate widgets.

2004-01-04  Carlos Morgado  <chbm gnome.org>

	* src/balsa-bonobo.c: 
	* src/main.c: 
	implement the other cli options

2004-01-04  Pawel Salek

	* libbalsa/mailbox.[hc]: add filt_in and filt_out methods in an
	attempt to filter in and out message.
	* libbalsa/mailbox_imap.c: do not mix sorting with threading - too
	slow.
	* libbalsa/message.h: do not waste flag bits.
	* src/balsa-index.c: unbreak message searching.
	* src/balsa-message.[hc]: bug 127776.

2004-01-04  Francisco Javier F. Serrador  <serrador@cvs.gnome.org>

	* src/main.c: Fixed typo staartup-->startup	

2004-01-04  Carlos Morgado  <chbm gnome.org>

	* src/Balsa.idl: 
	* GNOME_Balsa.server.in: 
	Balsa_Application
	
	* src/balsa-bonobo.h: 
	* src/balsa-bonobo.c: 	
	* src/main.c: 
	implement -c
	
2004-01-03  Pawel Salek

	* libbalsa/filter-funcs.c: implement {append,get}_quoted_string()
	that were missing.
	* libbalsa/filter.c: make nicer IMAP queries.
	* libbalsa/imap-server.[hc]: fix connection caching for servers
	without UNSELECT broken in last commit.
	* libbalsa/mailbox.[ch]: add update_view_filter() method.
	* libbalsa/mailbox_{imap,local}.c: implement it.
	* libbalsa/imap/imap-commands.c: fix returning failure codes.
	* libbalsa/imap/imap-handle.c: matching part.
	* src/balsa-app.h, : add view_filter field.
	* src/balsa-index.c: 
	* src/main-window.[ch]: save view filters.
	* src/save-restore.c: ditto.
	
2004-01-01  Pawel Salek

	* libbalsa/filter-file.c: remove old LibBalsaCondition config IO.
	* libbalsa/filter-funcs.c: more compact string representation of
	match keys. 
	* libbalsa/filter-funcs.h: renamed filed adjustments.
	* libbalsa/filter.[hc]: just compile the code.
	* libbalsa/imap-server.c: reuse connections better(?).
	* libbalsa/libbalsa.h: add LibBalsaCondition typedef.
	* libbalsa/mailbox.[ch]: make libbalsa_mailbox_set_view_filter()
	work.
	* libbalsa/mailbox_imap.[hc]: view-related changes.
	* libbalsa/imap/imap-commands.[hc]: add imap_mbox_unselect() and
	imap_sort_filter(),
	* libbalsa/imap/imap-handle.[hc]: expand the IMAP extension list.
	* src/balsa-index.[hc]: view-related changes.
	* src/filter-edit-{callbacks,dialog}.c:
	* src/filter-run-callbacks.c: LibBalsaCondition related changes.
	* src/main-window.c: filter-related changes.
	* src/pref-manager.c: remove hide-deleted from here.
	* src/save-restore.c: ditto.
	
2004-01-01  Carlos Morgado  <chbm gnome.org>

	* libbalsa/html.c: 
	fix build glitch

2003-12-31 08:30  PeterB

	* libbalsa/: html.c, html.h: Provide wrappers to insulate the rest
	of Balsa from the differences between the gtkhtml[23] APIs.
	* src/print.c: Use new html api for printing; use only
	libbalsa_message_body_get_content_type() to get content-type.
	* src/main-window.c: Use copy-text capability of gtkhtml3, when
	installed; compile without gtkhtml.
	* src/: balsa-message.c, balsa-message.h: Use new html api; support
	text/enriched and text/richtext.
	* libbalsa/misc.c: Use select-all capability of gtkhtml3 when
	installed.
	* libbalsa/mime.c: Support text/enriched and text/richtext;
	include text of html parts when replying; plug a memory leak.
	* libbalsa/mailbox_mbox.c: g_mime_content_type_is_type() doesn't
	match "*" in main part of type.
	* libbalsa/Makefile.am: Add html.[ch] to dependencies.
	* configure.in: Detect gtkhtml3 if installed in preference to
	gtkhtml2, when --enable-gtkhtml is used.

2003-12-26 15:52  PeterB

	* src/balsa-index.c: More care needed with new threading and sync.
	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c: Queue
	sync after changing flags.
	* libbalsa/: mailbox_local.c, mailbox_local.h: Thread msg_tree in
	place; sync in idle handler after changing flags.
	* libbalsa/mailbox_imap.c: After threading, use
	libbalsa_mailbox_set_msg_tree() to set the new tree; allow sorting
	with threading.
	* libbalsa/: mailbox.c, mailbox.h: Lookup and cache GtkTreeModel
	signals; setup mailbox when opening instead of at init time; thread
	after adding or moving messages; implement and use
	lbm_threads_leave(); allow for sync in an idle handler;
	lock mailbox when threading; implement and use lightweight
	mbox_model_get_path_helper(); add helpers for subclass threading
	methods.
	* libbalsa/imap-server.c: Don't skip the next handle when deleting
	one.

2003-12-23  Carlos Morgado  <chbm gnome.org>

	* src/balsa-bonobo.c (impl_balsa_composer_sendMessage): 
	bonobo reclaims its buffers (duh) - unbreak balsa -m

2003-12-20 08:04  PeterB

	* libbalsa/mailbox_mbox.c: Reuse LibBalsaMessageBody when reparsing
	during sync.
	* libbalsa/body.c: Use existing LibBalsaMessageBody, if any, when
	setting mime-body; do libbalsa_message_body_set_mime_body() in
	steps.

2003-12-16 19:47  PeterB

	* src/balsa-index.c: Use LibBalsaMailbox's "changed" signal; remove
	style-setting code (style should be set by LibBalsaMailbox).
	* libbalsa/send.c: Set the charset of a "text/*" attachment as
	"us-ascii" if it's all 7-bit, or "utf-8" if it validates, else
	retype as "application/octet-stream"; plug address-related memory
	leaks.
	* libbalsa/mailbox_mbox.c: Encode text parts as quoted-printable
	and escape "From " lines.
	* libbalsa/mailbox_local.c: Use LibBalsaMailbox's "changed" signal.
	* libbalsa/: mailbox.c, mailbox.h: Replace "messages-added" signal
	with a general-purpose "changed" signal, and emit when messages
	might have been expunged.
	* src/balsa-app.c: Remove imap keep-alive code--it's now handled by
	LibBalsaImapServer.
	* libbalsa/mailbox_imap.c: Remove unnecessary mailbox locking.
	* libbalsa/imap-server.c: Keep active connection alive; use
	client-side of monitor to track activity; use a subthread without
	gdk lock to avoid confusing libbalsa_mailbox_msgno_changed; plug
	memory leak in force-disconnect.

2003-12-16  Carlos Morgado  <chbm gnome.org>

	* src/balsa-bonobo.c (Message): 
	* src/main.c (Message): 
	-a works, change behaviour on first -m invocation. 
	maybe the old behaviour was better.
	
2003-12-15  Carlos Morgado  <chbm gnome.org>

	* GNOME_Balsa.server.in (Repository): 
	* Makefile.am (Message): 
	* src/main.c (Message): 

	* src/balsa-bonobo.h (Message): 
	* src/balsa-bonobo.c (Message): 
	* src/Makefile.am (Message): 
	
	implement new_message bonobo interface and use it. 
	balsa no longer spawns a new process for balsa -m.
	you must make install to make the .server file make it's way to 
	/usr/lib/bonobo/servers
	
2003-12-10 15:45  PeterB

	* src/message-window.c: Idle handler must return FALSE (Nuno
	Monteiro <nuno@itsari.org>); manage sensitivity of next-flagged
	button, too.

2003-12-09 10:37  PeterB

	* libbalsa/mailbox.c: Keep the tree-view better informed about
	changes in the mailbox.
	* src/: balsa-index.c, message-window.c: Always mark current
	message as read when user selects "next" anything.

2003-12-08 22:36  PeterB

	* src/message-window.c: Set a new message in the same
	message-window, instead of destroying it and creating a new one.

2003-12-07 19:38  PeterB

	* src/message-window.c: Manage sensitivity of next-unread toolbar
	button.

2003-12-02 15:26  PeterB

	* libbalsa/body.c: Unref the message returned by
	g_mime_message_part_get_message(); simplify set-mime-body
	recursion.
	* src/balsa-message.c: Display message/rfc822 (Pawel); simplify
	display-part recursion.

2003-12-01 20:42  PeterB

	* libbalsa/body.c: Store the content of a message/rfc822 message
	part as its child, not its sibling.
	* libbalsa/body.c: Treat message_part->mime_part as inline if it's
	a GMimePart.

2003-11-29  Pawel Salek

	* libbalsa/body.c: we can save msg body without mime_part.
	* libbalsa/mailbox_imap.c: translate msg structure in the same way
	the other drivers do. Fix caching of nested parts and memory leaks.

2003-11-23  Pawel Salek

	* libbalsa/mailbox_imap.c: fix memory leak.
	* libbalsa/imap/imap-handle.c: parameters are case-insensitive.

2003-11-26 12:15  PeterB

	* src/balsa-message.c: Handle nested multipart messages.
	* libbalsa/body.c: Ignore trailing characters in
	Content-Disposition.

2003-11-24 23:55  PeterB

	* libbalsa/body.c: Get a file descriptor for body->temp_filename,
	even when it has suffices.
	* libbalsa/body.c: Content of message/rfc822 is next part, not
	child part.

2003-11-24  Carlos Morgado  <chbm gnome.org>

	* src/main.c: remove Balsa.h dep for now

2003-11-24 14:42  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_local.c: Remove
	some now-redundant g_mime_stream_set_bounds() calls.
	* libbalsa/imap/: imap-commands.c, imap-commands.h: Add length
	argument to imap_mbox_append_stream().
	* libbalsa/: mailbox.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c: Ref/unref the message in
	libbalsa_mailbox_copy_message() instead of the subclass method.
	* libbalsa/mailbox_imap.c: Write message to a temp file, so we can
	pass its length to imap_mbox_append_stream(); ref/unref the message
	in libbalsa_mailbox_copy_message() instead of the subclass method.

2003-11-23  Carlos Morgado  <chbm gnome.org>

	* src/main.c: 
	* src/balsa-bonobo.h: 
	* src/balsa-bonobo.c: 
	* src/Makefile.am:
	one more small step 

2003-11-23 14:40  PeterB

	* libbalsa/mailbox.c: Mark mailbox as unsorted and invalidate iters
	when really closing.

2003-11-23  Pawel Salek

	* libbalsa/libbalsa.c: make the mailbox_lock recursive.
	* libbalsa/libbalsa_private.h, src/main.c: ditto.
	* libbalsa/mailbox.[hc]: continue filtered view implementation.
	* libbalsa/mailbox_imap.c: remove debugging output.

	* libbalsa/imap/{auth-cram,imap-auth,imap-commands,imap-handle}.c:
	allow for nested IMAP command execution.
	* libbalsa/imap/imap-handle.h: cleanup prototypes.
	* libbalsa/imap/imap_private.h: add cmd_queue and tasks lists.
	* src/balsa-index.c: preleminary call to filter_view().
	* src/main-window.c: alternative ui for view filtering.

2003-11-23 11:22  PeterB

	* libbalsa/mailbox.c: Before removing a node from the msg_tree,
	promote its children to be children of its parent.

2003-11-21 Darko Obradovic <dobradovic gmx.de>

	* src/balsa-app.h: set MAX_QUOTED_COLOR to 2.
	* src/pref-manager.c: simplify preferences.
	* src/save-restore.c: adjust accordingly.

2003-11-21 10:14  PeterB

	* src/balsa-mblist.c: Fix bug 127422.

2003-11-19 05:02  PeterB

	* src/balsa-index.c: Unref mailbox_node even when it has no
	mailbox.
	* libbalsa/send.c: Use the basename of the file path, not the full
	path, as the filename for the mime_part.
	* libbalsa/body.c: Set body->filename from mime_part.

2003-11-18 22:07  PeterB

	* libbalsa/send.c: Encoding goes on mime_part, not content.
	* libbalsa/send.c: Simplify call to
	libbalsa_message_create_mime_message(); call it when postponing,
	and save fcc in X-Balsa-Fcc header.
	* libbalsa/message.c: Get fcc_url from X-Balsa-Fcc header.
	* src/balsa-index.c: Clear index->current_message when destroying
	the index, as the destroy method seems to be called more than once.

2003-11-17 20:02  PeterB

	* libbalsa/mailbox.c, libbalsa/mailbox_local.c, libbalsa/message.c,
	src/balsa-index.c: Link DELETED messages into the mailbox;
	LIBBALSA_MESSAGE_FLAG_DELETED conceals other flags.

2003-11-18  Carlos Morgado  <chbm gnome.org>

	* configure.in: 
	* src/Makefile.am: 
	bonobo/ORBit stuff	

	* GNOME_Balsa.server.in.in: there should be a factory definition 
	around here somewhere. hum.

2003-11-17  Carlos Morgado  <chbm gnome.org>

	* src/balsa-bonobo.h (Repository): 
	* src/balsa-bonobo.c (Repository): 
	* src/Balsa.idl (Repository):
	new interface, Evo style doesn't fit us

	* idl/balsa.idl (Repository): 
	* idl/balsa-composer.idl (Repository): 
	made no sense being here
	

2003-11-17 08:23  PeterB

	* src/balsa-index.c: Rename message_status_changed_cb as
	bndx_row_changed_cb; use "row-changed" signal instead of
	"messages-status-changed", which may be emitted without the gdk
	lock; remove obsolete "messages-removed" signal handler.
	* libbalsa/message.c: Set flags before notifying the mailbox--the
	mailbox in turn triggers a UI change which needs the new flags.
	* libbalsa/mailbox_local.c: Cleanup.
	* libbalsa/: mailbox.c, mailbox.h: Remove obsolete
	"messages-removed" signal.

2003-11-16 20:09  PeterB

	* src/balsa-index.c: Select another message when current message is
	flagged as deleted.
	* libbalsa/message.c: Don't lock mailbox when looking up message
	properties.

2003-11-16  Carlos Morgado  <chbm gnome.org>

	* src/balsa-bonobo.h:
	* src/balsa-bonobo.c:
	* idl/balsa.idl:
	* idl/balsa-composer.idl:
	* src/main.c: 
	bonoboizaiton - lacking server implementation, makefiles

2003-11-15 07:41  PeterB

	* src/main-window.c: Add a weak pointer to window->current_message.
	* libbalsa/mailbox.c: Grab the gdk lock before invalidating mailbox
	iters.

2003-11-14 22:11  PeterB

	* src/sendmsg-window.c: Test for empty <> in address.
	* libbalsa/misc.c: Clear error in loop.
	* libbalsa/mailbox_maildir.c: Plug a memory leak; move a test to
	where it's really needed.
	* libbalsa/mailbox_mbox.c: Expunge deleted messages even if flags
	haven't changed.
	* libbalsa/: mailbox.c, mailbox.h: Implement
	libbalsa_mailbox_msgno_find()--gets an iter and a path for a given
	message number.
	* src/: balsa-index.c, balsa-index.h: Remove ref_table member; use
	libbalsa_mailbox_msgno_find() in bndx_find_message(); remove weak
	pointers when we don't need them.

2003-11-13 21:45  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: Fix pop3 checking, broken in change
	on 2003-11-11.
	* libbalsa/send.c: Attach the created GMimeMessage to the
	LibBalsaMessage; don't grab the gdk lock while enumerating smtp
	messages.
	* libbalsa/misc.c: Free only a non-NULL error.
	* libbalsa/mailbox.c: Implement GtkTreeDragSource
	interface--trivial, but necessary to support dnd.

2003-11-12 16:26  PeterB

	* src/balsa-message.c: Ref widget when passing to idle handler.
	* libbalsa/message.c: Message now owns mime message.
	* libbalsa/: mailbox_maildir.c, mailbox_mh.c: Message owns mime
	message, not the mailbox structure; restore chaining up in close
	method.
	* libbalsa/mailbox_mbox.c: Unref message when removing it from
	mailbox structure; restore chaining up in close method; message
	takes over ownership of mime message.
	* libbalsa/mailbox_imap.c: Update total_messages in EXISTS
	callback; compare count with mimap->messages_info->len instead of
	total_messages; combine signal disconnections into one.
	* libbalsa/mailbox.c: Give a milder warning when msgno is not
	found.
	* libbalsa/body.c: Get Content-Disposition using
	g_mime_object_get_header().
	* libbalsa/mailbox_imap.c: Update total_messages on expunge;
	disconnect signal handlers before releasing handle.
	* libbalsa/imap/imap-handle.c: Use correct error code.

2003-11-11 12:45  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: Move more checking and locking from
	subclasses to mailbox.c; clear message->mailbox when closing
	mailbox.
	* libbalsa/mailbox_mh.c: Fix editing error.
	* libbalsa/send.c, src/balsa-mblist.c, src/mailbox-node.c,
	src/main-window.c: Use MAILBOX_OPEN() macro.
	* libbalsa/: mailbox_local.c, mailbox_local.h:
	libbalsa_mailbox_local_load_messages() is now called with mailbox
	locked; implement new helper
	_libbalsa_mailbox_local_get_message_stream()--common code from
	maildir and mh.
	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_maildir.c,
	mailbox_mbox.c, mailbox_mh.c: Move locking and open-mailbox checks
	from subclasses to mailbox.c.

2003-11-10 11:57  PeterB

	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c: Don't
	expunge when _sync is called with expunge == FALSE.
	* src/balsa-index.c: Unset mailbox as the index's tree-model before
	closing the mailbox.
	* libbalsa/mailbox_imap.c: Ping mailbox only if it's connected.
	* libbalsa/: mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c:
	Really close only when open_ref == 0.

2003-11-09  Pawel Salek

	* libbalsa/mailbox_imap.c: be careful when doing noop.
	* libbalsa/message.[ch]: clean up message changing code.
	* libbalsa/send.c: ditto.
	* src/balsa-index.[ch]: adapt to changed API. 
	Fix crash on expunging messages in hidden mailbox.
	* src/{main,sendmsg}-window.c: ditto.

2003-11-07 00:23  PeterB

	* libbalsa/mailbox_mh.c: Find last_fileno when adding a message to
	a closed mailbox; save last_fileno after adding.

2003-11-06 23:45  PeterB

	* libbalsa/: mailbox_mh.c, mailbox_mh.h: Rework with a message hash
	table instead of a sparse array.
	* libbalsa/mailbox_mbox.c: Notify tree-model promptly when a
	message is removed from the mailbox's internal structures.

2003-11-05  Pawel Salek

	* libbalsa/mailbox.c: compile with --disable-threads.
	* libbalsa/mailbox_imap.c: do not deadlock in imap_sync().
	* src/balsa-index.c: clean up message_status_changed() - it is almost
	redundant now.

2003-11-04 16:25  PeterB

	* src/main-window.c: Check for unreffed mbnode.
	* libbalsa/mailbox_mbox.c: Build removed_list carefully.
	* libbalsa/mailbox.c: Grab gdk lock before emitting signal to a
	GtkTreeView.
	* libbalsa/mailbox_mbox.c: Give lbm_mbox_sync_real() a `closing'
	argument instead of `reparse', for consistency; drop a local
	variable; no need to check
	LIBBALSA_MAILBOX_CLASS(parent_class)->close_mailbox.
	* libbalsa/mailbox_maildir.c: Expunge on close.
	* libbalsa/mailbox_maildir.c: Close the mailbox with a
	close_mailbox method instead of close_backend; implement
	parse_mailbox_subdirs() helper; build list of removed messages when
	syncing, renumber higher-numbered messages, and notify the
	tree-model.
	* libbalsa/mailbox_local.c: Populate the msg_tree only with
	messages in the msg_list; allocate the msg_array enough space to
	store the highest numbered message.

2003-11-02 20:29  PeterB

	* libbalsa/mailbox_mbox.c: Remove close_backend method and
	reinstall it as close_mailbox; make mbox_sync a local helper with a
	'gboolean reparse' option; call it with reparse = FALSE in
	close_mailbox, to update the mailstore, and with reparse = TRUE in
	the new mbox_sync.
	* libbalsa/mailbox.c: Install default (noop) method for
	close_backend; modify msg_tree before getting a path for a new
	node; lock mailbox when syncing.

2003-11-02  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/mailbox_imap.c: smarter envelope prefetching.
	* libbalsa/imap/imap-commands.[hc], imap-handle.h: 
	implement imap_mbox_handle_fetch_set().

2003-11-01  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/mailbox.[hc]: move SortTuple to header file.
	* libbalsa/mailbox_imap.c: enable server side sorting.
	* libbalsa/imap/imap-commands.[ch]: some support in the library.
	* libbalsa/imap/imap-handle.h: add asc/desc flag.
	* libbalsa/imap/imap.h: add more sorting keys.

2003-10-31  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/server.c: make sure LibBalsaServer::host field is set.
	* src/sendmsg-window.c: do not crash on replying to a message with
        empty To: header.

2003-10-31 Pawel Salek

	* libbalsa/folder-scanners.c: fix yesterday's change.
	* libbalsa/mailbox{,_maildir,_mh}.c:
	* libbalsa/{misc,pop3,send}.c: ditto.

2003-10-30 Pawel Salek

	* libbalsa/{folder-scanner,misc,pop3,send}.c: 
	* libbalsa/mailbox_{maildir,mh}.c: compile with stricter standard
	compatibility.
	* libbalsa/mailbox.[hc]: initial interface for server-side sorting.
	* libbalsa/mailbox_imap.c: same.
	* libbalsa/imap/imap-handle.c: improve handling of embedded msgs.
	* src/main-window.c: use ssize_t when apriopriate.

2003-10-27 17:06  PeterB

	* libbalsa/filter.c: Avoid casting a (const gchar *) to (gchar *).
	* libbalsa/mailbox_imap.c: Update message->msgno after expunge.

2003-10-25 18:29  PeterB

	* libbalsa/: mailbox_imap.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c: Unref messages when closing mailbox.
	* src/balsa-mblist.c: Plug a memory leak.
	* src/balsa-index.c: Restore initial sort.
	* libbalsa/mailbox_imap.c: Imap `seen' flag has opposite sense to
	Balsa's `new' flag.
	* libbalsa/: mailbox.c, mailbox.h: Implement release_message
	method.
	* libbalsa/: mailbox_maildir.c, mailbox_mh.c: Add
	fetch_message_structure method and move creation of mime_msg to it
	from get_message; fetch_message_structure chains up to its parent's
	method; add release_message method, to unref message->mime_msg;
	make the mailbox's pointer to the mime_message a weak pointer.
	* libbalsa/: mailbox_local.c, mailbox_local.h: Implement
	_libbalsa_mailbox_local_get_mime_message, a helper for maildir and
	mh.
	* libbalsa/message.c: Use libbalsa_mailbox_release_message(); plug
	one memory leak.

2003-10-24 08:59  PeterB

	* libbalsa/imap/imap-handle.c: Remove always_has_data field and let
	the handlers check; use ir_check_crlf() to check syntax when
	response is empty.
	* libbalsa/mailbox_imap.c: Decode only nonNULL address phrase.
	* src/balsa-index.c: Get a bit further with message deletion.
	* libbalsa/imap/imap.h: Add ImapBody::content_uri--new in RFC 3051.
	* libbalsa/imap/imap-handle.c: Clarify BODY and BODYSTRUCTURE
	response handlers.
	* libbalsa/mailbox.c: Fix incorrect signal from 2003-10-22 commit.

2003-10-22 19:49  PeterB

	* libbalsa/: mailbox.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c: Let the tree-model know when a message is deleted.
	* libbalsa/: mailbox_imap.c, imap/Makefile.am,
	imap/imap-commands.c, imap/imap-commands.h: Use GMimeStream to
	append a message.
	* libbalsa/mailbox_mbox.c: Use
	libbalsa_address_to_gchar(message->headers->from, 0) instead of
	g_mime_message_get_sender(message->mime_msg).
	* libbalsa/mailbox_imap.c: Use g_mime_utils_header_decode_text
	instead of deprecated g_mime_utils_8bit_header_decode.
	* libbalsa/mailbox_imap.c: Decode addresses.
	* libbalsa/imap/imap-handle.c: Check protocol in addresses.

2003-10-21 08:16  PeterB

	* libbalsa/files.c, libbalsa/message.c, src/balsa-index.c,
	src/balsa-index.h, src/balsa-message.c, src/main-window.c: More
	memory leaks.

2003-10-20 16:44  PeterB

	* libbalsa/address.c: Plug a memory leak.
	* src/: balsa-message.c, save-restore.c: Plug memory leaks.

2003-10-19  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox_imap.c (libbalsa_mailbox_imap_get_msg_part): 
	message part cache minus the cleanup bits 

2003-10-19  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox_imap.c (libbalsa_mailbox_imap_get_msg_part): 
	do crlf conversion, adhere to mailbox_local return
	this sucks. it won't stop sucking till we have part cache.
	
2003-10-18 09:04  PeterB

	* libbalsa/mailbox_imap.c: Populate
	LibBalsaMessageBody::content_dsp; fix get_section_for().
	* libbalsa/: body.c, body.h, message.c, rfc3156.c: Don't require
	body->mime_part != NULL.
	* libbalsa/imap/: imap-handle.c, imap.h: Handle extension info in
	BODYSTRUCTURE response.
	* libbalsa/imap/imap-commands.c: Fetch BODYSTRUCTURE to get
	structure.

2003-10-18  Carlos Morgado  <chbm gnome.org>

	* libbalsa/imap/imap.h: make ImapBodyEncoding match 
	GMime to make things smother
	
	* libbalsa/mailbox_imap.c (libbalsa_mailbox_imap_get_msg_part):
	return decoded part and add mime_part

	* libbalsa/imap/imap-handle.c:
	set body->media_basic_name

2003-10-15 14:24  PeterB

	* libbalsa/imap/imap-handle.c: Implement ir_check_crlf() and use it
	for protocol checking; use g_ascii_ stringcomparisons; add
	`always_has_data' info to ResponseHandlers structures and use it
	for more careful syntax checking.

2003-10-14  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/mailbox.[hc]: remove old crap. fix sync_storage().

	* libbalsa/mailbox_{imap,maildir,mbox,mh}.c: adjustments to sync().
	* libbalsa/mailbox_local.c: remove old crap.
	* src/main-window.c: use new sync_storage() method

	* src/information-dialog.[ch]: 
	* src/main.c: fix bug 124568.

2003-10-14 08:36  PeterB

	* src/message-window.c: Trash the message in the window, not the
	current index selection (bug #124550).

2003-10-13  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/message.h: libbalsa_message_send() accepts debug argument.
	* libbalsa/send.[hc]: use it.
	* src/balsa-message.c: pass debug argument.
	* src/{sendmsg,main}-window.c: ditto.

2003-10-12  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox_mh.c (libbalsa_mailbox_mh_add_message): 
	unref the filter_stream (duh)

2003-10-12  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox_mh.c: make _sync work on _close

2003-10-11 23:02  PeterB

	* libbalsa/: mailbox.c, mailbox.h: Implement GtkTreeSortable
	interface.

2003-10-11 18:42 Pawel Salek

	* libbalsa/mailbox.[hc]: add 
	libbalsa_mailbox_msgno_{inserted,changed,removed}().
	* libbalsa/mailbox_imap.c: handle flag changes, new messages, expunges

2003-10-11  Pawel Salek

	* libbalsa/mailbox.c: simplify libbalsa_mailbox_is_open().
	* libbalsa/mailbox_imap.[ch]: keep private data private.
	Add libbalsa_mailbox_imap_get_path().
	* libbalsa/imap/imap-handle.h: add IMFETCH_RFC822SIZE constant.
	* libbalsa/imap/imap-commands.c: handle this constant. plug mem leaks
	* src/mailbox-conf.c, src/mailbox-node.c, src/main-window.c: 
	use libbalsa_mailbox_imap_get_path().

2003-10-10 23:27  PeterB

	* src/main-window.c: Use register_balsa_pixbufs when the main
	window has been created.
	* src/balsa-index.c: Remove icon code.
	* src/: balsa-icons.c, balsa-icons.h: Impl. register_balsa_pixbufs
	to initialize the new mail icon, etc.
	* libbalsa/: message.c, message.h: Impl.
	libbalsa_message_set_status_icons; install local versions of
	libbalsa_message_is_multipart, etc., that work with the mailbox
	locked.
	* libbalsa/: mailbox_imap.c, mailbox_maildir.c, mailbox_mbox.c,
	mailbox_mh.c: Set message icons.
	* libbalsa/: mailbox.c, mailbox.h: Add api for setting new mail
	icon, etc.; use icons in LB_MBOX_MARKED_COL and LB_MBOX_ATTACH_COL;
	signal the tree-view when icons change.
	* libbalsa/mailbox_local.c: Fix message numbering for threading;
	check more carefully for potential loops in threads.

2003-10-09 12:09  PeterB

	* src/main-window.c: Add accelerators for zoom in/out.

2003-10-08 23:00  PeterB

	* libbalsa/: mailbox.c, mailbox.h: Add LB_MBOX_WEIGHT_COL, of type
	G_TYPE_UINT, to the mbox-tree-model.
	* src/balsa-index.c: Connect cell column renderers to
	LB_MBOX_WEIGHT_COL.
	* libbalsa/message.c: Call libbalsa_messages_read() on change of
	flag.
	* libbalsa/mailbox_mh.c: Don't check msgno--it was checked by the
	caller; store mime_message in LibBalsaMessage object; plug memory
	leak in _add_message.
	* libbalsa/mailbox_maildir.c: Don't check msgno--it was checked by
	the caller; store mime_message in LibBalsaMessage object.

2003-10-07 10:03  PeterB

	* src/balsa-index.c: Fix source viewer.

2003-10-05  Carlos Morgado  <chbm gnome.org>

	* src/sendmsg-window.c (do_insert_string_select_ch): #103639

2003-10-05  Pawel Salek

	* libbalsa/body.[hc]: do not require gmime for content-type.
	* src/balsa-message.c: ditto.
	* libbalsa/mailbox.[hc]: change _get_message_part API.
	* libbalsa/mailbox_{local,imap}.c: implement _get_message_part().
	* libbalsa/message.c: add forgotten UNLOCK.
	* libbalsa/imap/imap-commands.[hc]: backend support for get_part().
	* libbalsa/imap/imap-handle.[ch]: actually remember part parameters.
	* libbalsa/imap/imap.h: add params field.
	* src/balsa-index.c: cleanup.

2003-10-04  Pawel Salek

	* libbalsa/mailbox.[ch]: add prepare_threading,
	fetch_message_structure and get_message_part virtual functions.
	* libbalsa/mailbox_imap.c: prepare to implement above.
	* libbalsa/mailbox_local.[hc]: same. Change 
	LibBalsaMailbox::load_message to LibBalsaMailboxLocal.
	* libbalsa/mailbox_{maildir,mh}.c: adapt to above.
	* libbalsa/mailbox_mbox.c: ditto. Fix off-by-one bug.
	* libbalsa/message.c: use fetch_message_structure.
	* src/balsa-index.c: restore bndx_selection_changed_func().
	* src/save-restore.c: change default threading type to flat - it
	is faster.

2003-10-04 10:03  PeterB

	* libbalsa/: libbalsa.c, libbalsa.h, mailbox_local.h,
	mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c: Make
	libbalsa_mailbox_local_get_path() return (const gchar *).
	* libbalsa/mailbox_local.c: Use g_node_traverse to visit nodes--it
	really does visit all nodes.
	* libbalsa/mailbox_imap.c: Set msgno correctly when unthreaded.

2003-10-03 08:30  PeterB

	* libbalsa/: mailbox.c, mailbox_imap.c, mailbox_local.c,
	mailbox_maildir.c, mailbox_mbox.c, mailbox_mh.c, message.h:
	LibBalsaMessage::msgno starts at 1; use (msgno - 1) to index into
	arrays; install a close_mailbox method for
	LibBalsaMailboxLocal--free and clear msg_list.

2003-10-03  Pawel Salek <pawsa theochem.kth.se>

	Merge gtk-tree-model branch. For good.
	* libbalsa/mailbox.[hc]: GtkTreeModel implementation.
	* libbalsa/mailbox_{imap,local,maildir,mbox,mh,pop3}.[hc]: changed API.
	* libalsa/{message,send}.c: adapt to changed api.
	* libbalsa/imap/imap-handle.c: threading, message decoding improvements
	* libbalsa/imap/imap.h: added comments.
	* src/balsa-index.c: use GtkTreeModel interface to LibBalsaMailbox.
	* src/main-window.c: trash can be only local now.
	* src/sendmsg-window.c: merge draftbox code.
	* src/Makefile.am: remove balsa-index-threading.c: not used any more.

2003-09-30 18:09  PeterB

	* libbalsa/mailbox_mbox.c: Use const variables for the result
	  of strrchr when the argument is const; dup a const string;
	  unlock with a stream before unref'ing it.

2003-09-28  Carlos Morgado  <chbm gnome.org>

	* libbalsa/pop3.c: 
	* libbalsa/mailbox_pop3.c: 
	fix it. someone should test procmail
	
	* libbalsa/mailbox_mh.c (free_messages_info): 
	don't crash if mailbox is invalid
	make deleted messages actually go away (instead of ,n)

2003-09-28  Carlos Morgado  <chbm gnome.org>
	
	* libbalsa/mailbox.c (libbalsa_mailbox_copy_message): 
	body_ref messages

2003-09-28  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox_mh.c (libbalsa_mailbox_mh_add_message): 
	* libbalsa/mailbox_maildir.c (libbalsa_mailbox_maildir_add_message): 
	add CRLF filters
	
2003-09-28  Carlos Morgado  <chbm gnome.org>

	* libbalsa/pop3.c: 
	* libbalsa/mailbox_pop3.c: 
	* libbalsa/mailbox_imap.c: 
	* libbalsa/mailbox_maildir.c: 
	* libbalsa/mailbox_mh.c: 
	* libbalsa/mailbox_mbox.c: 
	* libbalsa/mailbox.c: 
	* libbalsa/message.h: 
	replace add_message_stream with copy_message API. 

	* libbalsa/pop3.c: 
	* libbalsa/mailbox_pop3.c: 
	use a mh mailbox instead of mbox
	
	* libbalsa/mailbox_mh.c (libbalsa_mailbox_mh_sync): 
	don't crash on closing empty mailboxes

2003-09-28 09:02  PeterB

	* libbalsa/mailbox.c: Set mailbox->has_unread_messages when adding
	unread messages.
	* libbalsa/mailbox_pop3.c: Mark mail delivered to inbox as new.

2003-09-26 18:25  PeterB

	* libbalsa/gmime-gpgme-context.c: Include "config.h" without
	checking HAVE_CONFIG_H.
	* ChangeLog, configure.in, libbalsa/body.c,
	libbalsa/mailbox_mbox.c, libbalsa/server.c, libbalsa/url.c,
	libbalsa/imap/Makefile.am, libbalsa/imap/auth-cram.c,
	libbalsa/imap/imap-auth.c, libbalsa/imap/imap-handle.c,
	libbalsa/imap/siobuf.c: Compile with -Werror etc.
	* src/mailbox-node.c: Change mark_imap_path() to set noselect as
	well as noscan.
	* libbalsa/: folder-scanners.c, folder-scanners.h: Handle
	"lsub-response" signal; in subscribed mode, use LSUB command to
	list paths, then followup with LIST command to get authoritative
	flags.
	* libbalsa/imap/imap-handle.c: Use an enum for signals; new
	"lsub-response" signal; shared parser for LIST and LSUB responses.

2003-09-25  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/Makefile.am: remove -DLIBMUTT
	* libbalsa/gmime-gpgme-context.c: respect HAVE_GPGME

2003-09-25 09:15  PeterB

	* libbalsa/folder-scanners.c, libbalsa/folder-scanners.h,
	src/mailbox-node.c: Combine IMAP folder and mailbox handlers;
	general cleanup of IMAP code.

2003-09-24  Magick  <magick Linux-Fan.com>

	* configure.in: support for --disable-{flock,fcntl} options.
	* libbalsa/imap-server.[hc]: files to be commited yesterday.

2003-09-23  Magick  <magick Linux-Fan.com>

	* libbalsa/Makefile.am: add imap-server.[hc]
	* libbalsa/address.c: remove code obsoleted by gmime.
	* libbalsa/folder-scanners.c: get and release server handles.
	* libbalsa/libbalsa.[hc]: cleanup.
	* libbalsa/mailbox.c: return 'opened' field.
	* libbalsa/mailbox_imap.[ch]: use ImapServer class for connection pool.
	* libbalsa/{misc,send}}.c: misc fixes.
	* libbalsa/server.c: use it only for POP3 connections.
	* libbalsa/imap/imap-commands.c: proper returned type.
	* libbalsa/imap/imap-handle.c: add argument to expunge-notify handler.
	* src/balsa-message.c, src/sendmsg-window.c: cleanup.
	* src/{mailbox,folder}-conf.c, mailbox-node.c: adapt to new api.

2003-09-23 16:17  PeterB

	* libbalsa/mailbox_imap.c, libbalsa/message.c, libbalsa/message.h,
	libbalsa/send.c, src/sendmsg-window.c: Keep message-ids internally
	without the angle brackets; fix In-Reply-To header syntax.
	* libbalsa/imap/imap.h: Simplify macros.

2003-09-23  Pawel Salek  <pawsa theochem.kth.se>

	* src/expand-alias.c: reference used address before unrefing all.

2003-09-21 07:59  PeterB

	* configure.in: Look for libgnomeprint-2.2 before 2.0 (see
	http://mail.gnome.org/archives/balsa-list/2003-September/msg00109.h
	tml)

2003-09-21  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/folder-scanners.c: call mark_imap_path() for NOCHILDREN
	folders.

2003-09-20  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-entry.c: initalize emailData::address and fix
	dangling references introduced yesterday.
	* src/expand-alias.c: ditto.
	* libbalsa/imap/imap-handle.[hc]: RFC3348 (children) support.
	* libbalsa/folder-scanners.c: use it. Support empty prefix.

2003-09-19  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-entry.[hc]: add libbalsa_address_entry_get_list().
	* libbalsa/address.[hc]: format RFC822 groups correctly.
	* libbalsa/message.c: factor out common code (not used any more).
	* libbalsa/misc.c (libbalsa_make_string_from_list_p): get whole
	address.
	* libbalsa/send.c: factor out common code.
	* libbalsa/expand-alias.c : store pointer to LibBalsaAddress.
	* src/sendmsg-window.c: use libbalsa_address_entry_get_list()
	* libbalsa/imap/imap_private.h: remove integer port number parameter.
	* libbalsa/imap/imap-handle.c: fix case when no port is specified
	after ':'.
	* libbalsa/mailbox_imap.c: adjust to changed API.
	* libbalsa/folder-scanners.c: do not look for children of
	\NoInferiors mailboxes.

2003-09-19 07:16  PeterB

	* src/main-window.c: Desensitize `Mailbox -> Remove Duplicates'
	when no mailbox is selected.

2003-09-18 12:16  PeterB

	* libbalsa/imap/imap-handle.c: Trim port from host string, and use
	it.
	* libbalsa/imap/imap-commands.c: Use LSUB command in
	imap_mbox_lsub().
	* libbalsa/send.c: Set a message-id on a message's mime_message
	before placing it in the outbox and fccbox; unref the mime_message.
	* libbalsa/message.c: Don't lock the mailbox in
	libbalsa_message_clear_recent().
	* libbalsa/mailbox_imap.c: Don't double-unref mbox->handle.
	* libbalsa/mailbox.h: Define LIBBALSA_MAILBOX_GET_CLASS().
	* libbalsa/mailbox.c: Use
	LIBBALSA_MAILBOX_GET_CLASS(mailbox)->method instead of emitting a
	signal.
	* libbalsa/libbalsa_private.h: Use libbalsa_{un}lock_mailbox in
	*LOCK_MAILBOX* macros.
	* libbalsa/libbalsa.c: Use a pthread_condition for mailbox locking.
	* libbalsa/libbalsa-marshal.list: Drop some funky marshallers--they
	were used only in libbalsa/mailbox.c.
	* libbalsa/folder-scanners.c: Append delimiter to path only if it's
	not already there.

2003-09-14  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/imap/*: merge updates from libimap.
	* libbalsa/mailbox_imap.c: adapt to modified api, reduce mem usage.
	* libbalsa/folder-scanners.c: same.

2003-09-12  Magick  <magick Linux-Fan.com>

	* configure.in: implement search for sendmail.
	* libbalsa/sendmail.c: use it.
	
2003-09-12  Pawel Salek  <pawsa theochem.kth.se>

	* src/main.c: fix bug 121867.
	* src/ab-main.c: Fix bug related to 121867.

2003-09-12 09:29  PeterB

	* src/balsa-mblist.c: Do balsa_mblist_update_mailbox() in an idle
	handler--the signal handler may be called w/o the gdk
	lock--possible fix for bug #121962.

2003-09-11 Darko Obradovic <dobradovic gmx.de>

	* src/balsa-app.[hc]: remove balsa_app.drag_default_is_move
	* src/balsa-mblist.c: assume above is true always.
	* src/main-window.c: ditto.
	* src/pref-manager.c: remove configuration part.
	* src/save-restore.c: and save-restore part.

2003-09-10 08:15  PeterB

	* libbalsa/message.c: Restore "<>" around references; add `const'
	qualifier to suppress whining.

2003-09-10  Carlos Morgado  <chbm chbm.net>

	* configure.in (BALSA_PATCHLEVEL): bump version 2.1.0

	* libbalsa/mailbox_imap.c (imap_matched):
	make imap search not crash, it's still broken though

2003-09-10 06:07  PeterB

	* src/main-window.c: Set mailbox tab color on opening; flush the
	display before gdk_threads_leave().
	* src/balsa-mblist.c: Restore color to mailbox tabs.

2003-09-09  Carlos Morgado  <chbm chbm.net>

	* libmutt:
	bye bye libmutt. you served us well

2003-09-09  Carlos Morgado  <chbm chbm.net>

	* src/pref-manager.c (Repository): 
	* libinit_balsa/helper.c (Repository): 
	* libinit_balsa/balsa-druid-page-directory.c (Repository): 
	* libinit_balsa/Makefile.am (Repository): 
	* src/Makefile.am (Repository): 
	* libbalsa/imap/imap_private.h (Repository): 
	* libbalsa/imap/imap.h (Repository): 
	* libbalsa/imap/imap-handle.h (Repository): 
	* libbalsa/imap/imap-handle.c (Repository): 
	* libbalsa/imap/imap-commands.h (Repository): 
	* libbalsa/imap/imap-commands.c (Repository): 
	* libbalsa/server.c (Repository): 
	* libbalsa/send.c (Repository): 
	* libbalsa/rfc3156.c (Repository): 
	* libbalsa/mailbox_pop3.c (Repository): 
	* libbalsa/mailbox_mh.c (Repository): 
	* libbalsa/mailbox_mbox.c (Repository): 
	* libbalsa/mailbox_maildir.c (Repository): 
	* libbalsa/mailbox_imap.c (Repository): 
	* libbalsa/body.c (Repository): 
	Patches from Bart: more cleanups, imap threading, maildir/mh
	envelope parser
	The envelope parser will be replaced by the gmime incremental parser

2003-09-08 19:00  PeterB

	* libbalsa/message.c: Restore "<...>" to references.

2003-09-08  Carlos Morgado  <chbm chbm.net>

	* libbalsa/libbalsa.c (Repository): 
	* libbalsa/url.h (Repository): 
	* libbalsa/url.c (Repository): 
	* libbalsa/misc.c (Repository): 
	* libbalsa/mailbox_pop3.c (Repository): 
	* libbalsa/mailbox.c (Repository): 
	* libbalsa/libbalsa.h (Repository): 
	* libbalsa/filter.c (Repository): 
	* libbalsa/body.c (Repository): 
	* libbalsa/Makefile.am (Repository): 
	* src/Makefile.am: 
	* configure.in: 
	* Makefile.am: 
	further demuttification

2003-09-08  Carlos Morgado  <chbm chbm.net>

	* libbalsa/filter-file.c: 
	* libbalsa/filter-private.h: 
	* libbalsa/mailbackend.h: 
	* libinit_balsa/helper.c (balsa_init_create_to_directory): 
	* libbalsa/message.c (libbalsa_message_charset): 
	* libbalsa/mailbox_mh.c (libbalsa_mailbox_mh_check): 
	* libbalsa/mailbox_mbox.c (mbox_unlock): 
	* libbalsa/body.c (libbalsa_message_body_save): 
	* src/save-restore.c (config_global_load): 
	* libbalsa/libbalsa.c:
	* libbalsa/libbalsa.h:
	* libbalsa/misc.c:
	* libbalsa/misc.h:
	delibmuttification
	UNFINISHED
	
	* libbalsa/mailbox_imap.c (libbalsa_mailbox_imap_open): 
	* libbalsa/mailbox_mbox.c (libbalsa_mailbox_mbox_open): 
	* libbalsa/mailbox_mh.c (libbalsa_mailbox_mh_open): 
	* libbalsa/mailbox_maildir.c (libbalsa_mailbox_maildir_open): 
	* libbalsa/mailbox_pop3.c (libbalsa_mailbox_pop3_open): 
	fix #121637
	
	* libbalsa/body.c:
	* libbalsa/body.h:
	* libbalsa/libbalsa.c:
	* libbalsa/mailbox_mbox.c:
	* libbalsa/message.c:
	* libbalsa/misc.c:
	* libbalsa/misc.h:
	* src/balsa-message.c:
	* src/print.c:
	* src/sendmsg-window.c:
	-Removed prefix parameter in libbalsa_message_body_save* functions
	-Added libbalsa_message_body_save_fd function to save to a 
	filedescriptor
	-Changed mutt_mktemp to g_file_open_tmp code
	-Added libbalsa_mktempdir in forwarding/continuing message code
	-Only convert body charset is mime type is text/* and not text/html
	(from Bart)

2003-09-07  Bart Visscher <magick@Linux-Fan.com>

	* libbalsa/imap/util.c (Repository): 
	* libbalsa/imap/imap-handle.c (Repository): 
	* libbalsa/imap/imap-fetch.c (Repository): 
	* libbalsa/imap/imap-commands.c (Repository): 
	* libbalsa/imap/imap-auth.c (Repository): 
	* libbalsa/imap/Makefile.am (Repository): 
	* libbalsa/send.c (Repository): 
	* libbalsa/rfc3156.c (Repository): 
	* libbalsa/pop3.c (Repository): 
	* libbalsa/mime.c (Repository): 
	* libbalsa/message.c (Repository): 
	* libbalsa/mailbox_mbox.c (Repository): 
	* libbalsa/mailbox_maildir.c (Repository): 
	* libbalsa/mailbox_local.c (Repository): 
	* libbalsa/mailbox_imap.c (Repository): 
	* libbalsa/gmime-gpgme-context.c (Repository): 
	* libbalsa/folder-scanners.c (Repository): 
	* libbalsa/body.c (Repository): 
	* configure.in (Repository): 
	add check for getaddrinfo
	pop3.c: use GMime's md5-utils
	cleanup compile with -Wall
	removed some mailbackend.h includes


2003-09-07  Carlos Morgado  <chbm gnome.org>

	* libbalsa/mailbox.c: free the message list only *after* closing 
	the backend

2003-09-07  Carlos Morgado <chbm gnome.org>

	* src/Makefile.am: alter link order
	* libbalsa/address.c: utf8 sanitize addresses

2003-09-07  Bart Visscher <magick@Linux-Fan.com>

	* libbalsa/message.c: remove open/sync/close around add_message

	* libbalsa/imap/imap-commands.c:
   	* libbalsa/imap/imap-commands.h:
   	* libbalsa/imap/imap-handle.c:
   	* libbalsa/imap/imap_private.h:
   	* libbalsa/mailbox_imap.c:
   	Fix open/close for imap,
   	Fix readonly flag,
   	prepare libbalsa_mailbox_imap_add_message for a closed mailbox

   	* libbalsa/mailbox_maildir.c:
   	prepare libbalsa_mailbox_maildir_add_message for a closed mailbox


2003-09-07  Carlos Morgado  <chbm chbm.net>	

	* libbalsa/mailbox_mbox.c: plug leak in close, indent

2003-09-06  Magick <magick@Linux-Fan.com>

	*libbalsa/imap/Makefile.am: add imap_private.h
	*libbalsa/source-viewer.c: close message string
	*libbalsa/message.c: typo fix sibject->subject
	*libbalsa/mailbox.h:
	*libbalsa/mailbox.c: remove libbalsa_mailbox_add_message

2003-09-06  Carlos Morgado  <chbm chbm.net>

	* libbalsa/mailbox_mh.c (Repository): 
	* libbalsa/mailbox_mbox.c (Repository): 
	* libbalsa/mailbox_maildir.c (Repository): 
	* libbalsa/mailbox_imap.c (Repository): 
	* libbalsa/mailbox.h (Repository): 
	* libbalsa/mailbox.c (Repository):
	libalsa_mailbox_is_open, better checking of open/closed mailboxes

2003-09-06  Carlos Morgado  <chbm chbm.net>

	* libbalsa/imap/md5.c: 
	* libbalsa/imap/md5.c: 
	* libbalsa/imap/Makefile.am: 
	removed md5.*	

	* libbalsa/imap/auth-cram.c (Repository): 
	converted to GMime's md5-utils
	
	* libbalsa/source-viewer.c (Repository): 
	* libbalsa/send.c (Repository): 
	* libbalsa/message.c (Repository): 
	* libbalsa/mailbox_remote.c (Repository): 
	* libbalsa/mailbox_pop3.c (Repository): 
	* libbalsa/mailbox_mh.h (Repository): 
	* libbalsa/mailbox_mh.c (Repository): 
	* libbalsa/mailbox_mbox.h (Repository): 
	* libbalsa/mailbox_mbox.c (Repository): 
	* libbalsa/mailbox_maildir.h (Repository): 
	* libbalsa/mailbox_maildir.c (Repository): 
	* libbalsa/mailbox_imap.h (Repository): 
	* libbalsa/mailbox_imap.c (Repository): 
	* libbalsa/mailbox.h (Repository): 
	* libbalsa/mailbox.c (Repository): 
	* libbalsa/libbalsa_private.h (Repository): 
	removed CLIENT_CONTEXT*, used the libbalsamailbox subclassing, 
	some Wall cleanups
	
	* AUTHORS: added magick@linux-fan.com

	
2003-09-05  Carlos Morgado  <chbm chbm.net>

	* configure.in:
	* libbalsa/:
	* libbalsa/imap/:
	* src/: 
	commited Bart Visscher's GMime patch. you need gmime-2.0

2003-09-05  Carlos Morgado  <chbm chbm.net>

	* Changelog: HEAD is now devel. stable is balsa-2-0

2003-09-05 11:19  PeterB

	* src/: filter-edit-callbacks.c, filter-run-callbacks.c: Use
	balsa_infordmation_parented().

20d03-09-04 08:47  PeterB

	* libbalsa/address-book-vcard.c: Test new_address fields.

2003-09-03 16:34  PeterB

	* doc/C/balsa.xml: Copy filter help from help/C/balsa.sgml.
	* src/: filter-edit-callbacks.c, filter-run-callbacks.c: Connect
	filter dialog Help buttons to text.
	* src/: address-book-config.c, balsa-message.c,
	filter-edit-callbacks.c, filter-run-callbacks.c, folder-conf.c,
	pref-manager.c, sendmsg-window.c, toolbar-prefs.c: Use
	balsa_information instead of g_print to report errors.

2003-09-01 23:14  PeterB

	* libbalsa/misc.c: Fix bug #121181.

2003-08-31  Carlos Morgado  <chbm chbm.net>

	* src/main-window.c (balsa_notebook_label_new): add tooltips 
	to mailbox tabs, no more 'INBOX' madness

2003-08-31  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book-ldif.c: parse more reliably address groups.
	* libbalsa/address.[ch]: remove member_list - it is redundant.
	* libbalsa/address-book.c: adapt to above.
	* src/ab-window.c: Add shortcuts and improve scrolling.

2003-08-27  Pawel Salek  <pawsa theochem.kth.se>

	* src/sendmsg-window.c: add Serbian language; fix locale associated
	with British English.
	* libbalsa/libbalsa.c: add iso-8859-5 to list of tried charsets.

2003-08-27 15:49  PeterB

	* src/sendmsg-window.c: Restore the ability to completely turn off
	word wrap when sending.

2003-08-26  Pawel Salek  <pawsa theochem.kth.se>

	* configure.in, NEWS: release 2.0.14.

2003-08-23 18:47  PeterB

	* src/balsa-message.c: Implement bm_sender_to_gchar() to put all
	the "No sender" checks in one place; use it in display_part() for
	content type "message/rfc822".

2003-08-22 14:17  PeterB

	* src/balsa-message.c: Allow message structure tree to be collapsed
	(Albrecht Dress <albrecht.dress@arcor.de>).

2003-08-22  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book-ldap.c: handle better broken connections.
	* src/store-address.c: more detailed error reporting.

2003-08-18  Pawel Salek  <pawsa theochem.kth.se>

	* configure.in: improve aspell detection (120180).
	* libbalsa/address.c: use NULLs instead of empty strings.
	* libbalsa/address-book-ldap.c: detect no-op modifications.

2003-08-14 19:33  PeterB

	* src/mailbox-conf.c: Check whether a mailbox view is already in
	balsa_app.mailbox_views.

2003-08-13 19:26  PeterB

	* libbalsa/body.c: Don't include G_DIR_SEPARATORs in temp_filenames
	(libbalsa_message_body_save_temporary).

2003-08-13  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book-ldap.c: provide more accurate information
	on errors.
	* libbalsa/address-book.[hc]: framework for detailed error reporting.
	* src/ab-window.c: use it.
	* src/sendmsg-window.c: set window focus correctly on delete event.
	
2003-08-13 09:29  PeterB

	* libbalsa/mailbox-filter.c: Plug memory leak in
	mailbox_filters_section_lookup.

2003-08-10  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book*.[hc]:
	* libbalsa/address-book-*.[hc]: add ability of filtering entries
	on loading to improve handling of large address books.
	* libbalsa/address.[hc]: lb_addr__new_from_edit_entries implemented.
	* src/ab-main.c: further work.
	* src/ab-window.[hc]: filtering support.
	* src/address-book-config.c: close ldap connection after changing
	config.
	* src/store-address.c: factor out common code to address.c
	
2003-08-08  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book-ldap.c: implement "{add,modify,remove}-address"
	signals.
	* libbalsa/libbalsa_private.h: check CLIENT_CONTEXT extra carefully.
	* libbalsa/mailbox_imap.c: get_stream returns pointer, not bool.
	* src/store-address.c: make address book selection actually work.

2003-08-07  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book.[hc]: add remove-address and modify-address
	signals.
	* libbalsa/address-book-{extern,ldap,ldif,vcard}.c: add remove/modify
	support.
	* libbalsa/information.[hc]: add ability to choose parent for
	the message window.
	* libbalsa/libbalsa-marshal.list: add INT:OBJECT,OBJECT marshaller.
	* libbalsa/libbalsa.c: pass parent window.
	* src/information-dialog.[hc]: use passed parent window.
	* src/main.c: balsa_information_parented is now the main info callback.
	* src/store-address.c: check for errors when adding addresses.

	* src/main-window.c: add a shortcut for "toggle read" action.
	* src/balsa-message.c: sanitize attachment filenames (Albrecht Dress).
	
2003-08-05  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address.[hc]: move common address edition code here.
	* src/ab-main.c: further hacking.
	* src/store-address.c: remove common address edition code from here.

2003-07-31 16:43  PeterB

	* src/: balsa-message.c, balsa-message.h, main-window.c: Make all
	the zoom code conditional on HAVE_GTKHTML.
	* src/print.c: Add missing "break" in a switch.

2003-07-29  Pawel Salek  <pawsa theochem.kth.se>

	* src/balsa-index.c: try addressing #118620: reorder menu entries.

2003-07-29 12:31  PeterB

	* src/balsa-index.c: Try harder to keep threads expanded when
	balsa_app.expand_tree is set.
	* libbalsa/address-book-extern.c: Fix #118574, #118576, #113371.

2003-07-28 14:52  PeterB

	* src/sendmsg-window.c: Prepare message for "DelSp=Yes" before
	sending; this uses the `undo' buffer, which necessitated cleaning
	up buffer handling.
	* src/balsa-message.c: Check for "DelSp=Yes" on a "format=flowed"
	message body.
	* libbalsa/send.c: Set "DelSp=Yes" on "format=flowed" bodies.
	* libbalsa/: misc.c, misc.h: Implement "DelSp=Yes" wrapping; clean up
	wrapping code; use pango_get_log_attrs() instead of our own code.
	* libbalsa/mime.c: If body is "DelSp=Yes", pass that info to
	libbalsa_process_text_rfc2646().
	* libbalsa/: body.c, body.h: Implement
	libbalsa_message_body_is_delsp()--looks for "DelSp=Yes" on a
	"text/plain" message body.

2003-07-27  Pawel Salek  <pawsa theochem.kth.se>

	* NEWS, configure.in: release balsa-2.0.13

2003-07-25  Darko Obradovic <dobradovic gmx.de>

	* src/main.c: set up the icon in a GNOME-2 compatible fashion.
	* src/main-window.c: remove unused set_icon() routine.

2003-07-23  Pawel Salek  <pawsa theochem.kth.se>

	* src/balsa-app.h: change date defaults as suggested in #118118.
	* src/sendmsg-window.c: use gnome default editor.
	* src/balsa-app.h: remove balsa_app.extern_editor_command.
	* src/save-restore.c, src/pref-manager.c: ditto.

2003-07-22  Pawel Salek  <pawsa theochem.kth.se>

	* src/mailbox-conf.c: fix (at least partially) bug 117163.
	* src/main-window.c: change collapse thread shortcut to Ctrl-R 118070.
	* libbalsa/libbalsa.h, libbalsa/source-viewer.c: remember
	last setting of "Escape Specials" in message source viewer.
	* src/balsa-app.h, src/balsa-index.c, src/message-window.c:
	* src/save-restore.c: ditto.
	* src/sendmsg-window.c: remove some shortcut conflicts.

2003-07-21  Pawel Salek  <pawsa theochem.kth.se>

	* autogen.sh: better scriptlet for libtool version detection.
	* configure.in: remove -Wsign-promo - it is C++-specific.
	* libbalsa/{folder-scanners,mailbox_imap,notify}.c: 
	* src/balsa-index.c: compile with gcc-3.3 with no warnings.
	* src/save-restore.c: clean mailbox sections.
	
2003-07-18 15:05  PeterB

	* src/balsa-index.c: Expand row after setting message.

2003-07-18  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/address-book-ldap.c: try to use LDAPV3 whenever available
	- partially address bug 116953.
	* libbalsa/mailbox_imap.c: update headers if needed (bug 117723)
	* libbalsa/message.c: refresh headers if needed.
	* libbalsa/message.h: add an 'updated' flag. Remove user_headers.
	* libbalsa/send.c: adjust accordingly.

2003-07-17 11:29  PeterB

	* src/balsa-index.c: Leave thread expanded when deleting message(s)
	if balsa_app.expand_tree is TRUE;
	Add new messages in expanded subthread if balsa_app.expand_tree
	is TRUE
	(http://mail.gnome.org/archives/balsa-list/2003-July/msg00054.html).

2003-07-16  Pawel Salek  <pawsa theochem.kth.se>

	* src/main.c: remove console warning questioned in bug 114036.
	* src/sendmsg-window.c: Set locale also for non-English languages.

2003-07-15 11:40  PeterB

	* src/sendmsg-window.c: Set locale only when menu item is
	activated.
	* src/spell-check.c: On error, signal the compose window so that it
	can restore editability (fixes a bug that was reported--I can't
	find the report right now).

2003-07-15  Pawel Salek  <pawsa theochem.kth.se>

	* libbalsa/mailbox_pop3.c: do not try saving NULL config strings.
	* libbalsa/server.c: default remember_passwd to FALSE.
	* src/balsa-app.c: make switching remembering passwds easier.
	* src/main-window.c: simplify asking for passwd (also bug 117386).
	* configure.in: replace --enable-ldap with more apriopriate --with-ldap

2003-07-14  Pawel Salek  <pawsa theochem.kth.se>

	* src/sendmsg-window.c: display mark by the selected language entry.

2003-07-10  Pawel Salek  <pawsa theochem.kth.se>

	* src/filter-run-callbacks.c: fix bug 116603.

2003-07-08  Danilo Šegan  <dsegan@gmx.net>

	* src/main-window.c (show_about_box): Use the "translator_credits"
	in Gnome about box - fixes bug #116994.

2003-07-08  Danilo Šegan  <dsegan@gmx.net>

	* balsa.desktop, sounds/balsa.soundlist, sounds/email.soundlist:
	Added Serbian translations.

2003-07-08  Pawel Salek  <pawsa theochem.kth.se>

	* src/balsa-app.h: add fields for print settings: margins, layout etc.
	* src/save-restore.c: save&restore more print settings.
	* src/print.c: get'em and set'em.

2003-07-06  Pawel Salek  <pawsa theochem.kth.se>

	* NEWS, configure.in: release balsa-2.0.12.

2003-07-05  Albrecht Dreß  <albrecht.dress@arcor.de>		

	* src/balsa-message.c: show from and subject for attached 
	messages

2003-07-04  Pawel Salek <pawsa theochem.kth.se>

	* src/sendmsg-window.c: sort also translated language names.
	* libbalsa/body.c: _() declaration needed.

2003-07-03  Carlos Morgado  <chbm chbm.nu>

	* libbalsa/send.c: send text attachs as unknown-8bit

	* libbalsa/body.c,h:
	* libbalsa/filter.c:
	* libbalsa/libbalsa.h:
	* libbalsa/message.c,h:
	* libbalsa/send.c:
	* libmutt/parse.c:
	* src/balsa-index.c:
	* src/balsa-message.c:
	* src/print.c:
	* src/sendmsg-window.c:
	* src/store-address.c:
	aply Albrecht's patch #114411 - show embeded headers

2003-07-02  Danilo Šegan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-06-29  Albrecht Dreß  <albrecht.dress@arcor.de>	

	* src/pixmaps/info_lock_sigtrust.xpm: 
	* src/balsa-message.c: 
	* src/balsa-index.c: 
	* src/balsa-icons.h: 
	* src/balsa-icons.c: 
	* libbalsa/rfc3156.h: 
	* libbalsa/rfc3156.c: 
	* libbalsa/message.h: 
	improve the display of successfully checked signatures, 
	taking the key's "validity" and "trust" fields into account.

2003-06-27 10:21  PeterB

	* libbalsa/identity.c: Use ident_dialog_update() to validate and
	update the current identity before creating a new one (fixes
	#116027) and before changing the default identity; update name in
	identity list as user edits the entry.

2003-06-26 21:18  PeterB

	* src/balsa-message.c: Compile with --disable-gtkhtml.

2003-06-25 07:47  PeterB

	* src/sendmsg-window.c: Replace Reflow Paragraph and Reflow Message,
	which were disabled for format=flowed, with Reflow Selected Text,
	which is enabled for format=flowed: reflow and requote lines
	containing selected text.
	* src/quote-color.c: Use libbalsa_match_regex() in is_a_quote().
	* libbalsa/: misc.c, misc.h: Implement libbalsa_unwrap_selection(),
	which fixes broken wrapping and quoting, and libbalsa_match_regex(),
	a slight generalization of is_a_quote().

2003-06-24 18:19  PeterB

	* src/main-window.c: Warn msgfmt about a translated string with a
	natural `%' sign (#115888).

2003-06-24 02:06  PeterB

	* src/balsa-message.c: Don't leak memory when using popup menu.
	* src/main-window.c: Add zoom controls to the main window's View
	menu.
	* src/: balsa-message.c, balsa-message.h: Add zoom methods to the
	API; add a popup menu for HTML items with zoom controls.

2003-06-19 11:07  PeterB

	* src/: main-window.c, message-window.c, sendmsg-window.c: Use
	libbalsa_window_select_all(), to make "select-all" consistent with
	the other editing methods ("copy" in all windows, and "cut" and
	"paste" in the compose window).
	* src/: balsa-message.c, balsa-message.h: Remove
	balsa_message_select_all(); implement balsa_message_grab_focus(),
	so that we can use the focus widget as the target for copy and
	select-all.
	* libbalsa/: misc.c, misc.h: Imnplement
	libbalsa_window_select_all(), a helper for "select-all" callbacks.

2003-06-18 09:09  PeterB

	* libbalsa/mailbox.c: When we see LibBalsaMailboxLocal in the
	config file, replace it with the actual type.

2003-06-17 07:41  PeterB

	* libbalsa/mailbox.c: Check for error return from
	libbalsa_mailbox_type_from_path().
	* src/information-dialog.c: Dialog may be called when
	balsa_app.appbar is NULL.
	* src/sendmsg-window.c: When type == SEND_CONTINUE, remember the
	correct draft message.
	* src/balsa-index.c: Be more careful when adding messages in an
	idle callback.

2003-06-04  Pawel Salek <pawsa theochem.kth.se>

	* libbalsa/address-book-ldif.c: detect circular references.
	* libbalsa/source-viewer.c: compile on RH9.
	* src/mailbox-conf.c: do not crash on POP3 mailbox configuration.
	
2003-06-04 20:56  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h, toolbar-factory.c:
	Implement Undo and Redo options on the compose window's View menu,
	and corresponding toolbar buttons.
	* libbalsa/source-viewer.c: Include "misc.h" (Miquel van
	Smoorenburg <miquels@cistron.nl>); weak ref the message.

2003-06-03 22:22  PeterB

	* libbalsa/libbalsa.h, libbalsa/source-viewer.c, src/balsa-index.c,
	src/main-window.c, src/message-window.c: Use balsa_app.message_font
	for the source viewer, and add a View menu with an option to
	utf8_sanitize the source, not g_strescape it.
	* src/main.c: Ignore SIG_PIPE before starting gnome triggers.
	* src/: balsa-message.c, balsa-message.h, main-window.c,
	message-window.c, sendmsg-window.c, sendmsg-window.h: Handle cut,
	copy, and paste using clipboard signals (fixes #113337).

2003-06-02  Carlos Morgado  <chbm chbm.nu>

	* libbalsa/folder-scanners.c (libbalsa_scanner_mdir): 
	allow nested maildir

2003-06-01 09:49  PeterB

	* src/information-dialog.c: Change the information list widget from
	GtkTreeView to GtkTextView.

2003-05-30 07:00  PeterB

	* src/sendmsg-window.c: Replace obsolete cs_CS and fix typo
	(Ladislav Michl <ladis@linux-mips.org>).

2003-05-28 19:56  PeterB

	* src/sendmsg-window.c: When replying, don't ref message->mailbox:
	it can prevent Balsa from closing it properly.
	* libbalsa/filter.c, libbalsa/message.c, libbalsa/send.c,
	src/balsa-index.c, src/balsa-message.c, src/sendmsg-window.c: Check
	for NULL message->from.

2003-05-27 21:20  PeterB

	* src/main-window.c: Restore set_wmclass to new mail notification
	popup.
	* src/balsa-app.c: Remove `connect_swapped' from create_entry: it
	sometimes leads to infinite recursion=>segv.

2003-05-27  Albrecht Dreß  <albrecht.dress@arcor.de>
	
	* src/message-window.c: 
	* src/main-window.c: 
	* src/balsa-message.c: 
	* src/balsa-message.h: 
	replace the message-part list with a tree 

2003-05-27 09:15  PeterB

	* libbalsa/: mailbox.c, mailbox.h: Move view info into a new
	LibBalsaMailboxView structure, and implement methods for it.
	* src/save-restore.c: Save and restore mailbox views; scrap list of
	open mailboxes.
	* src/main-window.c: Use mailbox views; maintain the `open' member.
	* src/balsa-mblist.c: Use mailbox views; maintain the `exposed'
	member.
	* src/: balsa-index.c, mailbox-conf.c, main.c, sendmsg-window.c:
        Use mailbox views.
	* src/: balsa-app.c, balsa-app.h: Add balsa_app.mailbox_views, a
	hash table of LibBalsaMailboxView structures that persists over
	rescans; use views to remember open mailboxes, instead of a special
	list; open them without descending into the tree (imap mailboxes
	that need to be opened are already there).
	* libbalsa/: mailbox_imap.c, mailbox_imap.h: Implement and use
	convenience methods for making imap URLs and paths (a path is a URL
	without the user info).
	* libbalsa/: folder-scanners.c, folder-scanners.h: Browse imap
	folders recursively, instead of by depth; use callbacks to decide
	how deep and to notify about browsing.
	* src/mailbox-node.c: Use mailbox views; attach mailbox view when
	opening a mailbox; provide callbacks for imap browsing.

2003-05-21 19:34  PeterB

	* src/main-window.c: Fix #113130: Make new mail notification window
	not transient for the rest of Balsa.

2003-05-15 10:59  PeterB

	* libmutt/imap/imap.c: Check for broken IMAP connection in
	imap_uid_search.

2003-05-15  Pawel Salek  <pawsa@theochem.kth.se>

	* sounds/balsa.soundlist: convert to UTF-8

2003-05-11  Albrecht Dreß  <albrecht.dress@arcor.de>

	* configure.in:
        * libbalsa/rfc3156.c:
        * libbalsa/rfc3156.h:
        * src/balsa-message.c:
        popup a dialog if key is not found and run
        gpg --recv-key

2003-05-11  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS, configure.in: release 2.0.11.
	* src/balsa-message.c: be less verbose on message format errors.

2003-05-09  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/address-book-ldap.c: handle large directories slightly
	better (show at least some records).
	* libbalsa/filter-file.c: build workarounds for yellowdog. (AD)
	* src/filter-edit-callbacks.c: ditto.

2003-05-07  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/body.c: use attachment's extension for temporary files.
	* src/balsa-message.c: set MDN message type to multipart/report.

2003-05-06 05:35  PeterB

	* libbalsa/mailbox_local.c: Fix #111288.

2003-05-06  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/send.c: make ESMTP protocol more verbose - fix bug 112285.
	* libbalsa/filter.c: play sound and popup dialogs if requested (EA).
	* libbalsa/address-book-ldap.c: ldap caching deprecated in 
	openldap-2.1.x, remove references to it.

2003-05-05 08:30  PeterB

	* src/sendmsg-window.c: Replace some stray `msg's with `bsmsg'.
	* libbalsa/misc.h: Don't include "libbalsa.h".

2003-05-05  Pawel Salek  <pawsa@theochem.kth.se>

	* src/sendmsg-window.c: fix bug 112266.

2003-05-05  Albrecht Dreß  <albrecht.dress@arcor.de>

	* src/balsa-message.c: sanitize subject to avoid errors on reply etc.
	* src/{print,sendmsg-window}.c: ditto.

2003-05-05  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/identity.[hc]: add gpg_sign and gpg_encrypt fields, and 
	respective UI support.
	* libbalsa/rfc3156.[hc]: enable passphrase caching.
	* src/balsa-icons.[hc]: add balsa_gpg_{encrypt,sign}.xpm 
	* src/balsa-message.c: adapt to changed rfc3156 API.
	* src/sendmsg-window.[hc]: add tools for encrypt/sign.
	* src/toolbar-factory.c: support for configuring encrypt/sign tools.
	
2003-05-04 23:40  PeterB

	* src/sendmsg-window.c: Fix #111958 (Albrecht Dreß
	<albrecht.dress@arcor.de>)

2003-05-03 03:50  PeterB

	* src/: balsa-app.c, balsa-app.h, balsa-mblist.c, mailbox-node.c,
	main.c, main-window.c, save-restore.c, src/sendmsg-window.c,
	sendmsg-window.h: Use mailbox views to remember expanded folders.
	* src/sendmsg-window.c: Make Edit => {cut,copy,paste} apply to
	widget with focus, not always the text (#111801);
        agree on `bsmsg' as the identifier for a BalsaSendmsg.
	* libbalsa/address-entry.c: Use clipboard signals instead of
	catching ctrl+{x,c,v}.

2003-05-01 21:44  PeterB

	* libbalsa/filter.c: Message list for filter action must not have
	duplicates.

2003-05-01  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/libbalsa.c: show ceritificate expire date
	correctly

2003-04-29 17:32  PeterB

	* libbalsa/misc.c: Fix #111817.

2003-04-26  Kang Jeong-Hee  <Keizi@mail.co.kr>

	* balsa.desktop: replace broken Name[ko] and Comment[ko]
	with proper UTF-8 string.

2003-04-26 06:35  PeterB

	* libbalsa/folder-scanners.c: When list_inbox is specified, add
	INBOX to the list of folders but don't flag it for scanning as the
	root of a tree.
	* src/balsa-message.c: Always remember id returned by g_idle_add.

2003-04-26  Kang Jeong-Hee  <Keizi@mail.co.kr>

	* src/balsa-index.c, src/balsa-message.c: replace (FALSE, 0)
	of libbalsa_utf8_sanitize() with (balsa_app.covert_unknown_8bit,
	balsa_app.convert_unknown_8bit_codeset).

2003-04-24 11:26  PeterB

	* libbalsa/misc.c: Fix a corner case.
	* src/sendmsg-window.c: Grab gdk lock in a timeout handler; scroll
	to cursor after wrapping.
	* libbalsa/misc.c: Mark URLs in a text buffer, so they don't get
	wrapped.

2003-04-22 15:42  PeterB

	* doc/C/balsa.xml: Fix #110881.
	* src/message-window.c: Make closing the window more
	robust (possible fix for #111178).  Protect against
	destroying message window before idle handler
	is called. Save and restore window dimensions
	(http://mail.gnome.org/archives/balsa-list/2003-April/msg00020.html).
	* src/: balsa-app.h, save-restore.c: Save and restore message
	window dimensions.

2003-04-18 11:00  PeterB

	* libbalsa/misc.h: Include LIBBALSA_NUM_CODESETS in LibBalsaCodeset
	enum, instead of #defining it (Kang Jeong-Hee <Keizi@mail.co.kr>).

2003-04-17 18:51  PeterB

	* libbalsa/: mailbox.c, mailbox.h: Add LibBalsaMailboxShow *show
	member to LibBalsaMailbox, and the LibBalsaMailboxShow enum.
	* src/balsa-mblist.c: Make sure mailbox->show is set when adding a
	mailbox to the list.
	* src/balsa-index.c: Use mailbox->show instead of looking for sent,
	draft, and outbox.
	* src/: mailbox-conf.c, mailbox-conf.h: Consolidate code for
	widgets that control mailbox view items, and add a radio group for
	showing From or To.
	* src/folder-conf.c: Use the code in mailbox-conf.c for view
	widgets.

2003-04-14 19:13  PeterB

	* src/main-window.c: Rearrange Help menu (Darko Obradovic
	<dobradovic@gmx.de>).

2003-04-13 08:52  PeterB

	* src/sendmsg-window.c: Use a GString instead of a stack buffer and
	strcat().

2003-04-12 13:14  PeterB

	* src/: sendmsg-window.c, sendmsg-window.h: Put the headers in a
	scrolled window.

2003-04-11 16:43  PeterB

	* libbalsa/address.c: Check argument in libbalsa_address_get_name.
	* libbalsa/: message.c, message.h: Return "(No subject)" instead of
	a NULL pointer when there's no subject (see
	http://mail.gnome.org/archives/balsa-list/2003-April/msg00053.html
	and followups).

2003-04-10 16:25  PeterB

	* libbalsa/mailbox_local.c: Make sure
	libbalsa_mailbox_local_set_path returns non-zero on error.

2003-04-09  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/rfc3156.[ch]: OpenPGP (RFC2440) mode support.
	* libbalsa/send.c: sending OpenPGP signed messages.
	* src/balsa-message.c: provide more feedback for messages with
	broken structure.
	* src/sendmsg-window.[hc]: Allow to select OpenPGP mode.
	* src/main-window.c: fixes a GPG-related crash when during startup.
	* libbalsa/rfc3156.c: make the passphrase dialog mt safe.
	* libbalsa/rfc3156.[hc], src/balsa-message.c: remember signature
	info for '2440 messages.
	* libbalsa/mime.c: strip signature info off a '2440 message on
	reply/forward/... 
	* configure.in: replace --enable-gpgme with --with-gpgme.


2003-04-07 08:43  PeterB

	* libbalsa/misc.c, libbalsa/misc.h, src/pref-manager.c: Remove
	libbalsa_{de}escape_specials; use g_str{escape,compress} instead.
	* libbalsa/misc.c: Streamline libbalsa_make_string_from_list_p
	(Manu).

2003-04-06  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox_pop3.c: fix progress dialog for multiple POP servers

2003-04-04 06:07  PeterB

	* src/sendmsg-window.c: Fix Edit => Wrap Body.

2003-04-04  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/rfc3156.c: remove paranoia test.
	* src/print.c: sanitize before printing.
	* src/sendmsg-window.c: sanitize before displaying.

2003-04-03 12:14  PeterB

	* src/sendmsg-window.c: Wrap initial text.

2003-04-03  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/rfc3156.[hc]: fix EOL character conversion.  Implement
	libbalsa_signature_info_to_gchar(). selecting a key from a list if
	a signer or recipient has more than one suitable key in the key
	ring.
	* src/balsa-message.c: use libbalsa_signature_info_to_gchar().
	* src/print.c: signature printing support.
	* src/sendmsg-window.c: clean up.
	* INSTALL: GPG description.
	* configure.in: attempt to change the linking order.

	* libbalsa/misc.[ch]: libbalsa_utf8_sanitize() with a charset
	fallback instead of '?'
	* src/balsa-app.h: default broken charset.
	* src/balsa-{index,message}.c: use new _sanitize()
	* src/pref-manager.c: configure the default fallback charset.
	* src/save-restore.c: save and restore it.

2003-04-02  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/misc.h: #include gtk.h is needed to build with gtk-2.2

2003-04-02 09:13  PeterB

	* libbalsa/mime.c, libbalsa/misc.c, libbalsa/misc.h,
	src/balsa-message.c, src/sendmsg-window.c, src/sendmsg-window.h:
	Wrap text in the message window and the compose window using Pango
	to find potential line breaks.
	* src/: spell-check.c, spell-check.h: Use marks to remember current
	word between events.

2003-04-02  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox.[hc],mailbox_{local,imap}.[hc]: define new
	functions (mainly functions moved from filter code) to implement
	the new API, add filtering on reception (in open and check funcs).
	* libbalsa/filter.[hc]: move code to mailbox files.
	* libbalsa/libbalsa-marshal.list: add BOOLEAN:POINTER
	* src/filter-run-callbacks.c use new functions.

2003-03-26  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/address-book-ldap.c: LDAP uses UTF-8 and so do we.
	* src/main.c: fix -i CLO (bug 109293).
	* src/save-restore.c: fix --without-esmtp (bug 109234).

2003-03-24  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS, configure.in: release 2.0.10

2003-03-24  Albrecht Dreß  <albrecht.dress@arcor.de>

	further work on GPG
	* libbalsa/message.h: add sig_state field.
	* libbalsa/send.c: proper encryption when multiple recipients.
	* libbalsa/rfc3156.[hc]: better error handling.
	* src/balsa-icons.[hc]: new pixmaps.
	* src/balsa-index.c: improve the display of the sig/encrypt state.
	* src/balsa-message.c: implement balsa_message_scan_signatures()
	* src/sendmsg-window.h: add gpg_mode field.
	* src/sendmsg-window.c: gpg mode switching UI.

2003-03-24  Carlos Morgado  <chbm@chbm.nu>

	* HACKING: added contacts

2003-03-24  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-message.c: fix misspelling (bug 109074)
	* src/sendmsg-window.c: fix split sentence (bug 109073).
	* src/main.c, configure.in: revert C. Neumair's changes.

2003-03-21  Christian Neumair  <chris@gnome-de.org>

	* src/main.c: Use gtk_window_set_default_icon_from_file instead of
	gnome_window_icon_set_default_from_file to set default icon.
	Requires GTK-2.2.
	* src/main-window.c: Don't mark Copyright string for translation,
	UTF-8-escape it.
	* src/message-window.c: Marked missing menu labels for translation.
	* src/information-dialog.c: HIGified.
	* configure.in: Require at least GTK-2.2.

2003-03-20  Guntupalli Karunakar  <karunakar@freedomink.org>

	* configure.in: Added Mayalalam (ml) in ALL_LINGUAS

2003-03-18  Albrecht Dreß  <albrecht.dress@arcor.de>

	* libbalsa/body.[ch]: add, initialize destroy GPG-related fields.
	* libbalsa/message.[ch]: implement is_pgp_{signed,encrypted}()
	* libbalsa/send.c: more detailed error info from libbalsa_create_msg().
	* src/balsa-icons.[ch]: add info_lock icon.
	* src/balsa-index.c: display info_lock icons.
	* src/main.c: init gpgme.
	* src/sendmsg-window.c: send encrypted messages.
	* configure.in: configure GPGME
	* libbalsa/rfc3156.[hc]: add.
	* src/pixmaps/info_lock.xpm: ditto.

2003-03-15 07:40  PeterB

	* libbalsa/misc.c: Wrap utf-8 patch
	(http://mail.gnome.org/archives/balsa-list/2003-March/msg00075.html
	); with minor change
	(http://mail.gnome.org/archives/balsa-list/2003-March/msg00077.html
	).

2003-03-14 10:32  PeterB

	* src/: balsa-app.c, balsa-app.h, balsa-message.c, pref-manager.c,
	save-restore.c, sendmsg-window.c, sendmsg-window.h: Take the MDN
	and "format-flowed" options out of the config, and take the
	send/queue option out of the compose window's Options menu.
	* libbalsa/: body.c, body.h, mime.c, misc.c, misc.h, send.c: Rename
	libbalsa_flowed_rfc2646 as libbalsa_message_body_is_flowed, and
	move it from libbalsa/misc.[ch] to libbalsa/body.[ch].

2003-03-13 13:23  PeterB

	* src/sendmsg-window.c: Use translated strings for headers when
	using external editor; use g_string_append_printf.

2003-03-13  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/filter-funcs.[hc]: new functions to compare conditions.
	* libbalsa/mailbox.[hc]: replace get_matching message by message_match.
	* libbalsa/mailbox_imap.[hc]: optimized handler.
	* libbalsa/libbalsa-marshal.list: add BOOLEAN:POINTER,INT,POINTER
	* src/balsa-index.c: use the new functions.

2003-03-13  Pawel Salek  <pawsa@theochem.kth.se>

	* src/{ab-window.c,address-book-config.c}: enable NLS again.

2003-03-12 16:44  PeterB

	* src/balsa-index.c: Don't clear the index when there's one message
	left.
	* src/pref-manager.c: Implement pm_page_add_to_size_group to
	simplify alignment.
	* src/sendmsg-window.c: Add `format-flowed' to message options
	menu.

2003-03-12  Pawel Salek  <pawsa@theochem.kth.se>

	* src/print.c: mark a string for translation.
	* libbalsa/identity.c: enable NLS.

2003-03-11 17:17  PeterB

	* src/balsa-index.c: Don't clear the index when it's not empty.
	* src/filter-edit-callbacks.c: Use a non-modal condition-edit
	dialog, and desensitize the filter-edit dialog while the
	condition-edit dialog is open.
	* libbalsa/identity.c: Confirm deletion in a non-modal dialog.
	* src/sendmsg-window.c: Make sure an identity has an address before
	comparing it with another string.

2003-03-10 20:08  PeterB

	* src/: balsa-index.c, main-window.c, store-address.c,
	store-address.h: Non-modal store address dialog.

2003-03-09 22:54  PeterB

	* libbalsa/identity.c, src/balsa-message.c, src/folder-conf.c,
	src/information-dialog.c, src/mailbox-conf.c, src/mailbox-node.c,
	src/main-window.c, src/sendmsg-window.c, src/store-address.c: Use
	[lib]balsa-information for error messages.
	* src/print.c: Close print dialog when compose window is closed.

2003-03-08 00:26  PeterB

	* src/: main-window.c, message-window.c, print.c, print.h,
	sendmsg-window.c, sendmsg-window.h: Allow only one print dialog,
	even for the compose window.

2003-03-07 11:44  PeterB

	* src/balsa-index.c: Don't count deleted messages when looking for
	duplicates.

2003-03-06 13:54  PeterB

	* src/: sendmsg-window.c, spell-check.c, spell-check.h: Non-modal
	spell checker.
	* src/mailbox-conf.c: Use identity set by user in mailbox conf
	dialog.

2003-03-06  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/filter.c: utf8-aware filtering.
	* libbalsa/pop3.c: better UI feedback of the dowload progress.

2003-03-04 11:26  PeterB

	* libbalsa/misc.c: Fix infinite loop when not wrapping.

2003-03-03 18:39  PeterB

	* libbalsa/message.h, libbalsa/misc.h, libbalsa/send.c,
	libbalsa/send.h, src/main-window.c: Drop encoding and flow
	arguments to libbalsa_process_queue; we can get them from the
	messages in the outbox, on a per-message basis.

2003-03-02 18:02  PeterB

	* src/: balsa-message.c, pref-manager.c: Separate wrapping from
	recognizing `format=flowed' in incoming messages.
	* doc/C/balsa.xml: Add documentation for Mailbox => Edit/Apply
	Filters, Mailbox => Remove Duplicates.
	* src/sendmsg-window.c: Make address book dialog non-modal.
	* src/ab-window.c: Fix packing options.

2003-02-28  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/libbalsa.c: recignize 8-bit charsets before euc-xx etc.
	* libbalsa/mailbox_pop3.c: partially fix progress dialog (Emmanuel).
	* libbalsa/mailbox_local.c: run filters on reception (Emmanuel).
	* src/balsa-{app,message}.[hc]:
	* src/{main,message}-window.c:
	* src/print.c: fix Show all toolbar button (Steve Wall)
	* src/balsa-index.c: use bold font to mark unseen messages.
	* src/mailbox-conf.c: fix bug 107299.

2003-02-28 15:21  PeterB

	* src/balsa-message.c: Fix header indents.

2003-02-27  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-index.c: add extra protection via weak pointers.
	* src/balsa-message.c: lock gdk in idle handler.
	* src/sendmsg-window.c: use timeout instead of idle for checking
	on external editor.

2003-02-27 15:55  PeterB

	* libbalsa/source-viewer.c: Make text not editable (!)
	* src/: balsa-index.c, balsa-index.h, main-window.c: Implement
	Mailbox=>_Remove Duplicates.

2003-02-27  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/misc.c: 
	* libbalsa/libbalsa.c:
	be a bit smarter about finding domainname

2003-02-27  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox_imap.c: remove forgotten gdk locks from libbalsa.
	* src/balsa-app.c: threads do not hold gdk lock here.
	* src/balsa-index.c: unlock gdk before entering time consuming
	operation.

2003-02-25 13:37  PeterB

	* src/: balsa-app.c, balsa-index.c, balsa-mblist.c, mailbox-node.c:
	Scan deep enough to open remembered mailboxes.

2003-02-24  Carlos Morgado  <chbm@chbm.nu>

	* src/pref-manager.c: 
	* src/balsa-app.h: 
	* src/main-window.c: 
	* src/save-restore.c:
	upport of autocommit + use timeouts in seconds internaly

2003-02-23  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS, configure.in: prepare 2.0.9 release.
	* balsa.desktop: startup notification support.
	* {libinit_balsa,libbalsa,src}/Makefile.am: support distcheck target.
	* libbalsa/filter-{funcs.[hc],private.h}: cleanup API.
	* libbalsa/filter.[hc]: ditto.
	* src/filter-{run,edit}-callbacks.c: use cleaner API.
	* src/balsa-message.c: display more message/* type message parts.
	* src/filter-run-callbacks.c, src/save-restore.c: compile on phoebe3.

2003-02-23  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-app.c: fix deadlock on filtering.
	* libbalsa/filter.c: applying filters in presence of deleted messages
	fixed (Emmanuel).

2003-02-22 07:54  PeterB

	* libbalsa/address-entry.c, libbalsa/identity.c,
	libbalsa/information.c, libbalsa/libbalsa.c, src/balsa-app.c,
	src/balsa-index.c, src/balsa-index.h, src/balsa-message.c,
	src/main-window.c, src/main.c, src/message-window.c,
	src/sendmsg-window.c: Deprecation cleanup (gtk_{idle,timeout}* =>
	g_{idle,timeout,source}*).

2003-02-20 15:52  PeterB

	* src/: main-window.c, sendmsg-window.c: Remove conflicts over
	ctrl+A accelerators; make main window's `Edit => Select All'
	focus-aware; make compose window's `Edit => Select All' consistent
	with main window.

2003-02-19  Carlos Morgado  <chbm chbm.nu>

	* src/balsa-index.c: actually update last_use so that autocommit and autoclose work. we're a little too liberal updating it

2003-02-19 Steve Wall  <hitched97@myrealbox.com>

	* src/balsa-message.c: add '<' brackets to content-ID.

2003-02-18 23:02  PeterB

	* src/: balsa-app.c, balsa-app.h: Clean up sort utilities api.

2003-02-18  Emmanuel <e.allaud@wanadoo.fr>

	* libalsa/send.c: fix --without-estmp (bug 106377).

2003-02-17  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-mblist.c: set-unread-message-flags must be handled idle.

2003-02-16  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS, configure.in, Makefile.am: release balsa-2.0.8

2003-02-16 10:05  PeterB

	* src/mailbox-node.c: Find special mailboxes by mailbox instead of
	by url.

2003-02-15  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-mblist.c (bmbl_node_style): enforce view update (gtk2-2.2).

2003-02-14  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox.c: initialize progress_notify.
	* libbalsa/mailbox_pop3.c: remove unnecessary includes and wrong 0.

2003-02-14  Pawel Salek  <pawsa@theochem.kth.se>

	* balsa.spec.in: update requirements.
	* libbalsa/mailbox_{local,imap,pop3}.c: remove unneeded locks.
	* src/mailbox-conf.c: enable mailbox check had wrong table row index.

2003-02-13  Pawel Salek  <pawsa@theochem.kth.se>

	* src/main-window.c: remove unneeded GDK locks.

2003-02-13 21:44  PeterB

	* src/main-window.c: Check that a message is in a mailbox.
	* src/balsa-index.c: Check that we have a current message before
	testing its flags.

2003-02-12 07:49  PeterB

	* src/balsa-mblist.c: Fix #105871: make mblist columns resizable
	again.

2003-02-11 19:13  PeterB

	* src/balsa-index.c: Use a weak pointer to find out when the
	BalsaIndex has been destroyed.
	* src/balsa-index-threading.c: Really try to avoid loops in the
	thread tree.

2003-02-11  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: aspell-0.50 library is called libaspell (bug 105763).

2003-02-08  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS,configure.in: release balsa-2.0.7
	* libbalsa/misc.[hc]: implement libbalsa_urlencode() as in bug #105605.
	* libbalsa/mailbox_imap.c: use it.

2003-02-08  PeterB

	* src/balsa-index-threading.c: When a message is duplicated, use
	the replied-to copy as the head of a subthread.
	* src/balsa-mblist.c: Clean up sorting the mailbox list (Manu);
	simplify bmbl_row_compare.

2003-02-07  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-index.c: idle handlers should handle expunged messages.
	* src/balsa-mblist.c: idle handler for "set-unread-messages-flag".
	
2003-02-07 04:23  PeterB

	* src/balsa-index-threading.c: Properly thread duplicates in jwz
	threading (thanks to jwz for clarification!); use GNode api to
	simplify code.

2003-02-07  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox.c: remove some references to GDK to reduce
	interface locks.
	* libbalsa/mailbox_imap.[hc]: same. 
	Implement libbalsa_mailbox_imap_noop() to ping live connections.
	* src/balsa-app.c: ping imap connections (move to libbalsa?).
	* src/balsa-index.c: make libbalsa signal handlers thread-safe.
	* src/main-window.[hc]: support SMTP after POP3.
	
2003-02-06  Carlos Morgado  <chbm@chbm.nu>

	* src/sendmsg-window.c: correct loc_utf8_pos

2003-02-05  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox_pop3.[hc]: Add filter_cmd field.
	* libbalsa/pop3.[ch]: configurable filter command.
	* src/mailbox-conf.c: configure filter command.

2003-02-03 22:24  PeterB

	* src/sendmsg-window.c: Check for orig_message->mailbox before
	setting `replied' or deleting the message (mailbox is NULL if the
	orig_message has itself been deleted).
	* src/balsa-message.c: Rearrange part_info_init_unknown display.
	* libbalsa/: mailbox.c, message.c: Code cleanup (Manu).
	* src/: balsa-index-threading.c, balsa-index.c, balsa-index.h: Add
	a hash table of GtkTreeRowReferences to BalsaIndex, and use it in
	threading the index and finding messages.

2003-02-01 14:25  PeterB

	* libbalsa/mailbox.h: Add LB_MAILBOX_SORT_SENDER to the
	LibBalsaMailboxSortFields enum.
	* src/balsa-index.c: Add sorting by sender and subject; use gtk+
	methods to do the work. Simplify bndx_moveto (Manu). Fix a
        memory leak in bndx_copy_tree. Recreate tree store when setting
        flat threading.

2003-02-01  Pawel Salek  <pawsa@theochem.kth.se>

	* README: info about libesmtp cert location (bug 102566).
	* balsa.desktop: correct category (bug 104964).
	* src/address-book-config.c: resolve shortcut conflicts.
	* src/pref-manager.c: scrollbar for address books (Bug 104984).
	
2003-01-30  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox_imap.c: remove misspelling in the message
	* src/main-window.c: resolve shortcut conflict in Find dialog.

2003-01-29  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: fix the openssl test (bug 104758, marcus@freebsd.org).

2003-01-29  Pawel Salek  <pawsa@theochem.kth.se>

	* NEWS, configure.in: release 2.0.6.

2003-01-29  PeterB

	* src/balsa-index.c: Use GtkTreeIter instead of GtkTreePath to
	iterate through the tree.
	* src/print.c: Work around poor error handling in gnome_font_find.

2002-12-28  Daniel Yacob  <yacob@geez.org>

	* configure.in: Added Amharic (am) in ALL_LINGUAS.

2003-01-28  Pawel Salek  <pawsa@theochem.kth.se>

	* src/print.c: fix Bug 104586
	* src/balsa-app.h: change print font defaults.

2003-01-27  PeterB

	* src/main-window.c: Grab focus to the mailbox index when opening
	mailbox, even if not displaying a message.
	* src/balsa-index.c: Sort index after populating and initially
	threading it.

2003-01-25  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/filter.c: fix possible mail duplication on filtring (Manu).
	* libbalsa/mailbox.c: default NULL identity.
	* src/{mailbox,folder}-conf.c: improve mailbox identity edition.
	* src/mailbox-node.c: remove debugging output.
	* src/main.c: load identities.

2003-01-25  PeterB

	* src/balsa-index.c: Two patches from Manu <e.allaud@wanadoo.fr>:
	1. search for messages without cycling through the whole mailbox;
	2. clean up thread_has_unread. Also postpone the call to
	bndx_set_parent_style until after rethreading.

2003-01-25  Christian Neumair  <chris@gnome-de.org>

	* libbalsa/identity.c: Reordered buttons to satisfy HIG.
	* src/mailbox-conf.c: Use GTK+ stock buttons where possible. Reduces
	number of strings marked for translation.

2003-01-22  Pawel Salek  <pawsa@theochem.kth.se>

	Compile against gnome-2.2 and openssl-0.9.7
	* configure.in: lower 2.2 requirements on libgnomeprint{,ui},
	support openssl-0.9.7
	* libbalsa/address-book-ldap.c: handle connection errors better.

2003-01-21  PeterB

	* src/folder-conf.c: Non-modal IMAP sub-folder dialog; use common
	code for the folder and sub-folder dialogs as far as possible.

2003-01-20  Pawel Salek  <pawsa@theochem.kth.se>

	Switch branches: gnome2 port is not in main branch. balsa-1.4x 
	in in BALSA_1_4_x

2003-01-20  Pawel Salek  <pawsa@theochem.kth.se>

	* src/sendmsg-window.c: make sig switching utf-8 safe. Add Esperanto.

2003-01-18  PeterB

	* src/folder-conf.c: Non-modal IMAP folder dialog.
	* src/balsa-index.c: Use gtk_tree_model_get_iter_first to test for
	any messages, instead of gtk_tree_model_iter_n_children, which
	could be time-consuming (Manu).

2003-01-17  PeterB

	* src/balsa-index.c: Remove a redundant test (Manu).

2003-01-17  PeterB

	* libbalsa/address-book-vcard.c: Silently return TRUE from
	load_vcard_file if the file contains no addresses.
	* src/balsa-index.c: Remove a redundant test (Manu).

2003-01-16  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: detect whether LDAP lib supports TLS.
	* libbalsa/address-book-ldap.[hc]: support authenticated bind.
	* libbalsa/address-book.c: clean the address book section.
	* src/address-book-config.c: edit authentication entries.

2003-01-16  PeterB

        * src/main.c: Get an exclusive mailbox nodes lock before
        appending subtrees.
	* src/: balsa-mblist.c, balsa-mblist.h, mailbox-node.c,
	mailbox-node.h: Move balsa_mblist_scan_mailbox_node
	from balsa-mblist.c to mailbox-node.c and rename it as
	balsa_mailbox_node_scan_children; Rescan mailbox nodes more
	robustly.

2003-01-15  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox.c: store config prefix.
	* src/mailbox-conf.c: handle better empty fields.
	
2003-01-15  PeterB

	* src/mailbox-node.c: Fix #102139 (append-subtree failed for
	  `special' IMAP mailboxes).

2003-01-14  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/filter.c:compile with --disable-threads

2003-01-14  PeterB
        * libbalsa/mailbox.c (libbalsa_mailbox_link_message): Don't
          count deleted messages.

2003-01-13  Pawel Salek  <pawsa@theochem.kth.se>

	Albrecht Dress's patch to ignore alternative HTML parts.
	* src/balsa-app.h: add a new gboolean config variable display_alt_plain
	* src/balsa-message.c: modify scanning of multipart/alternative msgs.
	* src/pref-manager.c: add a check button in Display->Message.
	* src/save-restore.c: save & restore the config variable.

2003-01-12  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-message.c: fix gtkhtml2 space requisition (bug 103156).

2003-01-12  PeterB

	* src/: main-window.c, main-window.h: Don't export
	balsa_window_set_threading_menu.
	* src/balsa-index.c: Rethread after removing messages; implement
	and use a new helper, bndx_select_message;
	balsa_window_set_threading_menu is now handled in main window;
        don't clear the index when changing threading style.
	* src/balsa-index-threading.c: Threading code must not assume
	the index is initally flat.

2003-01-11  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/address-book-ldif.c: fix UTF-8 issues and nicknames.
	* src/address-book-config.c: missing _with_mnemonic().
	* libbalsa/abook-completion.c: cleanup address field naming.
	* libbalsa/address-book-{extern,ldap,vcard}.c: 
	* libbalsa/address.[ch]: ditto.
	* src/store-address.c: add more mnemonics.
	
2003-01-11  PeterB

        * src/balsa-index.c (balsa_index_set_threading_type): Reselect
        current message after rethreading.
	* libbalsa/filter.c, libbalsa/message.h, libbalsa/send.c,
	src/balsa-index.c, src/balsa-message.c: Use macros to examine
	LibBalsaMessage flags.

2003-01-11  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-app.[hc]: Add open_mailbox_vector.
	* src/main.c: open mailboxes AFTER the folders are scanned.
	* src/save-restore.c: do not attempt to open mailbes on config_load().
	* libbalsa/mailbox.c: consistently count messages (Emmanuel).

2003-01-10  PeterB

	* src/balsa-index.c (mailbox_messages_changed_status_cb):
	If deleted messages are shown, move on when current message
	is deleted; signal the main window when message status
	changes;
        * (bndx_find_row_func): don't select deleted messages;
	* (bndx_selection_changed_func): when the selection changes,
	keep the current message if it's still selected.
	* src/save-restore.c (config_global_load): Hide deleted messages
	by default.
	* src/pref-manager.c (update_address_books): Don't select an
	invalid GtkTreeIter, when mail server list is empty.

2003-01-09  Pawel Salek  <pawsa@theochem.kth.se>

	* src/Makefile.am: remove removed balsa-index-threading.h
	* libbalsa/address-entry.[hc]: handle UTF-8 characters in
	address_entry better (bug 102958).

2003-01-08  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox-filter.c: correct errors.
	* libbalsa/mailbox_local.c: run_filters_on_reception().
	* src/filter-run-dialog.c: set dialog's default size.
	* src/save-restore.c: make the debugging message null-terminated.
	* src/sendmsg-window.c: gtk2-ify attachment dialog (PS).

2002-01-07  Naba Kumar  <naba@gnome.org>

	* configure.in: Added hi (hindi) in ALL_LINGUAS

2003-01-06 PeterB

        * src/main-window.c: Move message_print_cb from src/print.c.
        * src/print.[hc]: Move message_print_cb to src/main-window.c;
        Make print dialog non-modal and one-per-message;
        Get page margins from GnomePrintConfig.
        * src/sendmsg-window.c (print_message_cb): LibBalsaMessage no
        longer subclasses GtkObject. 

2003-01-05 PeterB

	* libbalsa/body.c (libbalsa_message_body_save_temporary,
	libbalsa_message_body_save), libbalsa/body.h, libmutt/mutt.h
	(STATE structure), src/balsa-message.c (save_dialog_ok):
        Use (const gchar *) type for file name and/or prefix.

2003-01-05  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox.[hc]: initial attempt to make mailboxes serve
	different views (future application: server side sorting/threading).
	* src/balsa-app.[hc], main-window.c: use new sort constants.
	* src/balsa-index-threading.c: ditto.
	* src/save-restore.[hc]: same+view saving code.
	* src/mailbox-node.[hc]: move view data from MailboxNode to Mailbox.
	* src/balsa-index.[hc]: use new sorting.
	* src/{mailbox,folder}-conf.c: edit identity assigned to mailbox.

2003-01-05  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in, NEWS: release 2.0.5
	
2003-01-04  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/misc.[hc]: add libbalsa_{expand,contract}_path wrappers.
	* src/sendmsg-window.c: add Czech language and ~ sig path support
	(#102472, #102470).
	* src/balsa-app.[hc]: change default action for D&D (#102140).

2003-01-03 PeterB

	* libbalsa/identity.c: Avoid potential race when destroying `Select
	Identity' dialog; use g_signal_connect_swapped to trim down code.

2003-01-03 20:09  PeterB

	* libbalsa/identity.c (libbalsa_identity_select_dialog,
        * sd_response_cb): Allow one `Select Identity' dialog per
	compose window, instead of one overall.

2003-01-03  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox_imap.c: fix use of cached messages.
	* libbalsa/message.c: actually use cached messages.

2003-01-02  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/body.[hc]: implement libbalsa_message_body_get_by_id()
	* libbalsa/message.[hc]: implement libbalsa_message_get_part_by_id().
	* src/balsa-message.c: add "request_url" signal handler (#52168).

2002-12-31  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox.c: update mailbox signal scheme (merge HEAD).
	* libbalsa/message.[ch]: remove all messages signals, they were
	redundant.
	* libbalsa/filter.c, libbalsa/send.c: use new funcs.
	* src/balsa-{index,mblist,message}.c : ditto.
	* src/{sendmsg,main}-window.c,src/print.c: the same.

2002-12-30 PeterB

	* libbalsa/identity.c (general rewrite),
        * libbalsa/identity.h,
	* src/main-window.c (ident_manage_dialog_cb),
        * src/sendmsg-window.c (change_identity_dialog_cb,
                                update_msg_identity):
          Make identity dialogs non-modal.

2002-12-30  Pawel Salek  <pawsa@theochem.kth.se>

	* src/sendmsg-window.c: include correctly non-UTF-8 files.
	* balsa.spec.in: fix #102150.
	
2002-12-28  Pawel Salek  <pawsa@theochem.kth.se>

	* src/filter-run-dialog.c, src/save-restore.c:
	* libbalsa/filter.c: fix spelling (#102092).
	* src/sendmsg-window.c: do not allow to send stuff with wrong charset.
	* libbalsa/send.c: Activate "Hide" button.

2002-12-27 14:18  PeterB

	* libbalsa/filter-funcs.c (compare_filters): Fix a memory leak.

2002-12-27  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/send.c: remove redundant unlocks.
	* src/balsa-mblist.c: display proper message count.

2002-12-27  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/address.c: wrong location of a bracket ->infinite loop.
	* src/mailbox-conf.c: fix #101993.
	* src/filter-edit-callbacks.c: do not destroy destroyed dialogs.
	* src/filter-{edit,run}-dialog.c: more shortcuts.
	* src/main-window.c: add missing shortcut.

2002-12-26  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/address.c: fix an address parsing bug introduced yesterday.
	* libbalsa/filter.c: port incremental imap queries from HEAD (Emmanuel)
	* libinit_balsa/balsa-druid-page-{directory,user}.c:
	* libinit_balsa/helper.c: add missing shortcuts.
	* libbalsa/identity.c, src/address-book-config.c: add shortcuts.
	* src/ab-window.c: fix typo (#102013).
	
2002-12-25  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: find out glib-genmarshal location (Emmanuel).
	* libbalsa/Makefile.am: collect all marshallers (Emmanuel).
	* libbalsa/address-book-extern.[hc]: return error codes on IO errors.
	* libbalsa/address-book-{ldap,ldif,vcard}.[hc]: ditto.
	* libbalsa/address-book.[hc]: ditto.
	* libbalsa/address.[ch]: parse email addresses on our own (bit rough).

	* libbalsa/libbalsa.c: add .addressbook.ldif to the list of
	automatically recognized address book names.
	* libbalsa/mailbox.c: use new marshallers.
	* libbalsa/message.c: move here libmutt-specific address conversion.
	* libbalsa/misc.[hc]: remove hand-coded marshallers.
	* libbalsa/server.c: use generated marshallers.
	* src/ab-main.c: add menu.
	* src/ab-window.c: process IO errors here.

2002-12-24  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in, INSTALL, README, NEWS: release 2.0.4
	* balsa.spec.in: mandrake-specific build requirements.
	
2002-12-23  Pawel Salek  <pawsa@theochem.kth.se>

	* balsa.spec.in: update.
	* src/address-book-config.c: compile with LDAP enabled.

2002-12-23  Artis Trops  <hornet@navigator.lv>

	* configure.in: Added Latvian (lv) to ALL_LINGUAS.

2002-12-23 00:28  PeterB

	* src/balsa-message.c (balsa_message_set): Implement
	bm_content_has_focus and bm_focus_on_first_child, and use them
	to manage keyboard focus.
	* src/balsa-index.c (balsa_index_select_next,
	balsa_index_select_previous, balsa_index_select_next_unread,
	balsa_index_select_next_flagged, balsa_index_find): Implement
	bndx_find_row_and_select and use it to simplify the message
	selection methods, now that GtkTreeView fully supports scrolling
	with use_align = FALSE.
	* src/balsa-index.c, src/balsa-index.h (bndx_find_row,
	balsa_index_find): Declare filter ops using FilterOpType enum.

2002-12-21  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/mailbox_local.c: fix the M_REOPENED fix, 
	it broke maildir for Peter

2002-12-21 PeterB

	* src/balsa-app.c: Initialize balsa_app.toolbar_wrap_button_text to
	TRUE.
	* src/mailbox-node.c (imap_dir_cb_real, add_imap_entry,
	imap_scan_destroy_tree): Fix IMAP folder scanning with
        scan_depth > 1.

2002-12-21  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: make balsa compile with aspell>=0.50
	(Artur Flinta <aflinta@at.kernel.pl>).

2002-12-20 09:46  PeterB

	* doc/C/balsa.xml, src/toolbar-prefs.c: Add help text for the
	Settings => Toolbars... dialog.
	* libbalsa/misc.c (libbalsa_make_string_from_list_p,
        * libbalsa_readfile_nostat, unwrap_rfc2646, dowrap_rfc2646,
        * libbalsa_wrap_rfc2646): Streamline use of GString.

2002-12-19  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in, src/print.c: make balsa compile with libgnomeprint-2.2
	(Artur Flinta <aflinta@at.kernel.pl>).

2002-12-19 12:46  PeterB

	* src/: Makefile.am, balsa-message.h, sendmsg-window.c (file_menu):
        Final (?) deprecation cleanup; add *_DISABLE_DEPRECATED DEFS
        in Makefile.am.
	* src/: main-window.c (help_menu),
        pref-manager.c (balsa_help_pbox_display): Change help file from
	"balsa-manual" to "balsa".
	* doc/C/balsa.xml: file balsa.xml was initially added on branch
	BALSA_2.
	* doc/C/balsa-C.omf: file balsa-C.omf was initially added on branch
	BALSA_2.
	* doc/C/: Makefile.am, balsa-C.omf, balsa-manual-C.omf,
	balsa-manual.xml, balsa.xml: Replace "balsa-manual" with "balsa"
	everywhere.

2002-12-18 09:32  PeterB

	* src/balsa-message.c (store_button_coords, check_call_url,
	part_info_init_mimetext): Fix #101292: g_signal_connect_after
	doesn't seem to work for "button_press_event" on a GtkTextView; use
	a better mask for stored_mask.

2002-12-15 22:05  PeterB

	* src/balsa-mblist.c: (balsa_mblist_mru_option_menu) *Really*
	initialize the option menu (fix bug from 2002-12-13 change).

2002-12-15  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/mailbox_local.c (libbalsa_mailbox_local_check): 
	handle M_REOPENED

2002-12-15 11:59  PeterB

	* src/sendmsg-window.c: (sendmsg_window_new, create_info_pane)
	Implement and use sendmsg_window_set_title.

2002-12-13 17:24  PeterB

	* src/balsa-mblist.c: (balsa_mblist_mru_option_menu) Correctly
	initialize the option menu; use a GDestroyNotify to destroy data,
	instead of the widget's "destroy" signal.  (bmbl_mru_menu) Use a
	GClosureNotify to destroy data, instead of the widget's "destroy"
	signal.

2002-12-13 13:36  PeterB

	* src/main-window.c: (balsa_window_real_close_mbnode) Clear the
	window's BALSA_INDEX_GRAB_FOCUS data, so we can never try to grab
	the focus to a nonexistent BalsaIndex.

2002-12-13 09:40  PeterB

	* src/balsa-mblist.c: (balsa_mblist_scan_mailbox_node) Remember
	state of mbnode->mailbox->has_unread_messages instead of checking
	all mailboxes; replace a GList with a GSList; add braces to fix an
	indent problem.

2002-12-12  Pawel Salek  <pawsa@theochem.kth.se>

	* src/sendmsg-window.c: switch signatures properly even if one of
	them is empty.
	* libbalsa/source-viewer.c: position cursor at the top.
	* libbalsa/mailbox_{local,imap,pop3}.c:
	* src/main-window.c: quick fix for double-lock problems. the true
	solution is to remove gdk_thread locks from libbalsa. (Emmanuel)

2002-12-10 20:57  PeterB

	* src/toolbar-prefs.c: refresh GtkTreeView list of current buttons
	when restoring standard layout.

2002-12-08  Pawel Salek  <pawsa@theochem.kth.se>

	* src/filter-run.h, src/filter-run-dialog.c: GNOME2-ify
	dialog. Keep properly open count.
	* src/main-window.c: remove next/prev from default set of tools.

2002-12-06  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/Makefile.am: remove threads.h
	* libbalsa/{filter,message,send}.c:
	* libbalsa/mailbox{,_imap,_local,_pop3}.c: remove threads.h
	* libbalsa/libbalsa_private.h: add extern mailbox_lock.
	* libbalsa/mailbox.h: add notification types.
	* libbalsa/send.h: add send progress procedures.
	* src/{main-window,save-restore}.c: change notification constants'
	names.
	* src/threads.h: remove libbalsa specific code.
	* src/toolbar-{factory,prefs}.c: remove threads.h
	
2002-12-04 PeterB

	* src/: balsa-app.h, main-window.c, main-window.h,
	message-window.c, message-window.h, save-restore.c,
	sendmsg-window.c, sendmsg-window.h, toolbar-factory.c,
	toolbar-factory.h, toolbar-prefs.c: Rewrite and deprecation cleanup
	of toolbar code.

2002-12-02  Pawel Salek  <pawsa@theochem.kth.se>

	* src/balsa-app.h: simplify QuoteRegex so even simple regex libs
	can parse it (spell check failed miserably on this).

2002-11-30  Pawel Salek <pawsa@theochem.kth.se>

	Start working on external address book editor + code cleanup.
	* libbalsa/address-book.c: reduce number of dependencies.
	* libbalsa/filter.[hc]: remove balsa_app dependencies.
	* libbalsa/libbalsa.c: mailbox_lock is a LibBalsaMailbox thing.
	* libbalsa/mailbox.[ch]: add "progress-notify" signal.
	* libbalsa/mailbox_pop3.[hc]: add "config-changed" signal.
	* libbalsa/misc.[hc]: add marshaller used by progress-notify.
	* libbalsa/pop3.[ch]: adapt to "progress-notify" signal.
	* src/Makefile.am: add ab-main.c
	* src/{sendmsg,main}-window.c: use new address book preview code.
	* src/main.c: initialize filters code.
	* src/save-restore.c: setup pop3 callbacks.
	* src/toolbar-prefs.c: remove redundant #include.
	
2002-11-21  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/libbalsa.c: Initialize MH* libmutt variables (#99067).
	* src/spell-check.c: UTF-8 conversion for pspell (#98335, Toralf Lund).

2002-11-05  Pawel Salek <pawsa@theochem.kth.se>

	* Makefile.am: remove intl from SUBDIRS.
	* autogen.sh: run glib-gettextize "manually".
	* balsa.spec.in: change help file location.
	* configure.in: AM_GNU_GETTEXT -> AM_GLIB_GNU_GETTEXT and cleanup.

2002-11-05  Peter Bloomfield <PeterB@cvs.gnome.org>

        * libbalsa/files.c, src/sendmsg-window.c: move tests for icon
          files to libbalsa.
        * src/balsa-app.c (balsa_app_destroy): fix #96795.

2002-11-02  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/main-window.c: use (locked) balsa_app.mailbox_nodes for
	message counting, instead of (unlocked)
	balsa_app.mblist_tree_store; use a weak_pointer instead of global
	new_mail_dialog_visible; replace deprecated items.
	* src/sendmsg-window.c: replace deprecated items.
	* src/spell-check.[ch]: replace deprecated items; move structure 
	declarations from spell-check.h to spell-check.c.
	* src/message-window.c, print.c, quote-color.c, save-restore.c:
	* src/store-address.c, toolbar-factory.c: replace deprecated items.
	* src/balsa-index.c: keep keyboard focus in message body.
	* src/balsa-message.[ch]: remove balsa_message_clear (unnecessary).
	* src/main-window.[ch]: grab the focus to the message index only when 
	switching notebook pages; store idle-handler ids as GObject data.
	* src/main.c: move initialization of balsa_app.visual and 
	balsa_app.colormap to balsa-app.c; set GNOME_PARAM_APP_PREFIX and 
	GNOME_PARAM_APP_DATADIR on startup.
	* src/balsa-app.c: initialize balsa_app.visual and balsa_app.colormap 
	here instead of in main.c.
	
2002-10-30  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/main.c: do not hang when called with -m (#97168).

2002-10-28  Pawel Salek <pawsa@theochem.kth.se>

	* NEWS, configure.in: release balsa-2.0.3

2002-10-28  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/filter-edit-callbacks.c: explain Filter date format.
	* src/mailbox-node.c: use user name in imap URL.

	* src/balsa-app.[ch], src/main-window.c, src/pref-manager.c:
	* src/save-restore.c, src/sendmsg-window.c:
	* src/toolbar-factory.c: Remove balsa_app.toolbar_style.
	* src/pref-manager.c: Replace deprecated items; implement 
	HIG-recommended style.
	
2002-10-27  Carlos Morgado  <chbm@chbm.nu>

	* src/sendmsg-window.c: added Hebrew and UTF-8 
	to language list

2002-10-27  Carlos Morgado  <chbm@chbm.nu>
	
	* libbalsa/filter.c (match_condition): fix no-threads build

2002-10-23  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: clear preview after deleting last message.
	* src/address-book-config.c: do not use same strings in different
	contexts (#96548).
	* libbalsa/address-book-ldap.c: do not crash on severed LDAP
	connections (PS).
	* src/folder-conf.c: do not crash on subfolder creation (#96720, EA).

2002-10-20  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.[hc]: streamline message deletion and removal.

2002-10-20  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/filter-file.c: date config file format: %Y-%m-%d 
	* libbalsa/filter.[hc]: fix the locking issues with body filtering;
	* libbalsa/mailbox.c, libbalsa/mailbox_pop3.c: use new filter 
	API (API change coming from previous fix).

2002-10-17  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in: added he to the list of languages.

2002-10-15  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-app.c, src/main.c: remove deprecated items; move 
	g_object_unref(balsa_app.colormap) from main() to balsa_app_destroy().
	
2002-10-12  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/misc.[ch]: implement libbalsa_utf8_sanitize.
	* src/balsa-index.c, src/balsa-message.c: use it.
	* libbalsa/source-viewer.c: use g_strescape to ascii-ize text, even if 
	it does use octal escapes!

2002-10-09  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-app.[ch]: define default print fonts.
	* src/save-restore.c: save and restore fonts.
	* src/print.c: print font selection.
	* src/main-window.c: shortcuts in search dialog (PS).

2002-09-29  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-mblist.c: fix edition of unselectable folders.
	* src/{mailbox,folder}-conf.c: add new shortcuts and unify
	existing ones (PS).
	
2002-09-27  Pawel Salek <pawsa@theochem.kth.se>

	* src/main-window.c: remove deprecated items (PB). Apply filters (EA).

2002-09-26  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: keyboard manipulation of attachments.

2002-09-25  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: show popup menu with Shift-F10
	* src/balsa-message.c, src/sendmsg-window.c: ditto. (+shortcuts by PS)

2002-09-24  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/address-book-config.c: check external program load and save
	paths; simplify code.
	* src/balsa-index.c: fix Ctrl+N and Ctrl+G; cut down on explicit
	scrolling.
	* src/folder-conf.c, src/mailbox-conf.c: BalsaMailboxNode is a GObject.
	
2002-09-24  Pawel Salek <pawsa@theochem.kth.se>

	* src/address-book.c: declare columns correctly. Unref addresses (PB).
	* src/balsa-app.[hc]: create balsa_app_destroy().
	* src/main.c: clean up exit code.
	
2002-09-23  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/address-book-config.[ch]: don't use gtk_dialog_run with a
	GnomeFileEntry in the dialog. 
	* src/pref-manager.c: new balsa_address_book_config_new api.
	* libbalsa/send.c: do not send deleted messages in outbox (#93666).
	
2002-09-21  Carlos Morgado  <chbm@chbm.nu>

	* src/balsa-app.c (ask_password_mt): upport deadlock
	fix from HEAD

2002-09-21  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/libbalsa.c: add utf-8 as fallback on SendCharset
	* src/save-restore.c: fix reassigning sentbox
	* libbalsa/mailbox_imap.c: add user to imap url

2002-09-20  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/mailbox-node.[ch], src/balsa-app.c,src/main.c: 
	BalsaMailboxNode subclasses GObject.
	* src/balsa-index.[ch]: give up on scrolling with use_align = 
	FALSE; ref/unref the mailbox_node.

	* src/mailbox-node.c: initial sort by date.
	* src/main-window.c: use balsa_window_idle_replace to clear the 
	preview; remove some dynamic casts.

	* src/balsa-icons.c: replace deprecated items.
	* src/balsa-mblist.c: avoid passing NULL strings to 
	g_ascii_strcasecmp.
	* src/folder-conf.c, src/mailbox-conf.c: replace deprecated 
	items; use GtkMessageDialog; handle dialog responses.
	* src/information-dialog.c: port the list from GtkCList to 
	GtkTreeView; replace other deprecated items.

2002-09-18  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/pop3.c: msg count instead of byte count (HEAD:20020623)
	* libbalsa/send.c: gdk_threads lock operations that can trigger GDK.
	* Makefile.am: place balsa icon properly.
	* balsa.desktop: define category.
	* balsa.spec.in: adapt to a proper location.
	* doc/xmldocs.make: change doc location to the standard one.
	* doc/C/balsa-manual-C.omf: define relation tag.
	* libbalsa/mailbox.c, src/mailbox-conf.c: remove debug output.
	* libbalsa/send.c, src/main-window.c: define proper shortcuts.

2002-09-17  Carlos Morgado  <chbm@chbm.nu>

	* src/balsa-mblist.c: port #91445 (edit->filter crash) from
	HEAD

	* src/save-restore.c: fix CRITICAL (PB) 

2002-09-17  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.[ch]: allow keyboard access and multiple 
	selection; move preview management to main-window.c; improve 
	scrolling.	
	* src/balsa-message.c: don't grab focus to the message.
	* src/main-window.[ch]: idle handler for setting the preview 
	message.

2002-09-16  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/mailbox_imap.c (get_cache_name):  add username to 
	cache dirname (#92442)

2002-09-15  Pawel Salek <pawsa@theochem.kth.se>

	* src/balsa-message.c: show reply-to header if requested (EA).
	* NEWS,configure.in: release 2.0.2

2002-09-12  Pawel Salek <pawsa@theochem.kth.se>

	* src/main-window.c, src/balsa-index.[hc]: clean up index switching
	after recent changes (PB).
	* libbalsa/send.c: compile without libesmtp (EA).

2002-09-11  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.[hc]: handle idle handlers in a safer way.

2002-09-10  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/pop3.c: gdk_thread_ locks were redundant there.

2002-09-10  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.[hc]: modify bndx_find_row to find next in thread,
	excluding messages to be removed; fix bndx_messages_remove to use
	bndx_find_row, and simplify it. postpone signalling main-window to
	an idle handler, to avoid mailbox deadlock; add previous_message
	and next_message to BalsaIndex, to inform main-window.
	* src/main-window.c: set sensitivity of next and previous message
	buttons.
	
2002-09-09  Carlos Morgado  <chbm@chbm.nu>

	* src/balsa-index.c: 2nd message is not previous from
	1st (PB)

2002-09-09  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/mailbox.[ch]: remove misguided "messages-delete-all" signal.
	* src/balsa-index.[ch]: change signal handlers for mailbox
	signals, and signalling to main-window; make balsa_index_transfer
	a BalsaIndex method; remove sync-backend as an exported method
	(and a left-over, dead,balsa_index_select_row).
	* src/balsa-mblist.c,src/message-window.c : use new api for
	balsa_index_transfer.
	* src/main-window.c: use simplified signals from BalsaIndex;
	manage sensitivity of previous, next, and next unread buttons; use
	new api for balsa_index_transfer.
	* src/sendmsg-window.c: remove calls to balsa_index_sync_backend.

2002-09-09  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/address-book-ldap.c: fix class struct size declaration.
	* libbalsa/libbalsa.c: ask_cert() can be called now from all threads.
	* src/balsa-mblist.c: remove dependence on threads.
	* src/toolbar-{prefs,factory}.c: ditto.
	* src/mailbox-node.c: disable scanning in a thread until a
	reliable scheme is developed.
	* src/main.c: remove unused, thread-related variables.
	
2002-09-08  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/filter-edit-{callbacks, dialog}.c, src/filter-edit.h, 
	* src/filter-{run,export}-dialog.c, src/filter-run.h: 
	remove/replace deprecated items; rename build_option_menu as
	fe_build_option_menu, and declare it in src/filter-edit.h instead
	of locally.


2002-09-07  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/filter-funcs.[ch]: add a utility and a helper for
	making GtkTreeView filter lists.
	* src/address-book.c, src/balsa-index.c: tighter GtkTreeView code.
	* src/filter-edit-{dialog,callbacks}.c, src/filter-edit.h,
	* src/filter-export-{dialog,callbacks}.c,
	* src/filter-run-{dialog,callbacks}.c, src/filter-run.h: replace
	GtkClist with GtkTreeView and friends; add some more sensitivity
	management.
	* src/information-dialog.c: show actually the dialog.
	* libbalsa/address-book-ldap.c: remove deprecated functions (PS).
	* libbalsa/mailbox_pop3.c: fix build with threads disabled (PS).
	* libbalsa/send.c: same (Emmanuel).
	* src/address-book-config.c: fix LDAP dialog creation + GTK_->G_ (PS).
	* src/information-dialog.c: show the information dialog.

2002-09-02  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/address-book-{ldif,vcard}.c, address-entry.c, address.c:
	* libbalsa/mailbox.c,mailbox_imap.c, message.c:
	* src/balsa-index-threading.c,balsa-index.c, balsa-mblist.c:
	* src/print.c, save-restore.c, sendmsg-window.c: 
	g_list_append() may be expensive, _prepend() is safer.

2002-08-30  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/message.[ch]: libbalsa_message_charset returns a newly
	allocated canonical charset instead of a const pointer to the
	original charset.
	* src/print.c, src/sendmsg-window.c: g_free the string returned by 
	libbalsa_message_charset. Use single callback for language menus.
	* src/store-address.c: don't mangle utf-8 when truncating.

2002-08-29  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/sendmsg-window.c: libmutt does iconv, not we.
	* src/main-window.c: reduce number of msg threading callbacks.

2002-08-28  Pawel Salek <pawsa@theochem.kth.se>

	make doc register with scrollkeeper properly.
	* Makefile.am: help renamed to doc. gnome/apps/Internet->applications
	* balsa.spec.in: test on native GNOME2 system (null).
	* configure.in: generate doc/Makefile.
	* doc/*: collect pieces from old doc and adapt them to recent
	scrollkeeper changes.

2002-08-27  Peter Bloomfield + Emmanuel

	* libbalsa/filter-file.c: mem leak + redundant code removal + mem
	leak.
	* libbalsa/filter-funcs.[hc]: old code did g_strdup on a possibly
	NULL string, avoid that + small speedup.
	* libbalsa/filter-private.h: add user header condition type.
	* libbalsa/filter.[ch]: handle search on user header.
	* libbalsa/mailbox_pop3.c: handle password, don't leave tmp files
	behind.
	* src/balsa-app.c: fix node_lock()'ing.
	* src/filter-edit-{dialog,callbacks}.c: edit user header
	conditions.
	* src/filter-edit.h: remove redundant #include.
	* src/filter-export-{dialog,callbacks}.c: complete port to
	GtkDialog.
	* src/filter-export.h: ditto.

	* src/filter-run-{dialog,callbacks}.c: ditto. some new icons.
	name should have been replaced by url.
	* src/filter-run.h: associated changes in function prototypes.
	* src/mailbox-node.c: leave threads on scanning local mailboxes as
	well.
	
2002-08-27  Pawel Salek <pawsa@theochem.kth.se>

	* src/mailbox-node.c: gcc-3.2 compiles non-standard C but we 
	do not want such a code.

2002-08-26  Pawel Salek <pawsa@theochem.kth.se>

	serialize IMAP scanning and UI operations to avoid deep-nested
	locking.
	* libbalsa/folder-scanners.[hc]: reduce number of locks held
	simultanenously.
	* src/balsa-message.c: refresh status bar properly.
	* src/mailbox-node.c: serialize scanning and UI.
	* src/main.c: do not start scanning thread here, this is an
	implementation detail.
	
2002-08-26  Carlos Morgado  <chbm@chbm.nu>

	* src/mailbox-conf.c: fix add mailbox (PB) 

2002-08-25  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/misc.c: yet another shot at format=flowed.

2002-08-24  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/misc.c: removed cruft charset related functions
	* libbalsa/libbalsa.c: utf-8 -> UTF-8 

	* libbalsa/send.c: don't set Charset, keep utf-8 
	(uncomplete)

	* libbalsa/mailbox.c: 
	* libbalsa/mailbox_local.c: 
	fix --disable-threads build
	
2002-08-22  Carlos Morgado  <chbm@chbm.nu>

	* src/Makefile.am: 
	* configure.in: 
	fix build without esmtp

2002-08-22  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/misc.c: format=flowed mistreated signatures. Fix it.

2002-08-21  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: remove deprecated code; scroll to newly
	viewable children.
	* src/balsa-mblist.[ch]: remove deprecated code; port
	balsa_mblist_mru_option_menu_set/get from HEAD.
	* src/balsa-message.[ch]: remove deprecated code; simplify MDN
	dialog.
	* src/expand-alias.c: explicitly include <string.h>.
	* src/sendmsg-window.c: use balsa_mblist_mru_option_menu_get; get
	body and accumulate addresses from a mailto URL.

2002-08-20  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/filter-file.c: remove redundant #include.
	* libbalsa/libbalsa.c, libbalsa/misc.h: store ID of main thread.
	pass UI operations to the main thread explicitely.
	* libbalsa/mailbox.c: allow thread cancelation only in safe places.
	* libbalsa/folder-scanners.c: do not lock GDK after all.
	* src/balsa-app.c: pass UI operations to the main thread
	explicitely.
	* src/main-window.c: disable thread cancelation in arbitrary places.
	* src/main.c: cancel all threads on quit.

2002-08-18  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* autogen.sh: build both with vicious-scripts and on RH beta (PS).
	* libbalsa/body.c: convert all texts by html (PB+PS).
	* libbalsa/folder-scanners.c: allow for NULL path in
	libbalsa_scanner_imap_dir.
	* libbalsa/source-viewer.c: convert to us-ascii.
	* libinit_balsa/balsa-druid-page-user.c: remove another dead line
	and other silliness.
	* src/address-book-config.c, src/balsa-app.c,
	src/balsa-index-threading.c: remove deprecated code.
	* src/address-book.[ch]: port BalsaAddressBook lists to GtkTreeView.
	* src/sendmsg-window.c: append addresses from book to current
	 addresses.

2002-08-15 Steve Wall  <hitched97@myrealbox.com>

	* configure.in: libestmp -I flag.
	* libbalsa/filter-file.c: Solaris needs __EXTENSIONS__ for strptime
	* libinit_balsa/Makefile.am: fix maintainer-clean target (PS).
	* libinit_balsa/balsa-druid-page-user.c: remove dead code.
	
2002-08-14  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/server.[ch]: LibBalsaServer subclasses GObject.
	* libbalsa/mailbox_imap.c, src/mailbox-conf.c, src/mailbox-node.c, 
	src/save-restore.c: change LibBalsaServer references.
	* libbalsa/misc.[ch]: remove deprecated code; impl. 
	libbalsa_marshal_VOID__POINTER_INT.
	* libbalsa/send.c: remove deprecated code; save and restore Charset.
	* libbalsa/source-viewer.c: remove deprecated code; GtkTextView has no 
	interface to GtkEditable.
	* libinit_balsa/balsa-druid-page-directory.c, 
	libinit_balsa/balsa-druid-page-finish.c: remove deprecated code.
	* libinit_balsa/init_balsa.c: set wmclass for druid.
	* libbalsa/Makefile.am, libinit_balsa/Makefile.am: disable
	deprecated items.
	
2002-08-14  Pawel Salek <pawsa@theochem.kth.se>

	* Makefile.am, configure.in: build gettext related stuff smarter.
	* autogen.sh: pass --intl smarter.

2002-08-13  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/message.[ch]: LibBalsaMessage subclasses GObject;
	remove deprecated code.
	* libbalsa/mailbox.c,src/balsa-message.c, src/sendmsg-window.c:
	LibBalsaMessage change.
	* libbalsa/identity.h: fix a typo and reformat.
	* libbalsa/server.c, libbalsa/threads.h: include gtk/gtk.h (prolly
	only temporarily).
	* src/balsa-index.c: LibBalsaMessage change, and improve
	bndx_messages_remove (Manu).
	* src/balsa-mblist.c: gtk_tree_view_scroll_to_cell doesn't support
	nonalign = FALSE (yet).
	* src/message-window.c: LibBalsaMessage change, and destroy window
	if message is finalized.

2002-08-11  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/toolbar-factory.c, src/toolbar-prefs.c: use
	GTK_ICON_SIZE_LARGE_TOOLBAR
	* libbalsa/message.c: port threading fix from HEAD.
	
2002-08-06  Pawel Salek <pawsa@theochem.kth.se>

	Compile with updated auto*build tools.
	* autogen.sh: work also for distributions with "native" gnome2.
	* Makefile.am: remove acconfig.h regeneration.
	* configure.in: add missing templates to AC_DEFINE
	* help/xmldocs.make: auto* tools get confused over leading -. Remove.
	* libbalsa/filter-funcs.c: prevent gcc3 warnings.
	* src/address-book.c, src/balsa-app.c,src/filter-edit-callbacks.c:
	ditto.	
	* src/balsa-index.c: collapse fixes (Peter B).

2002-08-06  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: fix message selection change on msg delete.
	
2002-08-03  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: fix next unread for deep threads.
	fix message deletion.

2002-07-31  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/libbalsa.c: set the wmclass for the TLS certificate dialog.
	* libbalsa/mailbox.[ch], libbalsa/mailbox_imap.[ch], 
	  libbalsa/mailbox_local.[ch], libbalsa/mailbox_maildir.[ch], 
	  libbalsa/mailbox_mbox.[ch], libbalsa/mailbox_mh.[ch], 
	  libbalsa/mailbox_pop3.[ch], libbalsa/mailbox_remote.[ch]: port 
	  LibBalsaMailbox* from GtkObject to GObject.

	* libbalsa/misc.[ch]: impl. libbalsa_marshal_BOOLEAN__VOID.
	* libbalsa/send.c: cleanup of fcc code.

	* src/balsa-index.c: don't use an unimplemented GtkTreeView feature; 
	LibBalsaMailbox is now a GObject.

	* src/balsa-mblist.c, src/mailbox-conf.c, src/mailbox-node.c,
	src/main.c, src/save-restore.c, src/sendmsg-window.c:
	LibBalsaMailbox is now a GObject.

	* src/balsa-message.c: headers should not be editable.
	* src/main-window.c: gtk_notebook_remove_page() unrefs the page.

2002-07-28 Steve Wall <hitched97@myrealbox.com>

	* src/balsa-message.c: fix #85728.
	* src/main-window.c: fix menu item numbers.
	* src/message-window.c: add message print menu entry.

2002-07-24  Carlos Morgado  <chbm@chbm.nu>

	* src/store-address.c:
	* src/sendmsg-window.c: 
	* src/print.c: 
	* src/message-window.c: 
	* src/main.c: 
	* src/main-window.c: 
	* src/balsa-mblist.c: 
	* src/balsa-index.h: 
	* src/balsa-index.c: 
	* src/balsa-index-threading.c: 
	* src/balsa-icons.h: 
	* src/balsa-icons.c: 
	* src/balsa-app.h: 
	* src/balsa-app.c: 
	* libbalsa/mailbox.c: 
	* libbalsa/mailbox-filter.c: 
	* libbalsa/libbalsa.c: 
	* libbalsa/identity.c: 
	* libbalsa/folder-scanners.c: 
	* libbalsa/filter.c: 
	from Peter, unglify toolbar icons - they were being stretched,
	remove some more deprecated code - move from gtk_obj to gobj

	* libbalsa/libbalsa.c: set Charset to UTF-8. this should make
	libmutt convert to utf-8 and let pango sort it out
		
	
2002-07-21  Pablo Saratxaga  <pablo@mandrakesoft.com>

	* configure.in: Added Vietnamese (vi) to ALL_LINGUAS

2002-06-28  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/folder-scanners.c:
	* src/balsa-mblist.c: more conservative imap scanning locking scheme.

2002-06-26  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-mblist.c: use "pixbuf" property of
	GtkCellRendererPixbuf instead of "stock-id"
	* src/balsa-index.c,  src/balsa-mblist.[hc], src/main-window.c,
	src/message-window.c: update status bar properly.
	
2002-06-26  Pawel Salek <pawsa@theochem.kth.se>

	* src/Makefile.am, balsa.spec.in: remove last gdbm experiment traces.
	* src/address-book-config.[hc]: proper parenting.
	* src/address-book.c: handle close button (#86495). Show both arrows.
	* src/pref-manager.c: add some mnemonics.

2002-06-25  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/libbalsa.c: improve certificate window layout. Use GtkDialog
	* src/main-window.c: compile with --disable-threads
	* src/main.c: GDK-lock idle functions.
	* src/message-window.c: open messages in separate window in idle
	function, not during window creation - this could lock WM.

2002-06-23  Pawel Salek <pawsa@theochem.kth.se>

	* src/folder-conf.c: fix IMAP subfolder creation (broken on 06-09).
	* libbalsa/folder-scanners.c: do not lock GDK when scanning imap.
	* src/mailbox-node.c: Adjust accordingly.
	* libbalsa/libbalsa.[hc]: set certificates file. GUI for cert
	acceptance.
	* src/mailbox-conf.c: IMAP mailboxes do need name entry.
	
2002-06-23  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/address.c: don't mangle the heap when full_name is empty.
	* src/balsa-mblist.c: align columns in the mb list.

2002-06-17  Pawel Salek <pawsa@theochem.kth.se>

	* balsa.spec.in: package help files.
	* src/balsa-mblist.c: right-justify the mailbox counts (Peter).

2002-06-13  Peter Bloomfield  <PeterBloomfield@MindSpring.com>
	
	* src/balsa-index.c, src/balsa-mblist.[ch], src/message-window.[ch]:
	- consolidate the mru code into balsa-mblist.c;
	- define a new GtkOptionMenu mru widget. 
	* libbalsa/message.[ch], src/print.c, src/balsa-message.c:
	replace fcc_mailbox with fcc_url.
	* libbalsa/send.c: eliminate mqi->fcc.
	* src/balsa-app.[ch], src/save-restore.c: add and manage 
	balsa_app.fcc_url
	* src/sendmsg-window.[ch]: use the mru option menu for the fcc-box.
	* src/main.c: use UTF-8 always for translated text (Christophe
	Fergeau <christophe.fergeau@laposte.net>)

2002-06-10  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in, NEWS: release balsa-2.0.1

2002-06-09  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/folder-scanners.c: debug printf->libbalsa_information.
	* libbalsa/mailbox.h: comment on field usage.
	* libbalsa/mailbox_imap.[ch]:lock mutt+rename/subscribe error checking.
	* src/balsa-app.h: senbox is special, too.
	* src/folder-conf.c: fix (hopefully for everybody) renaming.
	* src/mailbox-conf.c: cleanup renaming (many problems with local
	mailbox renaming fixed).
	* src/mailbox-node.[ch]: add balsa_mailbox_local_rescan_parent().
	a mailbox can have only one special function.
	* src/save-restore.c: changing special mailboxes adapted.

2002-06-07 Steve Wall <hitched97@myrealbox.com>

	* src/pref-manager.c: convert the three radio buttons to a single
	option menu. Break two extremely long strings into pieces.  String
	capitalization.

2002-06-05  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/filter.c:
	* src/balsa-{app.[hc],index.c,mblist.[hc]}:
	* src/mailbox-{conf,node}.c, main{,-window}.c
	* src/{message,sendmsg}-window.c: 
	* src/save-restore.c: (#84220) centralize Balsa's `find by ...'
	functions in src/balsa-app.c, and replace `find by name' with
	`find_by_url' where it was easy to do so. They also simplify the
	`most recently used' code by using the new search functions.
	* configure.in: with-esmtp accepts a parameter (#83592). (PS)

2002-06-03  Pawel Salek  <pawsa@theochem.kth.se>

	* libbalsa/mailbox_imap.c: access cache in binary mode to preserve
	message sizes.

2002-06-01  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-mblist.[ch]: replace GtkCTree with GtkTreeView and
	friends.
	* src/balsa-app.[ch]: new GtkTreeStore member of BalsaApplication.
	* src/balsa-icons.[ch]: move the mailbox icons from BalsaIconName
	to GtkIconFactory.

	* libbalsa/filter.c, src/balsa-index.c, src/folder-conf.c, 
	src/mailbox-conf.c, src/mailbox-node.c, src/main-window.c, src/main.c, 
	src/pref-manager.c, src/sendmsg-window.c: use new api for balsa-mblist.
	* libbalsa/identity.c: correct gtk_object ->g_object conversions.

2002-05-31  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/misc.c: 
	* libbalsa/Makefile.am: 
	* libbalsa/libbalsa_private.h: 
	* libbalsa/libbalsa.h: 
	* libbalsa/libbalsa.c: 
	* libbalsa/send.c:
	* libbalsa/send.h:
	* libbalsa/message.h: 
	* libbalsa/message.c: 
	* libbalsa/body.c: 
	* libbalsa/mailbox_imap.c: 
	More stuff from HEAD
	
2002-05-28  Carlos Morgado  <chbm@chbm.nu>

	* libbalsa/message.c: 
	* libbalsa/mailbox.h: 
	* libbalsa/mailbox.c: 
	* libbalsa/mailbox_imap.c: 
	* libbalsa/body.h: 
	* libbalsa/body.c: 
	* libbalsa/send.c: 
	* src/sendmsg-window.c: upport of all my stuff since start of
	BALSA_2 from HEAD 

2002-05-21  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/abook-completion.c:
	* libbalsa/address-book-{ldap,ldif,vcard}.c:
	* libbalsa/address-{book,entry}.[ch]:
	* libbalsa/address.[ch], libbalsa/{mailbox,mailbox}.c
	* src/{address-book,expand-alias,pref-manager,sendmsg-window}.c:
	* src/store-address.c: remove deprecated code from LibBalsaAddress
	and LibBalsaAddressEntry, transform addresses to GObjects - and
	associated changes.

2002-05-20  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/abook-completion.c, libbalsa/address-book-extern.[ch]:
	* libbalsa/address-book-{ldap,ldif,vcard}.[ch]:
	* libbalsa/address-book.[ch]
	* libbalsa/misc.[ch], src/address-book-config.c, src/expand-alias.c:
	* src/pref-manager.c: remove deprecated code, transform address
	books to GObjects.

2002-05-19  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/mailbox_imap.c: get rid of gdbm message cache - too
	resource-hungry. One could disable mutt's cache now.

2002-05-19  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/identity.c: grab focus, finalize the conversion to GObject.

2002-05-18  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/identity.c: make the dialogs more usable.

2002-05-18  Emmanuel <e.allaud@wanadoo.fr>

	* libbalsa/mailbox.[ch]: remove unused code.
	* src/balsa-index-threading.c: fix two issues introduced 2 days ago.
	* src/balsa-index.[ch]: make local functions static.
	* src/filter-edit-dialog.c: make dialog resizeable.
	
2002-05-16  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/mailbox.c: reimplement libbalsa_mailbox_get_type()
	without using mx_get_magic() that modified mailbox ctime.
	* libbalsa/mailbox{local,maildir,mbox,mh}.c: use it. (#81751)
	* src/balsa-index-threading.c: reduce threading scaling from N^2 to N.
	* src/balsa-index.c: specify sibling to save some time.
	* src/main-window.c: fix searching.
	
2002-05-16  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/identity.c: improve a11y of identities dialog.

2002-05-15  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/filter.[ch]: build_imap_query() added.
	* libbalsa/mailbox.[hc]: libbalsa_mailbox_real_get_matching_added().
	* libbalsa/mailbox_imap.c: optimized searching for imap.
	* libbalsa/misc.[hc]: libbalsa_marshal_POINTER__INT_POINTER() added.
	* src/balsa-index.c: restructure to use new searching code.

2002-05-14  Pawel Salek <pawsa@theochem.kth.se>

	* src/balsa-index-threading.c: cleanup by Emmanuel (extended).
	* src/mailbox-node.c: Solaris libc cannot print null string (#80149).

	* src/main-window.[ch]: do not switch threadin option more
	frequently than necessary (Emmanuel). Disable increment progress
	in MT mode - it only increased the load.

2002-05-12  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/identity.c: double-click selects default identity.
	* src/sendmsg-window.c: GtkDialog->GtkMessageDialog to save 5 lines.

2002-05-11  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-app.[hc]: make balsa_stock_button_with_label use
	mnemonics; remove balsa_stock_hbox_with_label.
	* src/balsa-index.c: use GtkImageMenuItem methods.

	* libbalsa/identity.[hc]: replace GtkCList with GtkTreeView/Model;
	use GtkDialog methods to manage dialog buttons; run the `manage
	identities' dialog and return the result instead of returning the
	dialog.

	* src/main-window.c: pick up the result from the `manage
	identities' dialog instead of running it.

2002-05-10  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/files.[hc] (libbalsa_icon_finder): return icon mime
	type if requested.
	* libbalsa/misc.c: gnome-vfs requires absolute paths and unusually
	interprets const return type (#81359).
	* src/{balsa-message.c, print.c}: use updated API.
	* src/sendmsg-window.[hc]: ditto.
	
2002-05-08  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/address.[hc]: libbalsa_address_new_*from_string()
	should take a const gchar * argument.
	* libbalsa/address-entry.[hc]: remove wrappers for
	GtkEntry/Editable methods.
	* src/sendmsg-window.c: use GtkEntry/Editable methods on
	LibBalsaAddressEntry widgets, instead of wrapped versions.
	* src/save-restore.c: rot13 ESMTP certificate passphrase before saving.

2002-05-07  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/message.c: libmutt fastcloses mailbox when it should not.
	(copy few thousands msgs between IMAP mboxes to trigger).
	* src/filter-edit-{callbacks,dialog}.c: make filters UI sensitive.
	* src/filter-edit.h: fe_enable_right_page() header added.

2002-05-07  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-index.c: implement an `Other...' dialog in place of the
	`Folder' submenu for selecting a move destination from a
	BalsaMBList.

2002-05-05  Emmanuel <e.allaud@wanadoo.fr>

	* src/address.c: fix #80502

2002-05-01  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: gnome_icon_list bug fixed; revert workaround.
	* src/sendmsg-window.c: change send shortcut.
	* libbalsa/files.c: look for document icons in proper place.

2002-04-30  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/send.c: be more verbose on most common SMTP
	configuration error (submission vs smtp).

2002-04-28  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/sendmsg-window.c: alternative mailbox referencing scheme.
	* src/balsa-message.c: work around gnome_icon_list(?) bug.

2002-04-27  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in, {libbalsa,src}/Makefile.am, libbalsa/mailbox.[ch]:
	* libbalsa/mailbox_{local,pop3}.c, libbalsa/message.c: 
	* src/balsa-app.[hc], src/balsa-index.[hc], src/mailbox-node.c: 
	* src/main-window.c, src/save-restore.[hc], balsa.spec.in:
	filters/searching not optional any longer.
 	Emmanuel Allaud's patch (+minor modifications) to fix filtering on
 	receiving 	

	* src/main-window.c: do not use deprecated API (Peter Bloomfield).
	* src/balsa-app.c: do not crash when replying a message from a
	mailbox tree that was rescanned in meantime (Peter).
	
2002-04-24  Pawel Salek <pawsa@theochem.kth.se>

	* NEWS, configure.in: release balsa-2.0.0
	* libbalsa/libbalsa.[hc]: define global libbalsa_rot13().
	* libbalsa/server.c: use it.
	* src/save-restore.c: store passwords mangled in private section.

2002-04-24  Hasbullah Bin Pit <sebol@ikhlas.com>

	* configure.in: Added Malay (ms)to ALL_LINGUAS.
	* po/ms.po: Added Malay Translation.

2002-04-23  Pawel Salek <pawsa@theochem.kth.se>

	* Makefile.am, balsa.spec.in, {sounds,images}/Makefile.am:
	* configure.in, libbalsa/files.c, libinit_balsa/helper.c:
	* src/main-window.c, src/main.c:
	make it possible to build 2.0.0 rpm. (mostly icon locations).
	* src/sendmsg-window.c: libmutt does not conversion to UTF-8.
	* src/balsa-message.c: nail down wrong VIEWPORT conversions (Peter B).

2002-04-21 Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-app.c: reliable nested mailbox_nodes locking.
	* src/address-book-config.c, folder-conf.c, pref-manager.c:
	The help-display improved. 
	* src/sendmsg-window.c: fix some whining about floating
	references, and eliminates some memory-leaking deadwood.

2002-04-21  Pawel Salek <pawsa@theochem.kth.se>

	* Makefile.am: omf-install is a created dir, remove from SUBDIRS.
	* configure.in: do not create Makefile in omf-install.
	* libbalsa/identity.c: do not destroy on double click: response.
	* src/balsa-app.c: scan locking fixed.
	* src/balsa-message.c: fix "mixed parts" support (Peter Bloomfield).
	* src/mailbox-node.c, src/main.c: proper locking on scanning.
	Scan threading is not perfect (it locks too much) but further
	improvements require too many changes to be accepted for the
	moments.

2002-04-19  Pawel Salek <pawsa@theochem.kth.se>

	* src/mailbox-nodes.c: make mailbox node locks upgradeable ro->rw.

2002-04-18  Pawel Salek <pawsa@theochem.kth.se>

	Scan mailboxes in a thread.
	* configure.in: add gnome-vfs-module.
	* src/balsa-app.[hc]: add mailbox_nodes_lock functions.
	* src/balsa-index.c, balsa-mblist.c, filter-edit-callbacks.c, 
	folder-conf.c, mailbox-conf.c, mailbox-node.c, main-window.c,
	main.c, message-window.c, pref-manager.c, save-restore.c: use them.

2002-04-17 Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/spell-check.c: utilize GtkDialog more efficiently.
	* src/sendmsg-window.c: when format=flowed and user hits `Enter', 
        properly delete preceding spaces.

2002-04-16  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/libbalsa.c: ask libmutt for data in UTF-8.
	* libbalsa/misc.[hc]: provide libbalsa_set_send_charset().
	* src/balsa-app.c: hide password when typed in in the dialog.
	* src/balsa-message.c: conversion not longer needed.
	* src/sendmsg-window.c: do not always pop up spell-check window
	* src/spell-check.c:    (Peter Bloomfield).

2002-04-15  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/folder-scanners.c: ask for folder passwords.
	* libbalsa/mailbox_imap.c: follow the password convention.
	* libbalsa/server.h: empty ("") passwd is legal.
	* src/address-book.[hc]: next round of porting to GtkDialog.
	* src/balsa-app.c, main.c: port ask_passwd
	* src/balsa-message.c: GnomeDialog->GtkDialog.
	* src/folder-conf.c, information-dialog.c, mailbox-node.c:
	* src/main-window.c, sendmsg-window.c: same.

2002-04-15 Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/spell-check.[ch]: ignore numbers.
	* src/sendmsg-window.[ch]: make spell check widget a separate dialog.
	
2002-04-14  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in: make libgtkhtml default again.
	* libbalsa/address-book-vcard.c: convert strings from locale to
	UTF-8. Forcing this is dumb (IMO).
	* libbalsa/address.h: Fix header.
	* libbalsa/identity.c: complete porting to GtkDialog.
	* libinit_balsa/balsa-druid-page-directory.c: do same.
	* libinit_balsa/{balsa-druid-page-user.c, balsa-initdruid.c}:
	* src/{address-book-config.c, balsa-app.[hc], folder-conf.c:
	* src/mailbox-conf.c: GnomeDialog->GtkDialog.
	* src/pref-manager.c: ref new address book.
	* src/print.c: remove unnecessary paper selection widget (Peter B.).
	* src/spell-check.c: compile the quote regex once per invocation;
	- highlight a bad word by selecting it; - use GtkTextIter to find
	words, instead of a regex (Peter B.).

	* src/main-window.c: disable menus on removing last message from index.
	* src/toolbar-factory.[ch]: releated cleanup.
	* libbalsa/mailbox.[hc]: per-mailbox identity by
	* src/sendmsg-window.c:  Brian Stafford <brian@stafford.uklinux.net>

2002-04-12  Pawel Salek <pawsa@theochem.kth.se>

	* src/print.c: make print work with new API (still some warnings
	displayed occassionally).
	* libbalsa/{send.c,identity.c}: use GtkDialog instead of
	GnomeDialog.
	* src/main-window.c: run identity dialog with gtk_dialog_run().
	
2002-04-11 Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/spell-check.[hc]: make spell checking work.

2002-04-11  Pawel Salek <pawsa@theochem.kth.se>

	* src/print.c: compile with new 2.0 API.

2002-04-10 Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-mblist.c: squash reason of a warning message.
	* src/balsa-message.c: mdn_dialog_delete should return a gboolean
	value.
	* src/filter-run-callbacks.c, src/filter-run.h:
	selected_list_select_row_event_cb should return a gboolean value.
	* src/main-window.c: make notebook tabs a more modest size.
	* src/print.c: gnome-print support uncoditionally compiled in.
	* src/sendmsg-window.c: extbody_dialog_delete should return a
	gboolean value. Fix GtkTextIter error when quoting by dragging,
	and simplify quoting messages.
	* src/toolbar-prefs.c: page_active_cb should return a gboolean value;
	use replace_nl_with_space() uniformly.
	
2002-04-07  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: GtkViewport is a thinner wrapper than a
	GtkScrolledWindow for the GtkTextView and HtmlView widgets.
	- GtkVbox is a thinner container for the message parts than a 
          GtkTable;
	- have emphasize_url() take care of both url text style and status
          bar text, and rename as pointer_over_url();
        - add 2-pel left and right margins to the GtkTextView widgets.


2002-04-04  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: improve resizing scheme + cleanup.
	
2002-04-04  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: resize GtkTextView widget after a timeout;
	use gdk_threads_[enter/leave] in timeout handlers.
	* src/save-restore.c: handle obsolete rgb: color specification.

2002-04-03  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: color quoted lines; handle urls in
	text/plain messages.
	* src/balsa-app.h: change specifications for default colors.
	* src/balsa-mblist.c: use Pango to set a bold font; clean up
	unread_mailbox_color code; balsa_widget_get_bold_font() is
	obsolete.
	* src/save-restore.c: change specifications for default colors.
	* src/sendmsg-window.c: allocate bad_address_color.

2002-03-27  Pawel Salek <pawsa@theochem.kth.se>

	* src/balsa-message.c:
	* src/print.c: use proper charset names instead of aliases (#76609).
	* src/sendmsg-window.c: ditto. Also, simplify entry creation (PB).

2002-03-26  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/sendmsg-window.c: font selection in compose window.
	* src/balsa-message.[hc]:
	- remove part_count member from BalsaMessage structure;
	- use gnome_icon_list_get_num_icons() instead to get number of icons;
	- set message font for header panel, and override only for subject 
	header;
	- delete obsolete code that uses charset to convert header text;
	- fix hide_all_parts() to remove only widgets that are being shown.
	
2002-03-24  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-message.c: fix remaining font issues.

2002-03-23  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/misc.[hc]: libbalsa_lookup_mime_type must allocate the
	space for its result.
	* libbalsa/files.c:
	* libbalsa/send.c: 
	* src/print.c: free the string returned by libbalsa_lookup_mime_type.
	* src/sendmsg-window.c: use the new GtkFileSelection api.
	* src/pref-manager.c: fix broken font change callback.

2002-03-21  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/server.c: make types in gtk_signal_new consistent with
	each other.
	* src/balsa-index.c: button_event_press_cb should return boolean.
	* src/balsa-mblist.c: don't try to change colors yet.
	* src/main-window.c: revert a lot of recent changes--not needed.
	* src/main.c: initialize threads and gtk.

2002-03-20  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in, acconfig.h: isblank portability test (Steve Wall).
	LibESMTP location parameter fixed.
	* libbalsa/mailbox_imap.c: use GDBM only when available (Steve Wall).
	* libbalsa/body.c: lock properly.
	* libbalsa/misc.c: remove trash from the end of mail (unwrap)
	* src/sendmsg-window.[hc]: choose properly sending charset.

2002-03-19  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/mailbox.c: replace some more LIBBALSA_TYPE_MESSAGEs
	with GTK_TYPE_POINTERs in gtk_signal_new().
	* src/balsa-app.c: be more careful getting the index from a
	mailbox.
	* src/balsa-index.c: omit some more unused arguments.
	* src/balsa-message.c: check for pending relayout in
	balsa_gtk_html_size_request, and use a timer to wait for it to
	complete; - simplify the size_request calculation.
	* src/main-window.c: omit some more unused arguments; append a new
	page in the notebook earlier, to avoid a race condition.

2002-03-18  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/mailbox.c: LIBBALSA_TYPE_MESSAGE -> GTK_TYPE_POINTER
	* src/balsa-app.c: destroy mailbox_node instead of unref'ing it.
	* balsa-index.c: omit unused arg in balsa_index_signals[SELECT_MESSAGE]
	* src/main-window.c: adjust to the arg removal. 
	* balsa_window_select_message_cb(): pick up BalsaIndex *index from
	an argument instead of balsa_window_find_current_index(); change
	notebook tab icon from GTK_ICON_SIZE_BUTTON to GTK_ICON_SIZE_MENU.

2002-03-17  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-app.[hc]: add a convenience function
	balsa_stock_hbox_with_label(), and use it in
	balsa_stock_button_with_label().
	* src/balsa-message.c: leave a destroyed BalsaMessage in a sane
	state. Use new api for gtkhtml.
	* src/balsa-index.c: use balsa_stock_hbox_with_label().
	* src/toolbar-prefs.c: fix broken code for getting the pixmap and
	mask for a stock icon, adding a wrapper to cut down on the #if's.
	* libbalsa/identity.c: fix broken code for getting the pixmap and
	bitmap for a stock icon.
	* src/sendmsg-window.c: connect the "changed" signal to the
	correct object.
	
2002-03-14  Pawel Salek <pawsa@theochem.kth.se>

	* configure.in: gtkhtml support restored.
	* libbalsa/address-entry.c: focus handling (Peter Bloomfield).
	* src/balsa-message.[hc]: more proper message displaying (PS).
	* src/sendmsg-window.c: first step to pangoization.

	* Makefile.am, help/*: help ported by Jelmer to GNOME2.
	* libbalsa/message.c: g_strsplit() to one more field (Peter B).
	* src/pref-manager.c: use gnome_file_entry_set_directory_entry (PB).
	* sound/Makefile.am: DESTDIR is not needed there after all.
	
2002-02-13  Jelmer Vernooij <jelmer@nl.linux.org>

	* libbalsa/ (some): gnome-defs.h is deprecated in GNOME2 - remove refs.

2002-03-13  Pawel Salek <pawsa@theochem.kth.se>

	* src/balsa-message.c: show first messages.

2002-03-13  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/*,libinit_balsa/*, libbalsa/identity.c, libbalsa/misc.[hc]:
	make entire balsa compile within GNOME2.
	src/balsa-app.c, src/spell-check.c: hush critical errors.

2002-03-10  Pawel Salek <pawsa@theochem.kth.se>

	* libbalsa/libbalsa_private.h: do not include gnome.h here.
	* libbalsa/mailbox.c:
	* libbalsa/mailbox_imap.c: 
	* libbalsa/mailbox_local.c: 
	* libbalsa/mailbox_pop3.c: 
	* libbalsa/message.c: 
	* libbalsa/pop3.c: 
	* libbalsa/send.c: 
	* libbalsa/server.c: 
	* libbalsa/source-viewer.c: include only needed pieces of gnome here.
	* src/sendmsg-window.c: it is legal to have no signature.
	
2002-03-09  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* configure.in: gtkhtml was renamed to libgkthtml. Take into account.
	* src/address-book-config.c, address-book.c:
	* src/balsa-app.c,balsa-icons.c, filter-edit-dialog.c:
	* src/filter-run-dialog.c, pref-manager.c,store-address.c: reduce
	number of preprocessor conditionals.
	* src/toolbar-factory.c,toolbar-prefs.c: port to gnome2.
	
2002-03-09  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libinit_balsa/*: get rid of gob. Port to gnome2.
	* configure.in: remove test for gob.

2002-03-04  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-icons.[hc], src/filter-run-callbacks.c,
	src/filter-run-dialog.c, src/pixmaps/*.xpm: ported.

2002-03-03  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* configure.in: define BALSA_VERSION
	* src/address-book-config.c,
	src/address-book.c, src/balsa-app.c, src/balsa-index.c,
	src/balsa-index.h, src/filter-edit-callbacks.c,
	src/filter-edit-dialog.c, src/filter-export-callbacks.c,
	src/filter-export-dialog.c, src/filter-run-callbacks.c,
	src/filter-run-dialog.c, src/filter-run.h,
	src/information-dialog.c, src/mailbox-conf.c, src/mailbox-node.c,
	src/main-window.c, src/main.c, src/message-window.c,
	src/save-restore.c, src/store-address.c, src/toolbar-factory.h: 
	do the porting.

2002-03-01  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/folder-conf.c: ported.
	
2002-02-27  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/balsa-mblist.c: port.
	* src/balsa-index.c: remove redundant call to balsa_index_init().

2002-02-25  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* libbalsa/*: remove uncesessary #includes (PS)
	* src/*: Further work on porting to GNOME2.

2002-02-24  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* src/Makefile.am, src/address-book-config.c,
	src/address-book.[hc], src/spell-check.[ch]: src directory Gnome2
	porting work	
	* libbalsa/send.c: extra signal callback type cast.

2002-02-22  Pawel Salek <pawsa@theochem.kth.se>

	* autogen.sh, configure.in: previouse updates were not universal.

	* libbalsa/address-book-extern.c, libbalsa/address-book-ldif.c,
	libbalsa/address-book.c, libbalsa/address-entry.c,
	libbalsa/address.c, libbalsa/files.c, libbalsa/filter-file.c,
	libbalsa/filter-funcs.c, libbalsa/filter.c,
	libbalsa/folder-scanners.c, libbalsa/identity.c,
	libbalsa/libbalsa.c, libbalsa/mailbox.c, libbalsa/mailbox_imap.c,
	libbalsa/mailbox_local.c, libbalsa/message.c, libbalsa/misc.[hc],
	libbalsa/pop3.c, libbalsa/send.c, libbalsa/server.c,
	libbalsa/source-viewer.c:
	Make libbalsa.a compile against GNOME2. The only major changes
	were related to MIME handling and GtkText (gnome-mime and GtkText
	are deprecated). Some extra cleanup (unused variables).

2002-02-20  Pawel Salek <pawsa@theochem.kth.se>

	Start port to GNOME2. Based on Jelmer Vernooij's work.
	* configure.in, Makefile.am, acconfig.h,
	libbalsa/Makefile.am: modify just to make it compile
	* libbalsa/address-book.c, libbalsa/misc.h: make first file compile.

AC_INIT(src/main.c)
AM_CONFIG_HEADER(config.h)

dnl
dnl take care of version
dnl
BALSA_MAJOR=0
BALSA_REVISION=4
BALSA_PATCHLEVEL=9
BALSA_VERSION="$BALSA_MAJOR.$BALSA_REVISION.$BALSA_PATCHLEVEL"
VERSION="$BALSA_MAJOR.$BALSA_REVISION.$BALSA_PATCHLEVEL"

dnl configure libmutt
AC_CONFIG_SUBDIRS(libmutt)

AM_INIT_AUTOMAKE(balsa, [$VERSION])

AM_MAINTAINER_MODE
AM_ACLOCAL_INCLUDE(macros)


GNOME_INIT


AC_ISC_POSIX
AC_PROG_CC
AC_STDC_HEADERS
AC_ARG_PROGRAM
AM_PROG_LIBTOOL


dnl this should come after `AC_PROG_CC'
GNOME_X_CHECKS

balsa_save_LDFLAGS="$LDFLAGS"
balsa_save_LIBS="$LIBS"

LDFLAGS="$LDFLAGS `echo $GTK_LIBS | sed 's/\(.*\)\(-lgtk.*\)/\1/'`"
LIBS="$LIBS $GTK_LIBS"

AC_CHECK_LIB(PropList, PLGetProplistWithPath, ,
AC_MSG_ERROR([*** libPropList not found.  Please check http://www.balsa.net for information on the required files.]),)

LDFLAGS="$balsa_save_LDFLAGS"
LIBS="$balsa_save_LIBS"

ALL_LINGUAS="de es fi fr ga ko no it nl ru"
AM_GNU_GETTEXT


AC_SUBST(CFLAGS)
AC_SUBST(CPPFLAGS)
AC_SUBST(LDFLAGS)

gnome_cv_use_gnome=yes

AC_DEFINE_UNQUOTED(BALSA_MAJOR, $BALSA_MAJOR)
AC_DEFINE_UNQUOTED(BALSA_REVISION, $BALSA_REVISION)
AC_DEFINE_UNQUOTED(BALSA_PATCHLEVEL, $BALSA_PATCHLEVEL)
AC_DEFINE_UNQUOTED(BALSA_VERSION, "$BALSA_VERSION")

AC_CHECK_LIB(crypt, crypt)

dnl these may be used later.
dnl AC_CHECK_LIB(des, des_encrypt)
dnl AC_CHECK_LIB(krb, krb_sendauth)
dnl AC_CHECK_LIB(acap, acap_OpenConnection)


AM_HDR_SIGACTION
AM_HDR_SIGSET


dnl ORBit support
AC_CHECK_PROG(ORBIT_CONFIG, orbit-config, orbit-config)
if test -n "$ORBIT_CONFIG"; then
	ORBIT_LIBS="`orbit-config --libs client server --use-service=name`"
	ORBIT_CFLAGS="`orbit-config --cflags client server --use-service=name`"
fi
AC_SUBST(ORBIT_CFLAGS)
AC_SUBST(ORBIT_LIBS)
AM_CONDITIONAL(ORBIT_INSTALLED, test -n "$ORBIT_LIBS")

ORB_LIBS="$ORBIT_LIBS"
ORB_CFLAGS="$ORBIT_CFLAGS"

AC_SUBST(ORB_LIBS)
AC_SUBST(ORB_CFLAGS)




dnl Automake @VARIABLE@ exports.
AC_SUBST(BALSA_MAJOR)
AC_SUBST(BALSA_REVISION)
AC_SUBST(BALSA_PATCHLEVEL)
AC_SUBST(BALSA_VERSION)
AC_SUBST(LIBOBJS)
AC_SUBST(LIBESD_LIB)


dnl Enable all
AC_ARG_ENABLE(all, [  --enable-all            Enable incomplete features [default=no]],
AC_DEFINE(BALSA_SHOW_ALL),)

dnl Enable information in the mailbox list
AC_ARG_ENABLE(info, [  --enable-info           Enable mailbox info (broken) [default=no]],
AC_DEFINE(BALSA_SHOW_INFO),)

dnl Create files.
AC_OUTPUT([
Makefile 
balsa.spec
po/Makefile.in
macros/Makefile
intl/Makefile
sounds/Makefile
images/Makefile
libbalsa/Makefile
idl/Makefile
src/Makefile
],[sed -e "/POTFILES =/r po/POTFILES" po/Makefile.in > po/Makefile])

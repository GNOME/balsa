2004-07-04  Carlos Morgado  <chbm gnome.org>

	* handler.c: patch from Albrecht to expose 
	always expose illegal 8bit chars to libbalsa

2003-08-19 14:17  PeterB

	* imap/imap.c: Use value returned by
	uid_search_parse_response() more carefully.

2003-07-21  Pawel Salek  <pawsa@theochem.kth.se>

	* buffy.[hc]: add mutt_buffy_free() routine.

2003-04-03  Albrecht Dress  <albrecht.dress@arcor.de>

	* handler.c: remove LIBMUTT specific section.

2003-03-20  Carlos Morgado  <chbm chbm.nu>

	* imap/utf7.c:  fix exploitable buffer overflow
	http://marc.theaimsgroup.com/?l=mutt-dev&m=104811170330897&w=2

2003-03-18  Albrecht Dress  <albrecht.dress@arcor.de>

	* protos.h, sendlib.c: add forced multipart subtype.

2003-03-16  Christian Neumair  <chris@gnome-de.org>

	* edit.c, main.c: Fixed unmatched quotes.

2003-02-23  Pawel Salek  <pawsa@theochem.kth.se>

	* {,imap/}Makefile.am: support distcheck target.

2003-01-30  Pawel Salek  <pawsa@theochem.kth.se>

	* mutt_socket.c: do as you say regarding the returned value.
	* imap/command.c: process correctly responses longer than 512.

2003-01-20  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: compile against openssl-0.9.7
	
2003-01-10  Pawel Salek  <pawsa@theochem.kth.se>

	* parse.c: follow rfc2045 closer.
	restore parsing dispnotify_to (Albrecht Dreß).

2003-01-03  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/message.c,imap/imap.h: pull imap_update_header info() out of
	imap_fetch_message().

2003-01-02  Pawel Salek  <pawsa@theochem.kth.se>

	* parse.c: add id body parameter if Content-ID found.

2002-10-15  Carlos Morgado  <chbm@chbm.nu>

	* imap/message.c (imap_append_message): read last line

2002-09-14  Carlos Morgado  <chbm@chbm.nu>

	* handler.c:  we live in a MIME world, non MIME is us-ascii (PB)

2002-08-29  Carlos Morgado  <chbm@chbm.nu>

        * rx/: removed. it wasn't used

2002-08-28  Pawel Salek  <pawsa@theochem.kth.se>

	* Makefile.am: remove acconfig.h - fix dist target.

2002-08-26  Pawel Salek  <pawsa@theochem.kth.se>

	* browser.h: add cb_state field to browser.

2002-08-06  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: use AC_LIBOBJ, add missing AC_DEFINE templates.

2002-06-23  Pawel Salek  <pawsa@theochem.kth.se>

	* mutt_ssl.c: support for storing SSL certificates.

2002-06-09  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/browse.c: imap_mailbox_rename() return status.
	* imap/imap.[ch]: imap_subscribe accepts const char* argument.

2002-05-31  Carlos Morgado  <chbm@chbm.nu>

	* Makefile.am:
	* rfc1524.c:
	* rfc2231.c:
	* rfc2231.h
	sync with HEAD
	
2002-05-30  Carlos Morgado  <chbm@chbm.nu>

	copied libmutt from HEAD to BALSA2, there were some changes
	on HEAD uncommited to 2
	
	* send.c: unused, removed  

	* sendlib.c: 
	* rfc2047.c: 
	* handler.c: 
	* configure.in: 
	* charset.h: iconv changes

	* imap/util.c: 
	* imap/message.c: 
	* imap/imap.c:
	* imap/command.c: 
	* imap/message.c: 
	* imap/browse.c: 
	* mx.c: 
	* muttlib.c: 
	* mailbox.h: 
	* lib.h: 
	* lib.c: 
	* buffy.c: 
	* browser.c: 
	* parse.c: 
	* mx.c: 
	* mutt_sasl.c: 
	* mbox.c: 
	* init.c: 
	* charset.c: 
	sync with mutt-1.4. 
	
2002-05-20  Carlos Morgado  <chbm@chbm.nu>

	* charset.c (PreferredMIMENames): add PoS ks_c_5601-1987

2002-05-15  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap.c: add imap_uid_search()
	* configure.in: AM_WITH_NLS redundant (and deprecated in gettext).
	
2002-05-10  Pawel Salek  <pawsa@theochem.kth.se>

	* mutt.h: undefine M_READ because it conflicts with Solaris headers.

2002-04-24  Carlos Morgado  <chbm@chbm.nu>

	* mutt.h: mutt_set_charset() proto

2002-04-04  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: second round of GSS detection fixes from Steve Wall.

2002-03-27  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap.c: unquote folder names if necessary (Thomas Maeder).
	Fixes folder names containing spaces on Cyrus. Not needed with
	UW-IMAP.

2002-03-26  Carlos Morgado  <chbm@chbm.nu>

	* sort.c (mutt_sort_headers): do away with it. it's not like we use it.

2002-03-24  Steve Wall <hitched97@myrealbox.com>

	* configure.in, imap/auth_gss.c: portably(?) handle GSS authentication
	(Steve Wall)

2002-03-11  Carlos Morgado  <chbm@chbm.nu>

	* mx.c (mx_sync_mailbox): ifdef away if(OPTSAVEEMPTY)

2002-03-10  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in, lib.h: add proper NLS support.

2002-03-04  Pawel Salek  <pawsa@theochem.kth.se>

	* Makefile.am: remove curs_lib.c.
	* parse.c: translate translatable strings.
	* pattern.c: do not compile unused functions.
	
2002-02-28  Carlos Morgado  <chbm@chbm.nu>

	* sendlib.c (mutt_write_mime_header): re-enable disposition: 
	now that libbalsa uses it

2002-02-27  Carlos Morgado  <chbm@chbm.nu>

	* imap/command.c (cmd_parse_capabilities): unbreak patch aplied 
	twice on the last libmutt update

2002-02-26  Pawel Salek  <pawsa@theochem.kth.se>

	* Makefile.am: mbyte.h is not in libmutt.

2002-02-17  Carlos Morgado  <chbm@chbm.nu>

	* configure.in: USE_NSS

	* filter.c:
	* mutt_tunnel.c:
	* rfc1524.c:
	* system.c:
	* score.c:
	* thread.c: removed, unused

	* recvattach.c:
	* curs_lib.c:
	* url.c: 
	* url.h: 
	* sort.c: 
	* sort.h: 
	* sendlib.c: 
	* rfc2231.h: added 
	* rfc2231.c: added, MIME
	* rfc2047.c: 
	* rfc2047.h: 
	* protos.h: 
	* pattern.c: 
	* parse.c: 
	* mx.c: 
	* mx.h: 
	* muttlib.c: 	
	* mutt_ssl_nss.c: added. support for mozilla's NSS 
	* mutt_ssl.c: 
	* mutt_ssl.h: 
	* mutt_socket.c: 
	* mutt_sasl.c: 
	* mutt_sasl.h: 
	* mutt_regex.h:
	* mutt_menu.h: 
	* mutt.h: 
	* mh.c: better maildir and mh handling
	* mbox.c: 
	* mailbox.h: added flags field to MESSAGE
	* keymap.h:
	* keymap_defs.h: added
	* init.h: 
	* init.c: 
	* imap/util.c: moved from 900 secs imap connect timeout to 
		ImapKeepalive
	* imap/message.c: 
	* imap/imap.c:
	* imap/imap.h:
	* imap/command.c: 
	* imap/browse.c: 
	* imap/auth_sasl.c: 
	* imap/auth.c: 
	* hash.c:
	* handler.c: 
	* globals.h: 
	* getdomain.c: 
	* functions.h: 
	* flags.c: 
	* copy.c: 
	* copy.h: 
	* complete.c: 
	* charset.c: 
	* buffy.c: better maildir/mh handling
	* attach.h: 
	* attach.c: 
	* ascii.h:
	updated libmutt to mutt-1.3.27, most important changes to balsa
	are noted

2002-02-11  Carlos Morgado  <chbm@chbm.nu>

	* mutt_socket.c (mutt_conn_find): removed _tunnel references
	and preconnect
	* rfc1425.c: removed
	* sort.c: removed sort by score and threading
	* mx.c: removed references to mutt_score
	* Makefile.am: removed filter.c, score.c, mutt_tunnel.c
	* mutt_tunnel.c: removed, we can't use it anyway 
	* score.c: removed
	* pattern.c: mostly ifdefed out
	* filter.c: removed
	* init.c (mutt_extract_token): removed ` functionality
	* handler.c: removed functions non used by libbalsa
	* copy.c (_mutt_copy_message): removed M_CM_DECODE

2002-01-29  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap.c: remove UIDVALIDITY debugging output.

2002-01-08  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* rfc822.c: check if an address consists of all three parts:
	mailbox, '@', and hosts, as specified by rfc-822.

2002-01-08  Carlos Morgado  <chbm@chbm.nu>

	* rfc822.c: applied 'rfc822_terminate' mutt security 
	patch 

2002-01-07  Pawel Salek  <pawsa@theochem.kth.se>

	* Makefile.am: remove commands.c - not used.
	* imap/imap.c: we do not support attachment deletion. yet.
	
2002-01-05  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap.c: read UID-VALIDITY.
	* imap/imap_private.h: add uid_validity to IMAP_DATA
	* imap/message.c: IN-REPLY-TO needed for threading (Peter B.).

2001-12-19  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* rfc822.c: last ditch check.

2001-12-05  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* browser.h: add 'scanned' field.
		
2001-12-03  Pawel Salek  <pawsa@theochem.kth.se>

	Toralf Lund #66032:
	* mutt_ssl.c: print SSL version as a message, not an error 
	* imap/imap.c: print SSL connection server as a message not an error.

2001-11-14  Peter Bloomfield  <PeterBloomfield@MindSpring.com>

	* imap/message.c: reduce number of fetched headers. Parse them
	when available.

2001-11-08  Carlos Morgado  <chbm@chbm.nu>

	* configure.in: build with --with-gss=no

2001-11-07  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: change GSS detection to balsa style. Frankly, I think
	this file should go away: one configure per program is enough.
	Or perhaps not.

2001-10-15  Pawel Salek  <pawsa@theochem.kth.se>

	* mutt_socket.c: reset io methods on close.
	
2001-10-22  Carlos Morgado  <chbm@chbm.nu>

	* imap/imap_private.h: remove sleep define (unused, causing
	problems)

2001-10-16  Carlos Morgado  <chbm@chbm.nu>

	* mutt_ssl.c: patch from Jeremy Katz <katzj@redhat.com> 
	to cycle through all the ssl protos

2001-10-15  Pawel Salek  <pawsa@theochem.kth.se>

	* sendlib.c: robust mime boundary by Peter Bloomfield (#62156).

2001-10-07  Pawel Salek  <pawsa@theochem.kth.se>

	* mx.c: when asked to sync mailbox, just do it, don't ask questions.

2001-09-22  Peter Bloomfield <PeterBloomfield@MindSpring.Com>

	* sendlib.c: make boundary delimiter self-seeding.

2001-09-22  Carlos Morgado  <chbm@chbm.nu>

	* configure.in:  patch from wil <wil@dready.org>
	propagate --with-ssl=path to libmutt
	

2001-09-22  Pawel Salek  <pawsa@theochem.kth.se>

	* sendlib.c: don't include filename for `inline' disposition 
	(see RFC2183).
	
2001-09-13  Carlos Morgado  <chbm@chbm.nu>

	* mh.c (mh_check_mailbox): fix(?) mh/maildir bug where index
	doesn't correspond to displayed messages
	

2001-09-04  Pawel Salek  <pawsa@theochem.kth.se>

	* parse.c: rfc2047 decode dispname field.

2001-08-25  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: detect iconv bug.
	* acconfig.h: DEBUG is broken, undefine whenever possible.
	
2001-08-25  Pawel Salek  <pawsa@theochem.kth.se>

	* configure.in: order stuff to supress warnings.

2001-08-23  Pawel Salek  <pawsa@theochem.kth.se>

	Peter Bloomfield's fix for IMAP mailbox deletion problems.
	
	* imap/browse.c: move imap_mailbox_delete to imap/imap.c...
	* imap/imap.c: ... and use IDATA for mailbox removal.
	* imap/imap.h: remove imap_delete_mailbox() prototype.

2001-08-20  Pawel Salek  <pawsa@theochem.kth.se>

	* browser.h: add state_free() prototype.
	* imap/browse.c: implement it.
	* imap/command.c (cmd_parse_capabilities): free old capstr.
	* buffy.c: cleanup by Peter Bloomfield.
	* imap/imap.c (imap_logout_all): free idata on closing imap socket.
	Check if mailbox should be checked for new mail or not.
	* imap/imap.h: propotype for imap_mailbox_check() with a callback.
	* imap/util.c: initialize capstr field to NULL. Free all fields of
	idata.
	
2001-08-19  Carlos Morgado  <chbm@chbm.nu>

	* imap/imap.c:  
	* mutt_ssl.c: 
	override certificate question to the user and enable all 
	SSL protocols. this will accept unchecked certs and warn 
	the user as errors.  makes tls work, figure out a way of 
	poping up a dialog

2001-08-06  Pawel Salek  <pawsa@theochem.kth.se>

	* buffy.c: use callback to check, if given IMAP mailbox should be
	checked for new mail, or not.
	* libmutt/protos.h: mutt_buffy_check() prototype changed apriopriately.

2001-08-06  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/browse.c: quoted namespaces fix.

2001-08-03  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/command.c: imap_next_word() fix for quoted strings.

2001-07-31  Pawel Salek  <pawsa@theochem.kth.se>

	* muttlib.c: added.
	* Makefile.am: updated with muttlib.c
	* libmutt/protos.h: added some muttlib prototypes.
	* imap/README, imap/TODO: updated (if anybody cares).
	* imap/auth.c, imap/auth_sasl.c: authenticator iterator bug fixed. 
	* imap/command.c: fix rereading capabilities after STARTLS
	* imap/imap.c:misc fixes.
	* imap/imap_private.h: API changed.
	* imap/message.c: support for attachment deletion.
	* imap/util.c: fix imap_next_word().

2001-07-27  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/command.c: fix autologout problem.
	
2001-07-19  Carlos Morgado  <chbm@chbm.nu>

	* acconfig.h (ICONV_NONTRANS): removed whitespace that confused
	autoconf 2.50. sigh.
	

2001-07-18  Carlos Morgado  <chbm@chbm.nu>

	* configure.in (Repository): 
	* acconfig.h (Repository): 
	fix ICONV detecion on newer distros

2001-07-18  Carlos Morgado  <chbm@chbm.nu>

	* mutt_ssl.c:  
	* imap/util.c (Repository): 
	* imap/utf7.c (Repository): 
	* imap/message.c (Repository): 
	* imap/imap_private.h (Repository): 
	* imap/imap.h (Repository): 
	* imap/imap.c (Repository): 
	* imap/command.c (Repository): 
	* imap/browse.c (Repository): 
	* imap/auth_sasl.c (Repository): 
	* imap/auth_login.c (Repository): 
	* imap/auth_gss.c (Repository): 
	* imap/auth_cram.c (Repository): 
	* imap/auth_anon.c (Repository): 
	* imap/auth.h (Repository): 
	* imap/auth.c (Repository): 
	* sendlib.c (Repository): 
	* rfc2047.h (Repository): 
	* rfc2047.c (Repository): 
	* mx.h (Repository): 
	* mutt_socket.h (Repository): 
	* mutt_socket.c (Repository): 
	* mutt_sasl.h (Repository): 
	* mutt.h (Repository): 
	* mime.h (Repository): 
	* mailbox.h (Repository): 
	* init.h (Repository): 
	* handler.c (Repository): 
	* globals.h (Repository): 
	* commands.c (Repository): 
	* charset.h (Repository): 
	* charset.c (Repository): 
	update from mutt-1.3.19, mostly to try to get IMAP TLS to work

	* mutt_sasl.c: added
	* ascii.c:
	* ascii.h: added
	* mutt_sasl.c: added
	* mutt_tunnel.c:
	* mutt_tunnel.h: added. will this work ?
	* Makefile.am: added mutt_tunnel.[ch]
	* sendlib.c: hardly touched ! don't disturb the libesmtp stuff
	* configure.in: removed USE_POP, added use_sockets=1

2001-07-18  Pawel Salek  <pawsa@theochem.kth.se>

	Perl Compatible Regular Expressions by 
	Albrecht Dreß <albrecht.dress@arcormail.de>:
	* acconfig.h: 
	* configure.in: detect PCRE and set HAVE_PCRE.
	* mutt_regex.h: this is only place where it is used.
	
2001-07-16  Pawel Salek  <pawsa@theochem.kth.se>

        IMAP flag handling and new mail notification
	(balsa-imapflags.patch) by M. Thielker <balsa@t-data.com>
	with some changes.

	* imap/message.c (imap_append_message): append message preserving
	the message flags.

	
2001-07-15  Pawel Salek  <pawsa@theochem.kth.se>

	Peter Bloomfield's <bloomfld@eos.ncsu.edu> IMAP mailbox rename
	patch.
	* imap/browse.c: add imap_mailbox_rename().
	* imap/imap.c: add imap_rename_mailbox().
	* imap/imap.h: add prototypes.

2001-07-11  Pawel Salek  <pawsa@theochem.kth.se>

	Peter Bloomfield's <bloomfld@eos.ncsu.edu> patch for
	creation and deletetion of IMAP subfolders.
	* imap/browse.c: imap_mailbox_delete implemented().
	* imap/imap.h: add imap_mailbox_delete().
	* imap/imap_private.h: make imap_delete_mailbox() private.
	
2001-05-26  Pawel Salek  <pawsa@theochem.kth.se>

	* lib.c (mutt_free_envelope): release ENVELOPE::dispnotify_to

2001-05-24  Pawel Salek  <pawsa@theochem.kth.se>

	update files from mutt-unstable-20010516
	* mutt.h:
	* mutt_ssl.[hc]:
	* imap/auth_gss.c: SSL & GSS part

2001-05-23  Pawel Salek  <pawsa@theochem.kth.se>

	update files from mutt-unstable-20010516
	* globals.h: add ImapDelimChars
	* imap/auth_cram.c, imap/auth_anon.c, imap/browse.c:
	* imap/command.c, imap/imap.c, imap/message.c, imap/util.c: 
	use updated imap command structures.
	* imap_private.h: extend IMAP_COMMAND structure.
	* mutt.h: add  OPTUSEIPV6
	* mutt_socket.[hc]: improve SSL support.
	* protos.h: map  ascii_strncasecmp -> g_strncasecmp
	
2001-04-18  Pawel Salek  <pawsa@theochem.kth.se>

	* mutt.h: make CONTEXT struct non-anonymous.
	
2001-03-29  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/command.c: change tiomout message to more apriopriate.
	* mutt_socket.c: remove broken connections from the connection list.

2001-03-22  Pawel Salek  <pawsa@theochem.kth.se>

	* parse.c: Patch from Albrecht Dreß <albrecht.dress@arcormail.de> 
	- support Disposition-notification-to: header.

2001-02-24  Carlos Morgado  <chbm@chbm.nu>

	* imap/imap.c: mutt -> balsa in message

2001-02-16  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/command.c, imap/imap.c: armour the code against fata errors.
	The patch sent to the mutt maintainer.
	* imap/imap_private.h: redefine sleep.
	
2001-02-16  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/command.c: handle properly fatal IMAP connection errors.

2001-02-13  Carlos Morgado  <chbm@chbm.nu>

	* imap/auth.c: (imap_authenticate) bugfix iterating authenticators 

2001-02-13  Pawel Salek  <pawsa@theochem.kth.se>

	* Makefile.am: fix SSL build.
	* lib.c: fix some misuderstandings.
	* mutt.h: include forgotten lib.h
	* rfc1525.c: modify partially to accomodate API from imported mutt.
	
2001-02-11  Pawel Salek  <pawsa@theochem.kth.se>

	* mx.c, sendlib.c: fixed mistakes in importing.
	
2001-02-11  Pawel Salek  <pawsa@theochem.kth.se>

	Sync with mutt-unstable-20010210.

	* Makefile.am:
	* acconfig.h: add USE_SASL
	* account.[hc]: added
	* base64.c:
	* charset.[hc]:
	* configure.in: add USE_SASL configuration
	* copy.c:
	* globals.h:
	* handler.c:
	* lib.[hc]:
	* mutt.h:
	* mutt_regex.h:
	* mutt_sasl.h:
	* mutt_socket.[hc]:
	* mutt_ssl.[ch]:
	* mx.c:
	* parse.c:
	* protos.h:
	* rfc2047.[hc]:
	* sendlib.c:
	* url.[hc]:
	* imap/Makefile.am:
	* imap/auth.[hc]:
	* imap/auth_anon.c:
	* imap/auth_cram.c:
	* imap/auth_gss.c:
	* imap/auth_login.c:
	* imap/auth_sasl.c:
	* imap/browse.c:
	* imap/command.c:
	* imap/imap.[hc]:
	* imap/imap_private.h:
	* imap/md5.h:
	* imap/message.[hc]:
	* imap/utf7.c:
	* imap/util.c:
	* mutt_regex.h, browse.c: renamed Mask to FileMask.
	
2001-02-03  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap.c: handle mailbox selection errors; it fixes broken
	connection caching.
	* imap/imap_socket.h: add mutt_socket_close_all_connections() to 
	quit cleanly.
	* libmutt/imap/socket.c: implement it.

2001-01-19  Pawel Salek  <pawsa@theochem.kth.se>

	* libmutt/mutt.h: add dispnotify_to field.
	* libmutt/sendlib.c: handle dispnotify_to field.

2001-01-18  Pawel Salek  <pawsa@theochem.kth.se>

	* rfc822.c: Berend De Schouwer <bds@jhb.ucs.co.za> patch that
	fixes quoting. Feel free to tak it back when mutt's code does it
	right.
	
2001-01-08  Pawel Salek  <pawsa@theochem.kth.se>

	* browser.h: added from mutt-1.2.5i
	* imap/Makefile.am: adding imap-browse.c to the file list
	* imap/browse.c: added file.
	* imap/imap.h: include browser.h and imap_init_browse() prototype.
	
2000-12-20  Ian Campbell  <ijc25@cam.ac.uk>

	* mh.c (maildir_parse_message): Parse headers with user_hdrs=1, so
	we get all headers

2000-11-29  Carlos Morgado  <chbm@chbm.nu>

	* rfc1524.c: (mutt_adv_mktemp) use mkstemp like the doctor ordered

2000-11-24  Pawel Salek  <pawsa@theochem.kth.se>

	Atsuhiko Yamanaka's <ymnk@jcraft.com> patch for multithreaded msg view.
	* libmutt/parse.c: forcing relevant user headers...
	
2000-11-12  Pawel Salek  <pawsa@theochem.kth.se>

	* imap/imap_auth.c: fix CRAM authorization bug: the code assumed 
	that the AUTHORIZATION command cannot get untagged response.
	* imap/imap_ssl.c: make it compile (user certification selection 
	hs beed disabled).

2000-09-24  Pawel Salek  <pawsa@theochem.kth.se>

	* pop.c: use LAST if UIDL fails (patch contributed by 
	James A . Laska <james_laska@yahoo.com>).
	
2000-09-06  Ian Campbell  <ijc25@cam.ac.uk>

	* pop.c, protos.h: Added a porgress callback to
	mutt_fetchPopMail. Use it in preference to the msgmail stuff.
	* Makefile.am: Remove thread_msgs.h
	
2000-08-29  Pawel Salek  <pawsa@theochem.kth.se>

        Imported IMAP support from mutt-1.2.5. Compiles but is not plugged in.
	* imap/*: added.
	* Makefile.am,acconfig.h,configure.in: support for imap
	configuration.
	* globals.h,mutt.h,protos.h: header files modified in order to
	compile new IMAP support.
	* imap.c: this file will be removed, but some variables wer to be 
	renamed for compilation.
	* buffy.c: ImapCheckTime -> ImapCheckTimeout
	* lib.c: mutt_stristr() func imported.
	
2000-08-10  Ian Campbell  <ijc25@cam.ac.uk>

	* pop.c: Add BALSA comment to bugfix.
	
2000-08-10  Ian Campbell  <ijc25@cam.ac.uk>

	* mbox.c(mbox_parse_mailbox): pass user_hdrs=1 to
	mutt_read_rfc822_header because we want them to be in the list.

2000-06-30  Pawel Salek  <pawsa@theochem.kth.se>

	mailbox sync code synchronized with mutt-1.2.2.
	* mx.[hc], mbox.c: completely synchronized files.
	* dotlock.[hc], libmutt/imap.[hc],mh.c,mutt.h,parse.[ch],
	pop.c,protos.h,score.c,sendlib.c,sort.c: API update.

2000-03-05  Morten Welinder  <terra@diku.dk>

	* mutt.h (M_READ): Workaround for Solaris.  (Bug is in Balsa,
 	though.)

1999-12-29  Bruno Pires Marinho  <bapm@camoes.rnl.ist.utl.pt>

	* mbox.c: Made user headers work, needed for fcc.

1999-01-12  bertrand  <Bertrand.Guiheneuf@inria.fr>

	* configure.in 
	in AC_PATH_PROG(SENDMAIL, sendmail ..
	don't replace ':' by ' '.

1999-01-08  bertrand  <Bertrand.Guiheneuf@inria.fr>

	* mx.c (mutt_is_spool): removed my previous changes about 
	trash and outbox mailboxes ... 
	(mx_close_mailbox): ... but I disabled the possibility 
	to automatically delete empty mailboxes when closing them.

1998-11-25  Herbert Valerio Riedel  <hvr@hvrlab.ml.org>

	* socket.c: added #include <string.h>

Fri Sep  4 15:53:27 1998  Thomas Roessler  <roessler@guug.de>

	* sendlib.c: Catch MIME parameters with p->value
	== NULL.

	* sendlib.c: Fixing a memory leak in
	mutt_prepare_envelope().

Tue Sep  1 06:54:53 1998  Thomas Roessler  <roessler@guug.de>

	* imap.c: IMAP fixes from Nathan Neulinger.
	(<19980831170941.A7327@umr.edu> on mutt-dev.)

Mon Aug 31 16:46:29 1998  Thomas Roessler  <roessler@guug.de>

	* send.c: Fix a small problem with Liviu's
	attach_fcc patch.

	* compose.c: Updating to
	patch-0.94.4.vikas.attach_message.3.

	* thread.c, protos.h, mutt.h, init.h, hdrline.c,
	curs_main.c: Updating to
	patch-0.94.4.vikas.collapse.3.

Sat Aug 29 08:27:02 1998  Thomas Roessler  <roessler@guug.de>

	* doc/manual.txt, doc/manual.sgml: Correct an
	editor key binding example.

Fri Aug 28 19:09:24 1998  Thomas Roessler  <roessler@guug.de>

	* send.c, pgp.h, pgp.c: Cleaning up the fcc_attach
	hack.  From Liviu.

	* functions.h, browser.c, OPS:
	[patch-0.94.4i.tlr.display_filename.1] Introduce a
	new function "display-filename" which displays the
	currently selected file's name on the message
	line.

	* attach.c: [patch-0.94.4i.tlr.get_attachment.1-2]
	Get the attachment time stamping business right.

	* protos.h, functions.h, compose.c, attach.c, OPS:
	[patch-0.94.4i.tlr.get_attachment.1] Create a new
	"get-attachment" function on the compose menu
	which will copy an attachment to a temporary file.

	* compose.c: [patch-0.94.4.vikas.attach_message.1]
	Cleaning up some of the attach-message code.

	* thread.c: removing superfluous include
	statements.

Thu Aug 27 23:51:58 1998  Thomas Roessler  <roessler@guug.de>

	* curs_main.c: code cosmetics.

	* thread.c, sort.c, protos.h, pattern.c, mx.c,
	mutt.h, mbox.c, init.h, hdrline.c, functions.h,
	curs_main.c, OPS: [patch-0.94.4.vikas.collapse.2]
	Vikas' collapse-thread patch.

	* recvattach.c, postpone.c, mutt.h, lib.c,
	curs_main.c, browser.c, addrbook.c:
	[patch-0.94.4i.gt.arrowcursor.1] Padding to the
	end of line/right jusitifying does not work in
	menus when $arrow_cursor is set, because the extra
	space needed for the arrow is not taken into
	account. (From Gero Treuner
	<gero@faveve.uni-stuttgart.de>)

	* Attic/testmsg, rfc1524.c:
	[patch-0.94.4i.tlr.shell_quote.1-2] Fix a
	brain-dead segmentation fault when freeing
	non-allocated memory.

	* doc/Attic/mutt.sgml: Mh. This seems to have
	shown up again while cleaning up the CVS branches.

	* sendlib.c, send.c, protos.h, pgp.h, pgp.c: Make
	$fcc_attach work correctly when sending
	PGP-encrypted messages.  Hack by Liviu.

	* doc/manual.txt, doc/manual.sgml: Document
	attach_format. (From: Gero Treuner
	<gero@faveve.uni-stuttgart.de>)

	* rfc1524.c, protos.h, pgpinvoke.c, mx.c, lib.c,
	curs_lib.c: [patch-0.94.4i.tlr.shell_quote.1] Try
	to quote file name arguments and the like for
	shell commands.

	* pgpkey.c: Minor nit: if you enter the wrong key
	ID at Mutt's prompt, Mutt should erase the old
	value --- otherwise people might think it has just
	hung there. (From Liviu Daia.)

Wed Aug 26 21:12:23 1998  Thomas Roessler  <roessler@guug.de>

	* rfc822.c: Another possible memory leak in
	rfc822_parse_adrlist.  The problem and the patch
	are pretty much the same as with the last fix
	applied to this file - it's just ',' instaed of
	';' this time.

	* rfc822.c, TODO:
	[patch-0.94.4i.tlr.rfc822_leak.1] Fixing a memory leak in
	the rfc822_parse_adrlist().

	Some explanations seem to be in order here.  Let's look at
	the code:

	   386	    else if (*s == ';')
	   387	    {
	   388	      if (phraselen)
	   389	      {
	   390		phrase[phraselen] = 0;
	   391		add_addrspec (&top, &last, phrase, comment, &commentlen, sizeof (comment) - 1);
	   392	      }
	   393	      else if (commentlen && !last->personal)
	   394	      {
	   395		comment[commentlen] = 0;
	   396		last->personal = safe_strdup (comment);
	   397	      }
	   398	#ifdef EXACT_ADDRESS
	   399	      if (last && !last->val)

	Line 399 contains the change; previously, it looked like
	this:

	   399'       if (last)

	   400		last->val = mutt_substrdup (begin, s);
	   401	#endif
	   402
	   403	      /* add group terminator */
	   404	      cur = rfc822_new_address ();
	   405	      if (last)
	   406	      {
	   407		last->next = cur;
	   408		last = cur;
	   409	      }
	   410
	   411	      phraselen = 0;
	   412	      commentlen = 0;
	   413	      s++;
	   414	      begin = s;
	   415	      SKIPWS (begin);
	   416	    }

	OK, what happens? There are essentially two situations here:

	-> We have already parsed a complete address specification
	   and know about this fact, but there was no new address
	   information.  This is the case if we are parsing
	   through addresses like

		undisclosed-recipients:;

	   or

		recipients: a, b, c,;

	   (Note the extra ',' before the ';'!)

	   In this case, some of the other code in rfc822.c has
	   already filled in last->val, and we really shouldn't
	   overwrite that with a NULL pointer.

	-> The ';' finishes an address spec, like in

		recipients: a;

	   In this case, last is either set by add_addrspec(), or
	   it has already been set by some of the previous code
	   (comment handling, ...).  Anyway, last->val is still
	   NULL, so it is correct to write the complete addr spec
	   to last->val.

	* imap.c: Error message cosmetics.

Tue Aug 25 22:34:58 1998  Thomas Roessler  <roessler@guug.de>

	* rfc1524.c, attach.c, TODO:
	[patch-0.94.4i.tlr.nametemplate.1] Fix
	nametemplate support: We should not move the
	user's files around just to make them match
	mailcap's idea of their file name. This patch uses
	symbolic links instead.

	* curs_main.c: [patch-0.94.4i.tlr.synch_fault.1]
	Start up two mutts. Delete the last message in
	both of them.  Synchronize the mailbox in both of
	them. Segmentation fault.

	* TODO: adding a few notes.

	* commands.c: If you issue "decode-save" on an
	encrypted message without reading it first, Mutt
	won't prompt you for a passphrase, and it will
	happily write an empty message, deleting the
	original.  (From an unnamed colleague of Liviu
	Daia.)

	* imap.c: [patch-0.94.4i.tlr.imap_newline.2] Use
	cr nl instead of single nl when uploading a
	message to an imap server.

	* sendlib.c, protos.h, postpone.c, compose.c:
	[patch-0.94.4i.tlr.encoding.1] Fix
	content-transfer-encoding updates when renaming
	files from the compose menu and when recalling
	postponed messages.

	* imap.c: s/free/FREE/

Mon Aug 24 19:40:35 1998  Thomas Roessler  <roessler@guug.de>

	* TODO, Attic/BUGS: Compile BUGS and TODO into a
	comprehensive issue list.

	* Attic/BUGS: Clean up the bug list.

	* reldate.h, configure.in, configure, ChangeLog:
	0.94.4i.

	* doc/manual.txt, doc/manual.sgml: Documenting
	$hidden_host.

	* thread.c, curs_main.c: Fix "previous-subthread"
	in reverse-threads mode, allow next-(sub)thread
	and previous-(sub)thread to work in limited mode.
	(From: Liviu Daia)

	* doc/manual.txt, doc/manual.sgml: Documenting $hidden_host.

	* thread.c, curs_main.c: Fix "previous-subthread"
	in reverse-threads mode, allow next-(sub)thread
	and previous-(sub)thread to work in limited mode.
	(From: Liviu Daia)

Sun Aug 23 10:05:41 1998  Thomas Roessler  <roessler@guug.de>

	* sendlib.c, send.c, protos.h, mutt.h, main.c,
	init.h, init.c, configure.in, configure,
	config.h.in, alias.c, acconfig.h, INSTALL:
	[patch-0.94.3i.tlr.hidden_host.1] Replace the
	--enable-hidden-host configure switch by a
	configuration variable $hidden_host which can be
	changed at run-time. This variable will _not_
	affect the generation of message-IDs since we'll
	get into uniqueness problems if we just use the
	domain here.

	Needs to be documented.

	* doc/manual.txt: Committing the latest manual
	changes.

	* Attic/socket.c, imap.c:
	[patch-0.94.3.bl.imap_buffy.1-2] Fixing the
	buffered read stuff.

	* Attic/mutt_socket.h: Ups, this one was missing
	from Brandon's IMAP patch.

Sat Aug 22 14:24:18 1998  Thomas Roessler  <roessler@guug.de>

	* help.c: [patch-0.94.3i.gt.beautify_help.1.gz]
	General help beautification.  From Gero Treuner.

	* doc/manual.sgml, keymap.h, keymap.c, help.c,
	Muttrc.in: [patch-0.94.3i.gt.description.1]
	Introduce macro descriptions.

	* doc/manual.sgml, init.h, init.c, browser.c: Add
	a negation operator "!" to $mask's syntax (as in
	the *-hooks).  From Liviu.

	* recvattach.c: Make Vikas' attach_split and
	Brandon's other_type patches fit together.

	* recvattach.c, mutt.h, init.h, globals.h,
	compose.c: [patch-0.94.3.vikas.attach_split.3]
	Re-introduce attach_split.

	* Attic/socket.c: [patch-0.94.3.bl.imap_buffy.1]
	Adding Brandon's IMAP buffy support.

	* mx.c, mutt.h, mailbox.h, imap.h, imap.c,
	curs_lib.c, configure.in, configure, buffy.c,
	browser.c, Attic/BUGS:
	[patch-0.94.3.bl.imap_buffy.1] Adding Brandon's
	IMAP buffy support.

Fri Aug 21 08:17:09 1998  Thomas Roessler  <roessler@guug.de>

	* browser.c: Enter the file browser, type a mask
	which doesn't match any file in the current
	directory, clean the mask. Segfault.  Fix from
	Liviu Daia.

Thu Aug 20 22:32:46 1998  Thomas Roessler  <roessler@guug.de>

	* sendlib.c, recvattach.c, parse.c, mutt.h,
	mime.h, lib.c, handler.c, globals.h, compose.c,
	commands.c, attach.c, Attic/BUGS:
	[patch-0.94.3.bl.other_types.1] This patch adds
	support for the model MIME type.  Additionally,
	along the lines of "strict in what you generate,
	accepting in what you receive", this patch will
	keep the name of major mime types it doesn't
	recognize (instead of using x-unknown).

	* compose.c, Attic/BUGS:
	[patch-0.94.3i.jmy.attachmessage-fix.1] This patch
	fixes a bug in the allocation of space for new
	pointers to the attachments, it would make mutt
	seg-fault when attaching 5 or more messages at the
	same time. (From: Jimmy Mäkelä
	<jmy@flashback.net>)

	* handler.c: [SECURITY] mutt_sanitize_filename()
	should be called when creating temporary files for
	autoview.  (From: Liviu Daia.)

	* sendlib.c, send.c, attach.c: Try this: set
	$mime_forward, forward a PGP-encrypted message,
	then in the "compose" menu try to view the
	forwarded message. If you didn't enter a
	passphrase before, Mutt won't ask for it either.
	(From: Liviu Daia)

	* sendlib.c, attach.c: When you forward a message
	with $mime_forward set, or when you attach a
	message with the "attach-message" command from the
	"compose" menu, there is a memory leak.  The real
	reason for this leak is that multipart attachments
	are not supported in the "compose" menu, so you
	need to go through quite a few contortions in
	order to handle message/rfc822 attachments.
	Consequently, the patch below is just an ugly
	hack.  (From: Liviu Daia)

Sun Aug 16 06:22:51 1998  Thomas Roessler  <roessler@guug.de>

	* rfc822.c: Bringing 128-byte strings to "STRING".

	* sendlib.c: Use add_option, not add_arg, for
	strings such as "--".

	* sendlib.c: Pass an "--" argument to sendmail
	before the address arguments, so addresses with a
	leading dash don't lead to problems. (From Liviu.)

	* sendlib.c, rfc822.c, rfc1524.c, parse.c, mx.c,
	main.c, lib.c, keymap.c, hash.c, handler.c,
	edit.c, curs_lib.c, alias.c: Replacing a bunch of
	free() and malloc() calls by safe_free() and
	safe_malloc().  (From Liviu.)

Sat Aug 15 18:27:45 1998  Thomas Roessler  <roessler@guug.de>

	* imap.c: read() can't read buffers larger than
	SSIZE_MAX.

	* hook.c: [patch-0.94.3i.tlr.empty_hook.1] Ignore
	empty hooks instead of segfaulting.

	* protos.h, init.c, Attic/history.h:
	[patch-0.94.3i.tlr.history.1] Adding history class
	support.

	* Attic/history.c: [patch-0.94.3i.tlr.history.1]
	Adding history class support.

	* enter.c, TODO, Makefile.in:
	[patch-0.94.3i.tlr.history.1] Adding history class
	support.

	* sendlib.c:
	[patch-0.94.3i.tlr.attach_msg_fmt.1-2] When
	generating a message/rfc822 type attachment, parse
	its header so that the attachment format routines
	can properly display the default description.

	* init.h: Change attach_format's default to limit
	the attachment description's length.

Thu Aug 13 22:09:16 1998  Thomas Roessler  <roessler@guug.de>

	* pgppubring.c: Fixing another memory leak in the
	pubring parser.

	* recvattach.c, Attic/BUGS:
	[patch-0.94.3i.tlr.attach_msg_fmt.1] When parsing
	the "%d" format option in the attachment format,
	use the message format as a fall-back if no
	explicit description is provided.  This fixes the
	following bug:

	  set mime_forward. Forward any mesage. The
	  compose menu will show the description as
	  "Forwarded message from ...." which is fine.
	  Pressing 'd' to edit the description brings up
	  the above string for editing.

	  Now hit Enter on the message/rfc822 attachment
	  to view it. Quit out of the pager.

	  The description field has now changed to the
	  Subject: of the forwarded message. Pressing 'd'
	  still brings up the 'Forwarded message from....'
	  string.

	(Noted by Vikas.)

	* doc/manual.txt, doc/manual.sgml, sendlib.c,
	mutt.h, init.h: [patch-0.94.3i.tlr.write_bcc.1]
	This patch adds an option $write_bcc which
	controls whether the Bcc header is written out or
	not.  This can be used to work around broken MTA's
	(Exim seems to leave Bcc headers in).

	The problem was noted independently by Peter
	Radcliffe <pir@pir.net> and by Dave Holland
	<dave@zenda.demon.co.uk> (Debian Bug #25687).

	* pgppubring.c: [patch-0.94.3i.tlr.pubring_leak.1]
	Fixing a memory leak. Bug noted by Liviu Daia.

	* reldate.h: 0.94.3i.

	* configure.in, configure, ChangeLog: Preparing
	0.94.3i.

	* compose.c: indentation cosmetics.

	* compose.c: Update menu->data when OP_COMPOSE_EDIT_HDRS is called.
	From Vikas.

	* compose.c: Update the encoding after using ispell from the compose
	menu.  From Vikas.

	* sendlib.c, send.c, protos.h, pgppubring.c,
	pattern.c, lib.c, curs_main.c, compose.c,
	attach.c: Various nits from Liviu; encoding fixes.

	* rfc822.c: Fixing a buffer overflow in rfc822_cat().  tmplen could
	underflow.

Wed Aug 12 11:50:59 1998  Thomas Roessler  <roessler@guug.de>

	* init.c: Yet another memory leak fix from Liviu.

	* rfc2047.c: Fixing a stupid buffer overflow plus some flawed logic.

	* functions.h, compose.c, OPS:
	Adding an update-encoding function to the compose menu.
	This is useful if the user has externally modified an
	attachment and _wants_ to adjust the encoding afterwards.
	Also, this patch fixes some redraw-related problems in the
	compose menu.

	* sendlib.c, mutt.h, compose.c, Attic/BUGS:
	When changing or deleting attachments, the compose menu
	now notices this and complains or asks accordingly.
	Partially from Vikas.

Tue Aug 11 08:14:38 1998  Thomas Roessler  <roessler@guug.de>

	* Attic/BUGS: Yet another outstanding bug.

	* doc/manual.txt: This now contains the latest changes to manual.sgml.

	* sendlib.c, rfc2047.c, rfc1524.c, pgppubring.c, pager.c, hdrline.c:
	Fixing various nits noted by Liviu and his colleagues.

Mon Aug 10 15:30:02 1998  Thomas Roessler  <roessler@guug.de>

	* sendlib.c: This patches makes the message-id persistant when
	postponing messages.  (From: Janos Farkas)

	* doc/manual.sgml, sample.muttrc, lib.c, init.h:
	This patch introduces "unhdr_order" to reset the hdr_order
	command's effect.  (From: Janos Farkas)

	* color.c: Drop the free_rx parameter from muitt_free_color_line(),
	as it's always 1.

	* color.c: Adding mutt_free_color_line() and replacing varous
	"manual" free()s of color lines by calls to this function.

	* bind.c: Removing bind.c.  Pointed out by Gero Treuner
	<gero@faveve.uni-stuttgart.de>.

Sun Aug  9 18:43:45 1998  Thomas Roessler  <roessler@guug.de>

	* color.c: With SLang, init_pair is (void), so we must not check its
	return value.

	* color.c: Restructuring color.c.  This patch fixes the "default"
	problem from 0.94.2i and makes the code more
	comprehensible than that version and more consie than
	0.94.1i.

Sat Aug  8 21:40:12 1998  Thomas Roessler  <roessler@guug.de>

	* rfc2047.c: Fixing the "=?" detection in rfc2047_encode_string().  Bug
	noted by David Jeske <jeske@home.chat.net>.

	* compose.c: If you press t to add a recipient in the compose menu,
	then press tab, q, and aborts with ctrl-g, mutt won't
	redraw the menu.  Noted by Jimmy Mäkelä
	<jmy@flashback.net>.

	* alias.c: Entering an un-parsable address when creating an alias
	would make mutt segfault.  Noted by brian moore
	<bem@cmc.net>.

	* browser.c: If you press tab in the file-browser to see the inboxes
	and the current row is greater than the inbox-screens
	max-rows then the screen gets garbled.
	(From: Jimmy Mäkelä <jmy@flashback.net>)

	* doc/manual.txt, doc/manual.sgml: I made the manual more up to date:

	* new version
	* new mailing list and home page addresses
	* made the terminology a bit more consistent regarding
	  'pattern' and 'regular expression'
	* added a note about expanding UNIX environments
	* added a note about <, >, in range patterns like ~m
	* added a note about the urlview program
	* changed tables to not use tabs, because it doesn't work
	  right in my favourite web browsers lynx and netscape

	(From: Gero Treuner <gero@faveve.uni-stuttgart.de>)

	* pattern.c: This patch makes pattern ranges more logical. Before '~m
	<5' would show message 1-5, with this patch it shows 1-4.
	Inclusive ranges is still avaible if you use '~m -5'.
	(From: Jimmy Mäkelä <jmy@flashback.net>)

	* init.c: Various improvements to the mutt_command_complete
	function.  From Stephen Hack <shack@rsn.hp.com>.

	* browser.c: If you specify 'mailboxes ""' mutt will seg-fault. (From:
	Jimmy Mäkelä <jmy@flashback.net>)

	* color.c: Fixing a memory leak.  Thanks, Liviu.

	* commands.c: When printing a message, headers are now sorted according
	to hdr_order.  From Liviu.

	* browser.c: Fixing an off-by-one buffer overflow in browser.c.  Noted
	by Liviu.

	* lib.c, attach.c: This patch adds some more "safe" characters to
	mutt_sanitize_filename and fixes its usage in
	mutt_view_attachment().  (From: Liviu Daia
	<daia@stoilow.imar.ro>)

	* status.c, sort.h, sendlib.c, send.c, query.c, protos.h, postpone.c, pager.h, pager.c, mutt_menu.h, menu.c, main.c, init.c, headers.c, functions.h, curs_main.c, curs_lib.c, compose.c, commands.c, browser.c, addrbook.c, OPS:
	Adding the attach message patch.  From Vikas Agnihotri
	<VikasA@att.com>.

	* Makefile.in: There is no "compile" rule for dotlock in the Makefile.
	(From: Dan Nelson <dnelson@emsphone.com>)

	* imap.c: Thispatch to imap.c allows the user to specify a port
	number in the folder name in the general form
	{hostname:portnum}foldername. (From: Andy Sloane
	<andude@guildsoftware.com>)

	* imap.c: imap_close_connection() was being called even though the
	client was using mulitple mailboxes over the same
	connection.  (From: Brandon Long <blong@fiction.net>)


Fri Jul 31 08:17:50 1998  Thomas Roessler  <roessler@guug.de>

	* rfc1524.c: Changing an sprintf to an snprintf (which it was meant to
	be.)

	* protos.h: mutt_sanitize_filename takes char *, not const char *.

	* protos.h, lib.c, attach.c:
	Introducing mutt_sanitize_filename().  The code is similar
	to patch-0.91.1i.tlr.rfc1524_sanitize.1 and to Peter
	Holzer's patch against 0.91.

	* rfc1524.h, rfc1524.c, postpone.c, attach.c:
	Avoid possible buffer overflows in mutt_adv_mktemp().

	* sendlib.c: Interpret sysexits-style exit values from sendmail.

	* configure.in, configure, config.h.in, acconfig.h:
	Check for sysexits.h.

Thu Jul 30 09:30:38 1998  Thomas Roessler  <roessler@guug.de>

	* edit.c: When reading in files, be_snarf_file() wouldn't recognize
	'~' as the user's home directory.

Wed Jul 29 10:54:09 1998  Thomas Roessler  <roessler@guug.de>

	* README, Changes: Finalizing 0.93.2i.

	* configure.in, configure: Bumping to 0.93.2(i).

	* parse.c: Fixing a buffer overflow in parse.c which presented a
	serious security thread.  Noted by Paul Boehm
	<paul@boehm.org>.

Tue Jul 28 08:21:49 1998  Thomas Roessler  <roessler@guug.de>

	* Attic/patch.slang-1.2.2.keypad.1: Adding a patch for a SLang bug.

	* INSTALL: Adding a patch for a SLang bug.

	* mx.c: Doing 'mutt -f NoSuchFile' just flickers the screen and
	silently exits. Earlier (0.92.14 at least), it used to
	spit out the error 'NoSuchFile: no such file or directory
	(errno = 2)'.  (Noted and tracked down by Vikas Agnihotri
	<VikasA@att.com>)

	* color.c: The index cache should be updated even without color
	support.

Mon Jul 27 13:39:39 1998  Thomas Roessler  <roessler@guug.de>

	* Attic/BUGS: Adding a notice about some more nits.

	* main.c: Change the error reporting mail address from
	<mutt-dev@cs.hmc.edu> to <mutt-dev@mutt.org>.

	* protos.h, init.h, color.c:
	This patch fixes index "color" patterns when using a
	non-color capable curses library.  While working on color
	support, I've thrown together the mutt_parse_color() and
	mutt_parse_mono() functions as they are sharing most of
	their code.  Additionally, a new directive called "unmono"
	is introduced.  The implementation consists in adding a
	flag and very few lines of code (plus ifdefs) to
	mutt_parse_uncolor().

	* snprintf.c, rfc1524.h, rfc1524.c, date.c:
	Fixing some minor nits: missing #includes in date.c and
	snprintf.c, and a not-so-nice declaration of
	rfc1524_new_entry().  Noted by Digital cc and gcc.

Fri Jul 24 08:12:46 1998  Thomas Roessler  <roessler@guug.de>

	* copy.c, attach.c:
	Fiddling around with message/rfc822 attachments once again.

Thu Jul 23 20:57:50 1998  Thomas Roessler  <roessler@guug.de>

	* status.c, sendlib.c, send.c, rfc2047.c, pop.c, pager.c, mx.c, mh.c, mbox.c, lib.c, init.c, imap.c, edit.c, curs_lib.c, compose.c, commands.c, color.c, browser.c, attach.c, alias.c:
	Guard lots of global (char *) variable deferences against
	NULL pointers.

	* copy.c, attach.c:
	Yet another patch about saving message/rfc822 attachments.

	* main.c, send.c: Fixing potential NULL pointer deferences.

Wed Jul 22 22:47:57 1998  Thomas Roessler  <roessler@guug.de>

	* recvattach.c: Another fix from Liviu.

	* recvattach.c, from.c, attach.c:
	Another patch from liviu to fix the message/rfc822
	behaviour.

	* recvattach.c, mx.c, attach.c:
	This patch fixes the saving of message/rfc822 attachments
	to mail folders.  Additionally, it fixes an outstanding
	bug with From_ lines being written to MH folders.

	(From: Liviu Daia <daia@stoilow.imar.ro>)

	* menu.c, functions.h, browser.c, OPS:
	1. When I hit 'c' (change dir) in browser, it gives me the
	   directory, but without the final '/', so I have to add
	   '/' to add a subdirectory name. This patch fixes it.

	2. check-new now will recheck mailbox folders for new
	   mail.

	3. added a function toggle-mailboxes which toggles in
	   browser between mailboxes view and directory view.
	   (bound to TAB by default).

	(From: "Michael S. Tsirkin" <mtsirkin@iil.intel.com>)

	* send.c: Correct an error message in send.c.
	(From: Byrial Jensen <byrial@post3.tele.dk>)

	* sendlib.c, recvattach.c, protos.h, postpone.c,
	pager.c, mx.c, mutt.h, lib.c, keymap.c, handler.c,
	compose.c, commands.c, attach.h, attach.c:

	These changes fix some of the bugs which were
	recently reported to mutt-dev.  To be more specific,
	message-type attachments are saved to mail folders
	from the receive attachment menu, some of the
	sending code has been made more robust against
	disappearing attachments, and "tag" is rebound to
	"T" on the compose menu.

	(Some part of this patch comes from Vikas Agnihotri
	<VikasA@att.com>.)

	* send.c: Avoid a potential segmentation fault when
	trying to postpone, but Postponed equals NULL.

	* Attic/BUGS: This file is intended to contain known
	bugs which still have to be fixed.

	* doc/manual.txt:
	Committing the changes previously made to manual.sgml.

	* imap.c: Include Message-ID and Reply-To headers
	when fetching a message's headers from an IMAP
	server. (From: Andy Sloane <andude@incarnate.net>)

Tue Jul 21 07:54:03 1998  Thomas Roessler  <roessler@guug.de>

	* recvattach.c:
	The old behaviour of the %d (for description) specifier is
	recreated by this patch.
	(From: Byrial Jensen <byrial@post3.tele.dk>)

	* protos.h, lib.c, attach.c:
	You should never _ever_ do something like this:

	       [process A]  ---[piped write until EOF]---> [process B]
	       [process A]  <---[piped read until EOF]--- [process B]

	Basically, what happens is something like this: A
	feeds data to B; B processes the data, and feeds it
	to the pipe until the pipe buffer is full; at this
	point, A writes to its pipe until its buffer is full
	too, and if it still has more data to write, that's
	it, it never gets to the read part to flush B's
	buffer --- both processes are blocked on write.

	This patch fixes such a situation in the compose menu.

	(From: Liviu Daia <daia@stoilow.imar.ro>)

Mon Jul 20 21:01:05 1998  Thomas Roessler  <roessler@guug.de>

	* reap.pl: Perl lies in /usr/bin on my machines.

	* pop.c: It seems that if you don't enter any
	password at all when prompted for the POP password,
	Mutt will die with a segmentation fault also. (Bug
	reported by Steve Mayer <smayer@rtd.com> via the
	Debian bug tracking system, fix from Thomas
	Roessler.)

	* postpone.c: When you send a message which have
	been postponed before sending, then all its
	attachments (if there are more than one) will have a
	content-disposition header which includes a
	filename, even if there isn't a real filename but
	only random choosen temporary one. (From: Byrial
	Jensen <byrial@post3.tele.dk>)

Sat Jul 18 09:18:31 1998  Thomas Roessler  <roessler@guug.de>

	* recvattach.c: "Set mime_forward, and forward a
	message --- Mutt will segfault." The obvious fix for
	this is to check for aptr->content->hdr in
	mutt_attach_fmt() before invoking
	_mutt_make_string().  Anyway, I suspect that the
	real fix may involve something like parsing the
	rfc822 attachment in question.

	* sendlib.c: Postponing messages behaves funny when the $postponed
	folder is in Maildir format; I traced this down to the
	fact that postponed messages are saved in "cur" while
	mutt_num_postponed() is looking at "new".
	(From: Liviu Daia <daia@stoilow.imar.ro>)

Fri Jul 17 08:37:02 1998  Thomas Roessler  <roessler@guug.de>

	* compose.c: Removing the old snd_entry() code.

	* doc/manual.sgml, protos.h, pgp.c, mutt.h, init.h, hook.c:
	When sending encrypted messages, it may arrive that Mutt
	can't determine the PGP key of the recipient (presumably
	because her address has changed, but she hasn't updated
	her PGP key yet). In this situation it's convenient to be
	able to associate a keyID with an address automatically.
	The attached patch is an attempt to implement this idea
	using a "pgp-hook". (From: Liviu Daia <daia@stoilow.imar.ro>).

	* recvattach.c: Removing the old attach_entry() code.

	* recvattach.c, protos.h, mutt.h, init.h, globals.h, compose.c:
	This patch adds a string variable $attach_format which
	controls the look of the compose and attach menus.
	Unfortunately, I was not able to make things so that it
	would look exactly the same as the hardcoded versions, so
	the default format is a bit different, but I think it is
	quite usable.  (From Michael Elkins <me@cs.hmc.edu>).

	* functions.h, browser.c, OPS:
	This patch allows you to view files from the browser
	window, useful if you are searching for a file to attach
	to your message. It uses the standard mailcap stuff (and
	the lookup mime types) to use the correct "viewer" for the
	file.  (From Brandon Long <blong@fiction.net>)

	* doc/Attic/dotlock.man.in, doc/Makefile.in, configure.in, configure, Makefile.in:
	Dotlock-related changes: We call it mutt.dotlock to avoid
	conflicts with certain NFS versions' dotlocking utilities
	(pointed out by Liviu Daia).  Additionally, we need to
	compile it as an external utility on systems which don't
	have an fchdir(2) system call.

Thu Jul 16 16:39:53 1998  Thomas Roessler  <roessler@guug.de>

	* mx.c: Fixing a small typographic error.

	* mx.c: Mutt doesn't retry locking if it doesn't succeed at once.
	The code in mx_lock_file is supposed to retry but it
	doesn't work because of a mistake in operator precedence.
	(From: Petri Kaukasoina <kaukasoi@elektroni.ee.tut.fi>)

	* Attic/dotlock.c:
	The dotlock.c file tries to include <posix1_lim.h> if
	_POSIX_PATH_MAX isn't defined but it doesn't include
	<limits.h>, where this symbol should be defined.  (From
	Marc.Baudoin@solsoft.com)

	* send.c: When several messages are tagged and the user applies
	reply, group-reply, or list-reply to these messages, the
	reply's references and in-reply-to headers are constructed
	from the tagged message which comes last in the current
	index.  This patch constructs the references header from
	_all_ messages' message-id and references headers. (tlr)

	* reldate.h, configure.in, configure, Changes, ChangeLog:
	Preparing mutt 0.94.

	* imap.c: "My two remaining issues are the speed at which it
	downloads the headers, and support of PREAUTH. I'm
	enclosing a patch (to stock mutt-0.92.13i) which addresses
	these issues." (From Brian Marcotte
	<marcotte@panix7.panix.com>)

	* color.c: This patch fixes two problems reported on mutt-users.

	(1) the error message about "default colors not supported"
	when not using a color xterm should not be printed.  The
	existing code did not check the value of has_colors() in
	conjunction with use_default_colors()

	(2) mutt would crash when sending mail in batch mode
	because use_default_colors() could be used without doing
	an initscr()

	(From Michael Elkins.)

Wed Jul 15 17:15:46 1998  Thomas Roessler  <roessler@guug.de>

	* mx.h, mx.c, main.c, Attic/dotlock.h,
	Attic/dotlock.c, configure.in, configure,
	Makefile.in: Finalizing the external dotlock
	support: If group mail privileges are needed, the
	dotlock is compiled as a separate program.  If
	there is no need for privileges, it remains a
	module which is compiled into mutt. Also, there is
	no more need for the SLang buffer overflow
	work-around in main().  We drop it, but let mutt
	bail out instead if it's installed setgid
	something.

	* doc/Attic/dotlock.man.in, Attic/dotlock.c:
	Fix the race condition in dotlock.c.

	* doc/Attic/mutt.man.in:
	Putting the manual page under autoconf control.

	* doc/Attic/mutt.man.in:
	file mutt.man.in was initially added on branch mutt-0-94.

	* doc/mutt.man: Putting the manual page under autoconf control.

	* doc/Attic/dotlock.man.in:
	Adding external dotlocking.  For bugs, see the manual page
	and the comments in dotlock.c.

	* doc/Attic/dotlock.man.in:
	file dotlock.man.in was initially added on branch mutt-0-94.

	* doc/Makefile.in, protos.h, mx.c, mbox.c, main.c, globals.h, Attic/dotlock.h:
	Adding external dotlocking.  For bugs, see the manual page
	and the comments in dotlock.c.

	* Attic/dotlock.h:
	file dotlock.h was initially added on branch mutt-0-94.

	* Attic/dotlock.c:
	Adding external dotlocking.  For bugs, see the manual page
	and the comments in dotlock.c.

	* Attic/dotlock.c:
	file dotlock.c was initially added on branch mutt-0-94.

	* configure.in, configure, Makefile.in:
	Adding external dotlocking.  For bugs, see the manual page
	and the comments in dotlock.c.

	* doc/mutt.man: More roff fixes.

	* doc/mutt.man: More groff fixes.

Tue Jul 14 16:01:07 1998  Thomas Roessler  <roessler@guug.de>

	* reldate.h, configure.in, configure, Changes, ChangeLog:
	Preparing mutt 0.93.1i.

	* rfc2047.c, mime.h, handler.c: More unsigned fixes.

	* pattern.c, parse.c:
	Changing (int) casts in is* arguments to (unsigned char).

	* rfc2047.c: Removing a superfluous (unsigned char) cast in an IsPrint
	argument.

Mon Jul 13 10:50:39 1998  Thomas Roessler  <roessler@guug.de>

	* doc/mutt.sgml, doc/mutt.man, doc/Makefile.in:
	Since manual page generation seems to be broken in the
	SGML-tools package, we remove the SGML version of mutt.man
	and make the troff source the master copy.  Suggested by
	Roland Rosenfeld <roland@luv.rhein.de> who also provided
	the corrected mutt.man file.

Sun Jul 12 13:15:31 1998  Thomas Roessler  <roessler@guug.de>

	* protos.h: Replace calloc by safe_calloc in new_pattern.

Sat Jul 11 05:10:29 1998  Thomas Roessler  <roessler@guug.de>

	* doc/manual.txt, doc/manual.sgml: Key bindings documentation.

Fri Jul 10 17:58:26 1998  Thomas Roessler  <roessler@guug.de>

	* NEWS: s/fwd_decode/forward_decode/ (Noted by Lars Hecking)

	* pop.c: tmp[] wasn't initialized when asking for the POP password.

	* buffy.c: On SunOS 4.1, one must include unistd.h in order to
	declare SEEK_END.  (Fabrice Noilhan)

	* mutt.h: include <posix1_lim.h> if limits.h doesn't defile
	_POSIX_PATH_MAX.

	* Changes, ChangeLog: *** empty log message ***

	* doc/PGP-Notes.txt: Adding a notice about core dumps.

	* reldate.h, README, INSTALL: Preparing 0.93i.

	* handler.c: Fix text/enriched decoding: if there's a tag mismatch in
	the last paragraph in the attachment, the whole paragraph
	wouldn't be displayed.

Thu Jul  9 19:51:36 1998  Thomas Roessler  <roessler@guug.de>

	* configure.in, configure, Attic/config.sub:
	Use CC -Ae -D_HPUX_SOURCE on HP/UX.

	* Attic/config.sub:
	file config.sub was initially added on branch mutt-0-93.

	* Attic/config.guess: Use CC -Ae -D_HPUX_SOURCE on HP/UX.

	* Attic/config.guess:
	file config.guess was initially added on branch mutt-0-93.

	* INSTALL: Use CC -Ae -D_HPUX_SOURCE on HP/UX.

Wed Jul  8 21:59:43 1998  Thomas Roessler  <roessler@guug.de>

	* snprintf.c, pattern.c, parse.c, mx.c, mh.c, lib.c, keymap.c, init.c, from.c, edit.c, curs_main.c:
	Changing (int) casts in is* arguments to (unsigned char)
	casts to avoid mis-casting of signed chars.  (From Michael
	Elkins.)

Tue Jul  7 09:22:40 1998  Thomas Roessler  <roessler@guug.de>

	* rfc822.c: Change one int to size_t in rfc822.c.

	* rfc822.c: Fix the parsing of route addresses a la RFC 822.  Patch
	from Michael Elkins.

	* snprintf.c, sendlib.c, pattern.c, parse.c, mx.c, mh.c, lib.c, keymap.c, init.c, from.c, edit.c, curs_main.c:
	Cast the arguments of the is* functions to int.  Patch
	from Michael Elkins.

Thu Jul  2 21:15:18 1998  Thomas Roessler  <roessler@guug.de>

	* hdrline.c:
	Using the correct version of O'Shaughnessy Evans' %O patch.

	* configure.in, configure, Changes, ChangeLog: Preparig 0.92.14i

	* doc/manual.txt, doc/manual.sgml: s/&setmn;/&bsol;/

	* hdrline.c: Adding the %O expansion.

	* doc/manual.sgml: Applying the various manual_nits patches.

Wed Jul  1 17:01:50 1998  Thomas Roessler  <roessler@guug.de>

	* curs_main.c: Fixing a reverse-threading problem.

	* imap.c: Fixing an imap-related segmentation fault.

Tue Jun 30 06:38:02 1998  Thomas Roessler  <roessler@guug.de>

	* reldate.h, Changes, ChangeLog:
	These are the last tiny bits of preparing 0.92.13i.

	* configure.in, configure, TODO, README, NEWS:
	Updating some of the documentation for 0.93.

	* doc/Attic/NEWS: *** empty log message ***

	* doc/Attic/NEWS: file NEWS was initially added on branch mutt-0-93.

	* doc/manual.txt: Incorporate the recent changes to manual.sgml.

	* main.c: Work around a buffer overflow in SLang.  (This is the same
	bug which is fixed by 0.91.2i.)

Fri Jun 26 10:31:28 1998  Thomas Roessler  <roessler@guug.de>

	* doc/manual.sgml, send.c, init.h, globals.h, Muttrc.in:
	Removing $empty_to.

Thu Jun 25 22:31:46 1998  Thomas Roessler  <roessler@guug.de>

	* hdrline.c: Moved a break statement where it belongs.

	* mx.c: Fix an imap-related typo.

	* handler.c: Don't generate non-terminated last lines when quoting
	8bit-"encoded" text-plain body parts.

	* Makefile.in: Don't use GNU make specific features.

Sun Jun 21 07:13:03 1998  Thomas Roessler  <roessler@guug.de>

	* doc/mutt.man, doc/Makefile.in, reldate.h, configure.in, configure, Changes, ChangeLog:
	Bumping the release to 0.92.12i.

Sat Jun 20 06:12:38 1998  Thomas Roessler  <roessler@guug.de>

	* doc/manual.txt: *** empty log message ***

	* handler.c: Fixing the quoted-printable decoder.

	* handler.c, copy.c: Make mutt handle messages containing null bytes.

	* doc/manual.sgml: documenting alias-path

Fri Jun 19 12:52:16 1998  Thomas Roessler  <roessler@guug.de>

	* sendlib.c, send.c, protos.h, postpone.c, pattern.c, menu.c, main.c, headers.c, functions.h, curs_main.c, compose.c, OPS:
	Removing the Attach-Menu feature for the next release
	version.

Thu Jun 18 20:37:59 1998  Thomas Roessler  <roessler@guug.de>

	* protos.h, lib.c, alias.c:
	Bradon long's alias_path patch, for the sake of Elm
	compatibility.

Tue Jun 16 20:59:20 1998  Thomas Roessler  <roessler@guug.de>

	* mx.c: Avoid pointless error messages from mx_get_magic() when
	called from an mx_open_mailbox_append() on a non-existing
	mailbox.

	* doc/manual.txt, doc/Makefile.in, configure.in, configure, Makefile.in:
	Have "make install" install manual.txt as well.

	* doc/Attic/makefile, doc/Makefile.in:
	Putting Makefile under autoconf control.

	* main.c: Switch the error reporting address from mutt-users to
	mutt-dev.

	* reldate.h, configure.in, configure, Changes, ChangeLog:
	Bump the version to 0.92.11i.

	* imap.h: Check in a proper version of imap.h.

	* color.c: Fix the "unknown color" bug reported by Vikas.

	* mx.c: Remove a spurious #include "imap.h" from mx.c.

	* doc/style-guide: Add a note about the global Muttrc to style-guide.

	* configure.in, Muttrc.in, configure, Attic/Muttrc, Makefile.in:
	The global Muttrc contains a list of default settings
	which can be used as a starting-point for the user's own
	configuration.

	* pgppubring.c, pgp.h, gnupgparse.c:
	Removing some duplicate code from gnupgparse.c and
	pgppubring.c.

	* pgpinvoke.c, gnupgparse.c:
	Include part of Werner Koch's latest GPG patches.

	* Changes: *** empty log message ***

	* configure.in, configure, Changes, ChangeLog: Preparing 0.92.10i.

	* doc/PGP-Notes.txt: Including Roland's new procmail recipe.

	* protos.h, pattern.c, menu.c, curs_main.c, compose.c, addrbook.c:
	Including Vikas' search code for the "attach message" menu.

Mon Jun 15 15:19:49 1998  Thomas Roessler  <roessler@guug.de>

	* mx.c, main.c, mailbox.h, imap.c, commands.c: Brandon's IMAP patch.

